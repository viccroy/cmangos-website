if(window.WH2=new function(){this.REMOTE=!("."+location.hostname).endsWith(".wowhead.com")&&"wh-site"!==location.hostname||"/widgets/power/demo.html"===location.pathname,this.STATIC_URL="https://wow.zamimg.com",this.staticUrl=this.STATIC_URL,this.PageMeta={};const e={resizeEventObserver:void 0};this.defineEnum=function(e,t){let a={},n=[];return Object.keys(e).forEach((i=>{a[i]=t?new t(a):{},a[i].name=i,a[i].value=e[i],Object.freeze(a[i]),n.push(a[i])})),a.cases=()=>n.slice(),a.tryFrom=e=>n.find((t=>t.value===e)),a.from=e=>{let t=a.tryFrom(e);if(!t)throw new Error(`Value ${e} is not a valid backing value for this enum.`);return t},a.values=()=>n.map((e=>e.value)),Object.freeze(a)},this.extendStatic=function(e,t){return new(WH2.setPrototype(e,t))},this.findKey=function(e,t,a){let n=Object.keys(e).find((a=>e[a]===t));return a&&null!=n&&(n=parseInt(n)),n},this.onLoad=function(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):requestAnimationFrame(e)},this.setPrototype=function(e,t){return t.prototype=e,t},this.triggerResizeEvents=function(t){t instanceof Element&&window.ResizeObserver&&(e.resizeEventObserver=e.resizeEventObserver||new ResizeObserver((e=>e.forEach((e=>requestAnimationFrame((()=>e.target.dispatchEvent(new CustomEvent("resize",{detail:e})))))))),e.resizeEventObserver.observe(t))}},WH2.dataEnv={MAIN:1,PTR:2,BETA:3,CLASSIC:4,TBC:5,D2:6,DI:7,WRATH:8,D4:9,PTR2:10,CATA:11,D4PTR:12,D4BETA:13},WH2.dataEnvKey={1:"live",2:"ptr",3:"beta",4:"classic",5:"tbc",6:"d2",7:"di",8:"wrath",9:"d4",10:"ptr2",11:"cata",12:"d4ptr",13:"d4beta"},WH2.dataEnvTerm={1:"live",2:"ptr",3:"beta",4:"classic",5:"burningCrusade",6:"diablo2",7:"diabloImmortal",8:"wrathofthelichking",9:"diablo4",10:"ptr2",11:"cataclysm",12:"diablo4ptr",13:"diablo4beta"},WH2.dataTree={RETAIL:1,CLASSIC:4,TBC:5,D2:6,DI:7,WRATH:8,D4:9,CATA:11},WH2.dataTreeShortTerm={[WH2.dataTree.RETAIL]:"retail",[WH2.dataTree.CLASSIC]:"classic",[WH2.dataTree.TBC]:"theburningcrusade_short",[WH2.dataTree.D2]:"diablo2",[WH2.dataTree.DI]:"diabloImmortal_short",[WH2.dataTree.WRATH]:"wrathofthelichking_short",[WH2.dataTree.D4]:"diablo4",[WH2.dataTree.CATA]:"cataclysm_short"},WH2.dataTreeTerm={1:"retail",4:"classic",5:"burningCrusade",6:"diablo2",7:"diabloImmortal",8:"wrathofthelichking",9:"diablo4",11:"cataclysm"},WH2.dataEnvToTree={},WH2.dataEnvToTree[WH2.dataEnv.MAIN]=WH2.dataTree.RETAIL,WH2.dataEnvToTree[WH2.dataEnv.PTR]=WH2.dataTree.RETAIL,WH2.dataEnvToTree[WH2.dataEnv.PTR2]=WH2.dataTree.RETAIL,WH2.dataEnvToTree[WH2.dataEnv.BETA]=WH2.dataTree.RETAIL,WH2.dataEnvToTree[WH2.dataEnv.CLASSIC]=WH2.dataTree.CLASSIC,WH2.dataEnvToTree[WH2.dataEnv.TBC]=WH2.dataTree.TBC,WH2.dataEnvToTree[WH2.dataEnv.D2]=WH2.dataTree.D2,WH2.dataEnvToTree[WH2.dataEnv.DI]=WH2.dataTree.DI,WH2.dataEnvToTree[WH2.dataEnv.WRATH]=WH2.dataTree.WRATH,WH2.dataEnvToTree[WH2.dataEnv.D4]=WH2.dataTree.D4,WH2.dataEnvToTree[WH2.dataEnv.CATA]=WH2.dataTree.CATA,WH2.dataEnvToTree[WH2.dataEnv.D4PTR]=WH2.dataTree.D4,WH2.dataEnvToTree[WH2.dataEnv.D4BETA]=WH2.dataTree.D4,WH2.dataTreeToRoot={},WH2.dataTreeToRoot[WH2.dataTree.RETAIL]=WH2.dataEnv.MAIN,WH2.dataTreeToRoot[WH2.dataTree.CLASSIC]=WH2.dataEnv.CLASSIC,WH2.dataTreeToRoot[WH2.dataTree.TBC]=WH2.dataEnv.TBC,WH2.dataTreeToRoot[WH2.dataTree.D2]=WH2.dataEnv.D2,WH2.dataTreeToRoot[WH2.dataTree.DI]=WH2.dataEnv.DI,WH2.dataTreeToRoot[WH2.dataTree.WRATH]=WH2.dataEnv.WRATH,WH2.dataTreeToRoot[WH2.dataTree.D4]=WH2.dataEnv.D4,WH2.dataTreeToRoot[WH2.dataTree.CATA]=WH2.dataEnv.CATA,WH2.EFFECT_SCALING_CLASS_1=-1,WH2.EFFECT_SCALING_CLASS_2=-2,WH2.EFFECT_SCALING_CLASS_3=-3,WH2.EFFECT_SCALING_CLASS_4=-4,WH2.EFFECT_SCALING_CLASS_5=-5,WH2.EFFECT_SCALING_CLASS_6=-6,WH2.EFFECT_SCALING_CLASS_7=-7,WH2.EFFECT_SCALING_CLASS_8=-8,WH2.EFFECT_SCALING_CLASS_9=-9,WH2.EFFECT_SCALING_CLASS_ITEM=15,WH2.EFFECT_SCALING_CLASS_CATA_ITEM=12,WH2.EFFECT_SCALING_CLASS_DAMAGEREPLACESTAT=21,WH2.EFFECT_AURA_DUMMY=4,WH2.EFFECT_AURA_PROC_TRIGGER_SPELL=42,WH2.Timewalking=new function(){const e=this;this.MODE_TBC=1,this.MODE_WOTLK=2,this.MODE_CATA=3,this.MODE_MISTS=4,this.MODE_WOD=5,this.MODE_LEGION=6;const t=[{id:e.MODE_TBC,charLevel:30,gearIlvl:75,stringId:"twtbc"},{id:e.MODE_WOTLK,charLevel:30,gearIlvl:75,stringId:"twwotlk"},{id:e.MODE_CATA,charLevel:35,gearIlvl:90,stringId:"twcata"},{id:e.MODE_MISTS,charLevel:35,gearIlvl:90,stringId:"twmists"},{id:e.MODE_WOD,charLevel:40,gearIlvl:105,stringId:"twwod"},{id:e.MODE_LEGION,charLevel:45,gearIlvl:120,stringId:"twlegion"}];this.getConfigs=function(){return t},this.getCharLevelFromIlvl=function(t){for(let a of e.getConfigs())if(a.gearIlvl===t)return a.charLevel;return null},this.getGearIlvlByStringId=function(t){for(let a of e.getConfigs())if(a.stringId===t)return a.gearIlvl;return null}},WH2.Types=new function(){const e=this;this.NPC=1,this.OBJECT=2,this.ITEM=3,this.ITEM_SET=4,this.QUEST=5,this.SPELL=6,this.ZONE=7,this.FACTION=8,this.HUNTER_PET=9,this.ACHIEVEMENT=10,this.TITLE=11,this.EVENT=12,this.PLAYER_CLASS=13,this.RACE=14,this.SKILL=15,this.CURRENCY=17,this.PROJECT=18,this.SOUND=19,this.BUILDING=20,this.FOLLOWER=21,this.MISSION_ABILITY=22,this.MISSION=23,this.SHIP=25,this.THREAT=26,this.RESOURCE=27,this.CHAMPION=28,this.ICON=29,this.ORDER_ADVANCEMENT=30,this.FOLLOWER_ALLIANCE=31,this.FOLLOWER_HORDE=32,this.SHIP_ALLIANCE=33,this.SHIP_HORDE=34,this.CHAMPION_ALLIANCE=35,this.CHAMPION_HORDE=36,this.TRANSMOG_ITEM=37,this.BFA_CHAMPION=38,this.BFA_CHAMPION_ALLIANCE=39,this.AFFIX=40,this.BFA_CHAMPION_HORDE=41,this.AZERITE_ESSENCE_POWER=42,this.AZERITE_ESSENCE=43,this.STORYLINE=44,this.ADVENTURE_COMBATANT_ABILITY=46,this.ENCOUNTER=47,this.COVENANT=48,this.SOULBIND=49,this.DI_EQUIP_ITEM=50,this.DI_SKILL=54,this.DI_PARAGON_SKILL=55,this.DI_SET=56,this.DI_NPC=57,this.DI_MISC_ITEM=58,this.DI_ZONE=59,this.DI_QUEST=60,this.DI_OBJECT=61,this.PROFESSION_TRAIT=65,this.TRADING_POST_ACTIVITY=67,this.D4_PLAYER_CLASS=63,this.D4_SKILL=64,this.D4_ITEM=66,this.D4_AFFIX=68,this.D4_PARAGON_NODE=69,this.D4_ASPECT=70,this.D4_PARAGON_GLYPH=71,this.D4_VAMPIRIC_POWER=74,this.D4_SENESCHAL_STONE=78,this.GATHERER_SCREENSHOT=91,this.GATHERER_GUIDE_IMAGE=98,this.GUIDE=100,this.TRANSMOG_SET=101,this.OUTFIT=110,this.GEAR_SET=111,this.D4_BUILD=112,this.GATHERER_LISTVIEW=158,this.GATHERER_SURVEY_COVENANTS=161,this.NEWS_POST=162,this.GATHERER_HERO_TALENTS=165,this.COUNTDOWN_TIMER=166,this.BATTLE_PET_ABILITY=200;const t={[this.BATTLE_PET_ABILITY]:["pet-ability","petability"],[this.BFA_CHAMPION_ALLIANCE]:["bfa-champion"],[this.BFA_CHAMPION_HORDE]:["bfa-champion"],[this.CHAMPION_ALLIANCE]:["champion"],[this.CHAMPION_HORDE]:["champion"],[this.D4_AFFIX]:["affix"],[this.D4_ASPECT]:["aspect"],[this.D4_BUILD]:["build"],[this.D4_ITEM]:["item"],[this.D4_PARAGON_GLYPH]:["paragon-glyph"],[this.D4_PARAGON_NODE]:["paragon-node"],[this.D4_SENESCHAL_STONE]:["seneschal-stone"],[this.D4_SKILL]:["skill"],[this.D4_VAMPIRIC_POWER]:["vampiric-power"],[this.DI_EQUIP_ITEM]:["equip-item"],[this.DI_MISC_ITEM]:["misc-item"],[this.DI_NPC]:["npc"],[this.DI_OBJECT]:["object"],[this.DI_PARAGON_SKILL]:["paragon-skill"],[this.DI_QUEST]:["quest"],[this.DI_SET]:["set"],[this.DI_SKILL]:["skill"],[this.DI_ZONE]:["zone"],[this.FOLLOWER_ALLIANCE]:["follower"],[this.FOLLOWER_HORDE]:["follower"],[this.ITEM_SET]:["item-set","itemset"],[this.MISSION_ABILITY]:["mission-ability","missionability","garrisonability"],[this.SHIP_ALLIANCE]:["ship"],[this.SHIP_HORDE]:["ship"]},a=[this.NPC,this.OBJECT,this.ITEM,this.ITEM_SET,this.QUEST,this.SPELL,this.ZONE,this.FACTION,this.HUNTER_PET,this.ACHIEVEMENT,this.TITLE,this.EVENT,this.PLAYER_CLASS,this.RACE,this.SKILL,this.CURRENCY,this.SOUND,this.BUILDING,this.FOLLOWER,this.MISSION_ABILITY,this.MISSION,this.SHIP,this.THREAT,this.RESOURCE,this.CHAMPION,this.ICON,this.ORDER_ADVANCEMENT,this.BFA_CHAMPION,this.AFFIX,this.AZERITE_ESSENCE_POWER,this.AZERITE_ESSENCE,this.STORYLINE,this.ADVENTURE_COMBATANT_ABILITY,this.PROFESSION_TRAIT,this.BATTLE_PET_ABILITY,this.TRADING_POST_ACTIVITY],n={[this.ACHIEVEMENT]:"achievement",[this.ADVENTURE_COMBATANT_ABILITY]:"adventure-combatant-ability",[this.AFFIX]:"affix",[this.AZERITE_ESSENCE]:"azerite-essence",[this.AZERITE_ESSENCE_POWER]:"azerite-essence-power",[this.BATTLE_PET_ABILITY]:"pet-ability",[this.BFA_CHAMPION]:"bfa-champion",[this.BFA_CHAMPION_ALLIANCE]:"bfa-champion_a",[this.BFA_CHAMPION_HORDE]:"bfa-champion_h",[this.BUILDING]:"building",[this.CHAMPION]:"champion",[this.CHAMPION_ALLIANCE]:"champion_a",[this.CHAMPION_HORDE]:"champion_h",[this.COUNTDOWN_TIMER]:"countdown-timer",[this.COVENANT]:"covenant",[this.CURRENCY]:"currency",[this.D4_AFFIX]:"d4-affix",[this.D4_ASPECT]:"d4-aspect",[this.D4_BUILD]:"d4-build",[this.D4_ITEM]:"d4-item",[this.D4_PARAGON_GLYPH]:"d4-paragon-glyph",[this.D4_PARAGON_NODE]:"d4-paragon-node",[this.D4_SENESCHAL_STONE]:"d4-seneschal-stone",[this.D4_SKILL]:"d4-skill",[this.D4_VAMPIRIC_POWER]:"d4-vampiric-power",[this.DI_EQUIP_ITEM]:"di-equip-item",[this.DI_MISC_ITEM]:"di-misc-item",[this.DI_NPC]:"di-npc",[this.DI_OBJECT]:"di-object",[this.DI_PARAGON_SKILL]:"di-paragon-skill",[this.DI_QUEST]:"di-quest",[this.DI_SET]:"di-set",[this.DI_SKILL]:"di-skill",[this.DI_ZONE]:"di-zone",[this.ENCOUNTER]:"encounter",[this.EVENT]:"event",[this.FACTION]:"faction",[this.FOLLOWER]:"follower",[this.FOLLOWER_ALLIANCE]:"follower_a",[this.FOLLOWER_HORDE]:"follower_h",[this.GEAR_SET]:"gear-set",[this.GUIDE]:"guide",[this.HUNTER_PET]:"pet",[this.ICON]:"icon",[this.ITEM]:"item",[this.ITEM_SET]:"item-set",[this.MISSION]:"mission",[this.MISSION_ABILITY]:"mission-ability",[this.NEWS_POST]:"news",[this.NPC]:"npc",[this.OBJECT]:"object",[this.ORDER_ADVANCEMENT]:"order-advancement",[this.OUTFIT]:"outfit",[this.PLAYER_CLASS]:"class",[this.PROFESSION_TRAIT]:"profession-trait",[this.QUEST]:"quest",[this.RACE]:"race",[this.RESOURCE]:"resource",[this.SHIP]:"ship",[this.SHIP_ALLIANCE]:"ship_a",[this.SHIP_HORDE]:"ship_h",[this.SKILL]:"skill",[this.SOULBIND]:"soulbind",[this.SOUND]:"sound",[this.SPELL]:"spell",[this.STORYLINE]:"storyline",[this.THREAT]:"threat",[this.TITLE]:"title",[this.TRANSMOG_SET]:"transmog-set",[this.TRADING_POST_ACTIVITY]:"trading-post-activity",[this.ZONE]:"zone"},i={[WH2.dataTree.RETAIL]:[this.ACHIEVEMENT,this.ADVENTURE_COMBATANT_ABILITY,this.AFFIX,this.AZERITE_ESSENCE,this.AZERITE_ESSENCE_POWER,this.BATTLE_PET_ABILITY,this.BFA_CHAMPION,this.BUILDING,this.CHAMPION,this.CURRENCY,this.EVENT,this.FACTION,this.FOLLOWER,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.MISSION,this.MISSION_ABILITY,this.NPC,this.OBJECT,this.ORDER_ADVANCEMENT,this.OUTFIT,this.PLAYER_CLASS,this.PROFESSION_TRAIT,this.QUEST,this.RACE,this.RESOURCE,this.SHIP,this.SKILL,this.SOUND,this.SPELL,this.STORYLINE,this.THREAT,this.TITLE,this.TRADING_POST_ACTIVITY,this.TRANSMOG_SET,this.ZONE],[WH2.dataTree.CLASSIC]:[this.FACTION,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GEAR_SET,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.NPC,this.OBJECT,this.OUTFIT,this.PLAYER_CLASS,this.QUEST,this.RACE,this.RESOURCE,this.SKILL,this.SOUND,this.SPELL,this.ZONE],[WH2.dataTree.TBC]:[this.FACTION,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GEAR_SET,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.NPC,this.OBJECT,this.OUTFIT,this.PLAYER_CLASS,this.QUEST,this.RACE,this.RESOURCE,this.SKILL,this.SOUND,this.SPELL,this.ZONE],[WH2.dataTree.WRATH]:[this.ACHIEVEMENT,this.CURRENCY,this.EVENT,this.FACTION,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GEAR_SET,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.NPC,this.OBJECT,this.OUTFIT,this.PLAYER_CLASS,this.QUEST,this.RACE,this.RESOURCE,this.SKILL,this.SOUND,this.SPELL,this.ZONE],[WH2.dataTree.CATA]:[this.ACHIEVEMENT,this.CURRENCY,this.EVENT,this.FACTION,this.GATHERER_GUIDE_IMAGE,this.GATHERER_LISTVIEW,this.GATHERER_SCREENSHOT,this.GEAR_SET,this.GUIDE,this.HUNTER_PET,this.ICON,this.ITEM,this.ITEM_SET,this.NPC,this.OBJECT,this.OUTFIT,this.PLAYER_CLASS,this.QUEST,this.RACE,this.RESOURCE,this.SKILL,this.SOUND,this.SPELL,this.ZONE],[WH2.dataTree.D2]:[],[WH2.dataTree.D4]:[this.D4_AFFIX,this.D4_ASPECT,this.D4_BUILD,this.D4_ITEM,this.D4_PARAGON_GLYPH,this.D4_PARAGON_NODE,this.D4_PLAYER_CLASS,this.D4_SENESCHAL_STONE,this.D4_SKILL,this.D4_VAMPIRIC_POWER],[WH2.dataTree.DI]:[this.DI_EQUIP_ITEM,this.DI_MISC_ITEM,this.DI_NPC,this.DI_OBJECT,this.DI_PARAGON_SKILL,this.DI_QUEST,this.DI_SET,this.DI_SKILL,this.DI_ZONE]},s={typeNames:void 0};function o(e){return void 0===s.typeNames&&(s.typeNames=WH2.getPageData("types.names")||{}),s.typeNames[e]||Array(4).fill(WH2.term("unknownType_format",e),0,4)}this.existsInDataEnv=function(e,t){return i[WH2.getDataTree(t)].includes(e)},this.getIdByString=function(e){return WH2.findKey(n,e,!0)},this.getDetailPageName=e=>(t[e]||[])[0]||n[e],this.getHistoricalDetailPageNames=e=>{let a=t[e]||n[e]&&[n[e]];if(!a)throw new Error(`The given type has no detail pages or string IDs. [${e}]`);return a},this.getGame=t=>{let a=(e.getRequiredTrees(t)||[])[0];return a?WH2.Game.getByTree(a):void 0},this.getGameWowTypes=function(){return a.slice()},this.getPreferredDataEnv=function(e){let t=WH2.Types.getRequiredTrees(e);if(t)return t.includes(WH2.getDataTree())?WH2.getDataEnv():WH2.getRootByTree(t[0])},this.getReferenceName=function(e){return n[e]},this.getRequiredTrees=function(e){let t=[],a=!1;for(let n in i)i.hasOwnProperty(n)&&(i[n].includes(e)?t.push(parseInt(n)):a=!0);return a?t:null},this.getStringId=function(e){return n[e]},this.hasName=function(e){return s.typeNames.hasOwnProperty(e)},this.getLowerPlural=function(e){return o(e)[3]},this.getLowerSingular=function(e){return o(e)[1]},this.getUpperPlural=function(e){return o(e)[2]},this.getUpperSingular=function(e){return o(e)[0]}},WH2.error=function(e){console.error.apply(console.error,Array.prototype.slice.call(arguments)),e?WH2.Track&&WH2.Track.nonInteractiveEvent({category:"Error",action:arguments[0],label:arguments[1],value:arguments[2]}):console.error("The error message was empty, and thus will not be logged.")},WH2.info=function(e){console.info.apply(console.info,Array.prototype.slice.call(arguments))},WH2.log=function(e){console.log.apply(console.log,Array.prototype.slice.call(arguments))},WH2.warn=function(e){console.warn.apply(console.warn,Array.prototype.slice.call(arguments))},function(){const e={};WH2.getPageData=function(t){if(e.hasOwnProperty(t))return e[t];if(WH2.REMOTE)return;let a=document.querySelector(("script#data."+t).replace(/\./g,"\\."));return a?JSON.parse(a.innerHTML):void 0},WH2.setPageData=function(t,a){e.hasOwnProperty(t)&&WH2.warn("Duplicate data key",t),e[t]=a}}(),Object.assign(WH2.PageMeta,WH2.getPageData("pageMeta")||{}),WH2.PageMeta.serverTime=WH2.PageMeta.serverTime?new Date(WH2.PageMeta.serverTime):new Date,void 0!==WH2.PageMeta.staticUrl&&(WH2.STATIC_URL=WH2.PageMeta.staticUrl,WH2.staticUrl=WH2.PageMeta.staticUrl),WH2.stringCompare=function(e,t){if(e==t)return 0;if(null==e)return-1;if(null==t)return 1;var a=parseFloat(e),n=parseFloat(t);return isNaN(a)||isNaN(n)||a==n?"string"==typeof e&&"string"==typeof t?e.localeCompare(t,void 0,{numeric:!0}):e<t?-1:1:a<n?-1:1},WH2.trim=function(e){return e.replace(/(^\s*|\s*$)/g,"")},WH2.rtrim=function(e,t){let a=e.length;for(;--a>0&&e.charAt(a)===t;);return(e=e.substring(0,a+1))===t&&(e=""),e},WH2.sprintf=function(e){if("string"!=typeof e)return WH2.error("No format passed to WH2.sprintf.",e),"";for(var t=1,a=arguments.length;t<a;++t)e=e.replace("$"+t,arguments[t]);return e},WH2.sprintfGlobal=function(e){for(var t=1,a=arguments.length;t<a;++t)e=e.replace(new RegExp("\\$"+t,"g"),arguments[t]);return e},WH2.stringReplace=function(e,t,a){for(;-1!=e.indexOf(t);)e=e.replace(t,a);return e},WH2.term=function(e){if(!WH2.TERMS)return e;let t=[WH2.TERMS[e]].concat(Array.prototype.slice.call(arguments,1));return WH2.Strings.sprintf.apply(null,t)},WH2.wowTerm=function(e){if(!WH2.GlobalStrings)return e;let t=[WH2.GlobalStrings[e]].concat(Array.prototype.slice.call(arguments,1));return WH2.Strings.sprintf.apply(null,t)},WH2.htmlEntities=function(e){return e.replace(/[\u00A0-\u9999<>\&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}))},WH2.stub=function(e){let t=e.split("."),a=WH;for(let e,n=0;e=t[n];n++)a[e]||(a[e]={}),a=a[e]},WH2.urlEncode=function(e){return e=encodeURIComponent(e),e=WH2.stringReplace(e,"+","%2B")},WH2.urlEncodeHref=function(e){return e=encodeURIComponent(e),e=WH2.stringReplace(e,"%20","+"),e=WH2.stringReplace(e,"%3D","=")},WH2.numberFormat=function(e){var t=(""+parseFloat(e)).split(".");e=t[0];var a=t.length>1?"."+t[1]:"";return e.length<=3?e+a:WH2.numberFormat(e.substr(0,e.length-3))+","+e.substr(e.length-3)+a},WH2.numberLocaleFormat=function(e,t){var a="";4==(a="number"==typeof t?Locale.locales[t].name:"string"==typeof t?t:Locale.getName()).length&&(a=a.substr(0,2).toLowerCase()+"-"+a.substr(2).toUpperCase());var n=""+e;try{n=e.toLocaleString(a)}catch(t){n=e.toLocaleString()}return n},WH2.inArray=function(e,t,a,n){if(null==e)return-1;if(!Array.isArray(e))return WH2.error("Tried looking for a value in a haystack which is not an array.",arguments),-1;var i;if(a){i=e.length;for(var s=n||0;s<i;++s)if(a(e[s])==t)return s;return-1}if((i=e.indexOf(t,n))>=0)return i;i=e.length;for(var o=n||0;o<i;++o)if(e[o]==t)return o;return-1},WH2.isSet=function(e){return void 0!==window[e]},!WH2.isSet("console"))var console={log:function(){}};for(var i in WH2.arrayWalk=function(e,t,a){for(var n=0,i=e.length;n<i;++n){var s=t(e[n],a,e,n);null!=s&&(e[n]=s)}},WH2.arrayApply=function(e,t,a){for(var n=0,i=e.length;n<i;++n)t(e[n],a,e,n)},WH2.arrayFilter=function(e,t){for(var a=[],n=0,i=e.length;n<i;++n)t(e[n])&&a.push(e[n]);return a},WH2.arrayUnique=function(e){for(var t={},a=e.length-1;a>=0;--a)t[e[a]]=1;var n=[];for(var i in t)n.push(i);return n},WH2.closest=function(e,t){for(;e&&e.nodeType===Node.ELEMENT_NODE;){if(e.matches(t))return e;e=e.parentNode}},WH2.ge=function(e){return"string"!=typeof e?e:document.getElementById(e)},WH2.gE=function(e,t){return e.getElementsByTagName(t)},WH2.qs=function(e,t){return(t||document).querySelector(e)},WH2.qsa=function(e,t){return(t||document).querySelectorAll(e)},WH2.ce=function(e,t,a){},WH2.ce=function(e){return function(t,a,n){var i=e(t);return a&&WH2.cOr(i,a),n&&WH2.ae(i,n),"INPUT"===i.tagName&&"range"===i.type&&!WH2.isRemote()&&WH2.DOM&&WH2.DOM.styleRangeElement(i),i}}(document.createElement.bind(document)),WH2.de=function(e,t){"string"==typeof e&&(e=(t||document).querySelector(e)),e&&e.parentNode&&e.parentNode.removeChild(e)},WH2.ae=function(e,t){return Array.isArray(t)?(WH2.arrayApply(t,e.appendChild.bind(e)),t):e.appendChild(t)},WH2.aea=(e,t)=>e.parentNode.insertBefore(t,e.nextSibling),WH2.aeb=function(e,t){return e.parentNode.insertBefore(t,e)},WH2.aef=function(e,t){return e.insertBefore(t,e.firstChild)},WH2.ee=function(e,t){for(t||(t=0);e.childNodes[t];)e.removeChild(e.childNodes[t])},WH2.ct=function(e){return document.createTextNode(e)},WH2.st=function(e,t){e.firstChild&&3==e.firstChild.nodeType?e.firstChild.nodeValue=t:WH2.aef(e,WH2.ct(t))},WH2.noWrap=function(e){e.style.WH2iteSpace="nowrap"},WH2.rf=function(){return!1},WH2.rfWithoutControlKey=function(e){if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey))return!1},WH2.aE=function(e,t,a,n){if(e){"string"==typeof e?e=document.querySelectorAll(e):e instanceof EventTarget?e=[e]:Array.isArray(e)||e instanceof NodeList||(e=[e]),t="string"==typeof t?[t]:t;for(let i=0;i<e.length;i++)for(let s of t)"resize"===s&&WH2.triggerResizeEvents(e[i]),e[i].addEventListener(s,a,n||!1)}},WH2.dE=function(e,t,a,n){if(e){"string"==typeof e?e=document.querySelectorAll(e):e instanceof EventTarget?e=[e]:Array.isArray(e)||e instanceof NodeList||(e=[e]);for(let i=0;i<e.length;i++)e[i].removeEventListener(t,a,n||!1)}},WH2.preventSelectStart=function(e){e.dataset.preventSelectStart="true"},WH2.sp=function(e){e||(e=window.event),e.stopPropagation()},WH2.setCookie=function(e,t,a,n,i,s){var o=new Date,r=e+"="+encodeURI(a)+"; ";o.setDate(o.getDate()+t),r+="expires="+o.toUTCString()+"; ",n&&(r+="path="+n+"; "),i&&(r+="domain="+i+"; "),!0===s&&(r+="secure;"),document.cookie=r,WH2.getCookies(e),WH2.getCookies.C[e]=a},WH2.deleteCookie=function(e,t,a,n){WH2.setCookie(e,-1,"",t,a,n),WH2.getCookies.C[e]=null},WH2.getCookies=function(e){if(null==WH2.getCookies.I){var t=decodeURI(document.cookie).split("; ");WH2.getCookies.C={};for(var a=0,n=t.length;a<n;++a){var i,s,o=t[a].indexOf("=");-1!=o?(i=t[a].substr(0,o),s=t[a].substr(o+1)):(i=t[a],s=""),WH2.getCookies.C[i]=s}WH2.getCookies.I=1}return e?WH2.getCookies.C[e]:WH2.getCookies.C},WH2.dO=function(e){return WH2.cO({},e)},WH2.cO=function(e,t){for(var a in t)null!==t[a]&&"object"==typeof t[a]&&t[a].length?e[a]=t[a].slice(0):e[a]=t[a];return e},WH2.cOr=function(e,t,a){for(var n in t)a&&n.substr(0,a.length)==a||(null!==t[n]&&"object"==typeof t[n]?Array.isArray(t[n])?e[n]=t[n].slice(0):(e[n]||(e[n]={}),WH2.cOr(e[n],t[n],a)):e[n]=t[n]);return e},WH2.fround=function(e){if(Math.fround)return Math.fround(e);if("undefined"!=typeof Float32Array&&Float32Array){var t=new Float32Array(1);return t[0]=+e,t[0]}return e},WH2.displayBlock=function(e,t){("string"!=typeof e||(e=(t||document).querySelector(e)))&&(e.style.display="block")},WH2.displayDefault=function(e,t){("string"!=typeof e||(e=(t||document).querySelector(e)))&&e.style.removeProperty("display")},WH2.displayInline=function(e,t){("string"!=typeof e||(e=(t||document).querySelector(e)))&&(e.style.display="inline")},WH2.displayNone=function(e,t){("string"!=typeof e||(e=(t||document).querySelector(e)))&&(e.style.display="none")},WH2.setData=function(e,t,a,n){let i;if("string"==typeof e)i=(n||document).querySelectorAll(e);else{if(!e)return void WH2.error("No element passed to WH2.setData().",t,a,e,n);if(e.dataset)i=[e];else{if(!e.length)return void WH2.error("Element not supported by WH2.setData().",t,a,e,n);i=e}}if(null==a)for(let e,a=0;e=i[a];a++)delete e.dataset[t];else for(let e,n=0;e=i[n];n++)e.dataset[t]=a},WH2.getWindowSize=function(){return{w:window.innerWidth,h:window.innerHeight}},WH2.getScroll=function(){return{x:window.scrollX,y:window.scrollY}},WH2.getCursorPos=function(e){return{x:e.pageX,y:e.pageY}},WH2.ac=function(e,t){let a=0,n=0;for(;e;){let t;e.style.transform&&(t=e.style.transform.match(/scale\(([\d.]+)\)/i))&&(a*=parseFloat(t[1]),n*=parseFloat(t[1])),a+=e.offsetLeft,n+=e.offsetTop;let i=e.parentNode;for(;i&&i!==e.offsetParent&&i.offsetParent;){if(i.scrollLeft||i.scrollTop){a-=0|i.scrollLeft,n-=0|i.scrollTop;break}i=i.parentNode}e=e.offsetParent}if(window.Lightbox&&Lightbox.isVisible()&&(t=!0),t){let e=WH2.getScroll();a+=e.x,n+=e.y}let i=[a,n];return i.x=a,i.y=n,i},WH2.getOffset=function(e,t){let a=e.getBoundingClientRect(),n={left:a.left,top:a.top};if(!0!==t){let e=WH2.getScroll();n.left+=e.x,n.top+=e.y}return n},WH2.scrollTo=function(e,t){if(t=t||{},"string"==typeof e){let t=document.querySelector(e);if(!t)return void WH2.error("Could not select element to scroll to.",e);e=t}if(e&&e.nodeType===Node.ELEMENT_NODE){if(t.asNeeded){let a=e.getBoundingClientRect(),n="center"===t.position?10:0;if(a.top>=WH2.Layout.getHeaderBottom()+n&&(!(t.allowScrollingDown??1)||a.top+a.height+n<window.innerHeight)&&a.left>=n&&a.left+a.width+n<window.innerWidth)return}e.scrollIntoView({behavior:!1===t.animated?"auto":"smooth",block:t.position||"start"})}else WH2.error("Invalid target to scroll to.",e)},WH2.isElementPositionFixedOrSticky=e=>{let t=["fixed","sticky"];for(;e&&e.nodeType===Node.ELEMENT_NODE;){if(t.includes(getComputedStyle(e).position))return!0;e=e.parentNode}return!1},WH2.createReverseLookupJson=function(e){var t={};for(var a in e)t[e[a]]=a;return t},WH2.getLocaleFromDomain=function(e){var t=WH2.getLocaleFromDomain.L;return e&&"string"==typeof e&&t[e.split(".")[0]]||0},WH2.getLocaleFromDomain.L={ko:1,fr:2,de:3,cn:4,es:6,ru:7,pt:8,it:9},WH2.getDomainFromLocale=function(e){var t;return(t=WH2.getDomainFromLocale.L?WH2.getDomainFromLocale.L:WH2.getDomainFromLocale.L=WH2.createReverseLookupJson(WH2.getLocaleFromDomain.L))[e]?t[e]:""},WH2.fetch=function(){let e=function(e){let t=[];for(let a in e)e.hasOwnProperty(a)&&t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")},t=function(e){return e.contentType?e.contentType:"object"==typeof e.form?"application/x-www-form-urlencoded":e.hasOwnProperty("json")?"application/json":"string"==typeof e.body?"application/octet-stream":void 0};if("function"!=typeof window.fetch){let a=function(e,t,a){let n=this,i=n.responseText,s=0===(n.getResponseHeader("content-type")||"").indexOf("application/json"),o=null;if(n.status<200||n.status>399)o="Legacy WH2.fetch call got a bad response code.";else if(s)try{i=JSON.parse(i)}catch(e){i=void 0,o="Could not process Legacy WH2.fetch JSON response. "+e.message}o?(WH2.error(o,e,n.status,n.responseText,n),t.error&&t.error(i,n.status)):t.success&&t.success(i,n.status),t.complete&&t.complete(i,n.status)},n=function(e,t,a){let n=this,i=n.responseText||void 0;t.errorExpected||WH2.error("Legacy WH2.fetch call could not complete.",e,n.status,n.responseText,n),t.error&&t.error(i,n.status),t.complete&&t.complete(i,n.status)};return function(i,s){(s=s||{}).query&&(i+=(i.indexOf("?")>-1?"&":"?")+WH2.Url.buildQuery(s.query));let o=s.method||"GET";(s.hasOwnProperty("data")||"string"==typeof s.body)&&(o=s.method||"POST");let r=new XMLHttpRequest;WH2.aE(r,"load",a.bind(r,i,s)),WH2.aE(r,"error",n.bind(r,i,s)),r.overrideMimeType("text/plain"),r.open(o,i,!0);let l=t(s);l&&r.setRequestHeader("Content-Type",l),"object"==typeof s.form?r.send(e(s.form)):s.hasOwnProperty("json")?r.send(JSON.stringify(s.json)):"string"==typeof s.body?r.send(s.body):r.send()}}let a=function(e,t,a,n){a.ok?t.success&&t.success(n,a.status):(t.errorExpected||WH2.error("WH2.fetch call got a bad response code.",e,a.status,n,a),t.error&&t.error(n,a.status)),t.complete&&t.complete(n,a.status)},n=function(e,t,a,n){let i="Could not process WH2.fetch response, callback errored. "+n.message;WH2.error(i,e,a.status,"",a),t.error&&t.error(void 0,a.status),t.complete&&t.complete(void 0,a.status)},i=function(e,t,i){(0===(i.headers.get("content-type")||"").indexOf("application/json")?i.json():i.text()).then(a.bind(null,e,t,i)).catch(n.bind(null,e,t,i))},s=function(e,t,a){let n="WH2.fetch call could not complete. "+a.message;WH2.error(n,e,0,"",a),t.error&&t.error(void 0,0,a.message),t.complete&&t.complete(void 0,0,a.message)};return function(a,n){(n=n||{}).query&&(a+=(a.indexOf("?")>-1?"&":"?")+WH2.Url.buildQuery(n.query));let o={credentials:"boolean"!=typeof n.cookies||n.cookies?"same-origin":"omit",headers:new Headers,method:n.method||"GET",mode:n.mode||"same-origin"},r=t(n);r&&o.headers.set("Content-Type",r),"object"==typeof n.form?(o.method=n.method||"POST",o.body=e(n.form)):n.hasOwnProperty("json")?(o.method=n.method||"POST",o.body=JSON.stringify(n.json)):"string"==typeof n.body&&(o.method=n.method||"POST",o.body=n.body),fetch(a,o).then(i.bind(null,a,n)).catch(s.bind(null,a,n))}}(),WH2.ajaxIshRequest=function(e,t){var a=document.getElementsByTagName("head")[0];if("http:"!==e.substr(0,5)||"https:"!==location.protocol){if(t){var n=WH2.ce("script",{type:"text/javascript",src:e});return WH2.ae(a,n),n}var i=WH2.getGets();null!=i.refresh&&(i.refresh.length?e+="&refresh="+i.refresh:e+="&refresh"),null!=i.locale&&(e+="&locale="+i.locale),null!=i.ptr&&(e+="&ptr");n=WH2.ce("script",{type:"text/javascript",src:e,charset:"utf8"});return WH2.ae(a,n),n}WH2.error("Refused to AJAX-ish load URL.",e)},WH2.xhrJsonRequest=function(e,t){var a=new XMLHttpRequest;a.onload=function(e){var a=e.target.response;switch(e.target.responseType){case"json":break;case"":case"text":try{a=JSON.parse(a)}catch(a){return WH2.error("Could not parse expected JSON response",e.target),t()}break;default:return WH2.error("Unexpected response type from JSON request",e.target),t()}return t(a)},a.onerror=function(){return t()},a.open("GET",e,!0),a.responseType="json",a.send()},WH2.getGets=function(){if(null!=WH2.getGets.C)return WH2.getGets.C;var e=WH2.getQueryString(),t=WH2.parseQueryString(e);return WH2.getGets.C=t,t},WH2.visitUrlWithPostData=function(e,t){var a=WH2.ce("form");for(var n in a.action=e,a.method="post",t)if(t.hasOwnProperty(n)){var i=WH2.ce("input");i.type="hidden",i.name=n,i.value=t[n],WH2.ae(a,i)}WH2.ae(document.body,a),a.submit()},WH2.getQueryString=function(){var e="";return location.pathname&&(e+=location.pathname.substr(1)),location.search&&(location.pathname&&(e+="&"),e+=location.search.substr(1)),e},WH2.parseQueryString=function(e){for(var t=(e=decodeURIComponent(e).replace(/^\?+/,"")).split("&"),a={},n=0,i=t.length;n<i;++n)WH2.splitQueryParam(t[n],a);return a},WH2.splitQueryParam=function(e,t){if(""!==e){var a,n,i=e.indexOf("=");-1!=i?(a=e.substr(0,i),n=e.substr(i+1)):(a=e,n=""),t[a]=n}},WH2.createRect=function(e,t,a,n){return{l:e,t:t,r:e+a,b:t+n}},WH2.intersectRect=function(e,t){return!(e.l>=t.r||t.l>=e.r||e.t>=t.b||t.t>=e.b)},WH2.getViewport=function(){var e=$(window);return new Rectangle(e.scrollLeft(),e.scrollTop(),e.width(),e.height())},WH2.keyPressIsAlphaNumeric=function(e){var t=document.all?e.keycode:e.WH2ich;return t>47&&t<58||t>64&&t<91||t>95&&t<112||222==t||0==t},WH2.isRemote=function(){return!WH2.PageMeta.wowhead},WH2.isDev=function(){return!!WH2.PageMeta.dev},WH2.getDataEnv=function(){return WH2.PageMeta.hasOwnProperty("dataEnv")?WH2.PageMeta.dataEnv.env:WH2.dataEnv.MAIN},WH2.getDataEnvFromKey=function(e){for(let t in WH2.dataEnvKey)if(WH2.dataEnvKey[t]===e)return parseInt(t)},WH2.getDataEnvKey=function(e){return WH2.dataEnvKey[e||WH2.getDataEnv()]},WH2.getDataEnvSeoName=function(e){return e=e||WH2.getDataEnv(),WH2.TERMS[e===WH2.dataEnv.TBC?"tbcClassic":WH2.getDataEnvTerm(e)]},WH2.getDataEnvTerm=function(e){return WH2.dataEnvTerm[e||WH2.getDataEnv()]},WH2.getDataTree=function(e){return void 0!==e?WH2.dataEnvToTree[e]:WH2.PageMeta.hasOwnProperty("dataEnv")?WH2.PageMeta.dataEnv.tree:WH2.dataTree.RETAIL},WH2.getDataTreeFromKey=function(e){const t=WH2.getDataEnvFromKey(e);if(null!=t)return WH2.getDataTree(t)},WH2.getDataTreeKey=function(e){return WH2.getDataEnvKey(WH2.dataTreeToRoot[e||WH2.getDataTree()])},WH2.getDataTreeShortTerm=function(e){return WH2.dataTreeShortTerm[e||WH2.getDataTree()]},WH2.getDataTreeTerm=function(e){return WH2.dataTreeTerm[e||WH2.getDataTree()]},WH2.getRootByTree=function(e){return WH2.dataTreeToRoot[e]},WH2.getRootEnv=function(e){return WH2.dataTreeToRoot[WH2.getDataTree(e||WH2.getDataEnv())]},WH2.getServerTime=function(){return WH2.PageMeta.serverTime},WH2.getDataCacheVersion=function(e){return(WH2.PageMeta.activeDbChanged&&WH2.PageMeta.activeDbChanged[e||WH2.getDataEnv()]||"0").toString()},WH2.isBeta=function(){return WH2.getDataEnv()===WH2.dataEnv.BETA},WH2.isBetaActive=function(){return WH2.PageMeta.hasOwnProperty("dataEnv")?WH2.PageMeta.dataEnv.active.beta:!!WH2.REMOTE},WH2.isCataTree=function(e){return WH2.getDataTree(e)===WH2.dataTree.CATA},WH2.isClassicTree=function(e){return WH2.getDataTree(e)===WH2.dataTree.CLASSIC},WH2.isDataEnvActive=function(e){switch(e){case WH2.dataEnv.BETA:return WH2.isBetaActive();case WH2.dataEnv.PTR:return WH2.isPtrActive();case WH2.dataEnv.PTR2:return WH2.isPtr2Active();case WH2.dataEnv.D4PTR:return WH2.isRemote()||!!WH2.PageMeta?.dataEnv?.active.d4ptr;case WH2.dataEnv.D4BETA:return WH2.isRemote()||!!WH2.PageMeta?.dataEnv?.active.d4beta;default:return!0}},WH2.isDataEnvRestricted=function(e){return!WH2.isRemote()&&WH2.PageMeta.restrictedDataEnvs.includes(e)},WH2.isEntityRestricted=function(e){return!WH2.isRemote()&&WH2.PageMeta.restrictedEntities.includes(e)},WH2.isPtr=function(){return WH2.getDataEnv()===WH2.dataEnv.PTR},WH2.isPtr2=function(){return WH2.getDataEnv()===WH2.dataEnv.PTR2},WH2.isPtrActive=function(){return WH2.PageMeta.hasOwnProperty("dataEnv")?WH2.PageMeta.dataEnv.active.ptr:!!WH2.REMOTE},WH2.isPtr2Active=function(){return WH2.PageMeta.hasOwnProperty("dataEnv")?WH2.PageMeta.dataEnv.active.ptr2:!!WH2.REMOTE},WH2.isRetailTree=function(e){return WH2.getDataTree(e)===WH2.dataTree.RETAIL},WH2.isTbcTree=function(e){return WH2.getDataTree(e)===WH2.dataTree.TBC},WH2.isWrathTree=function(e){return WH2.getDataTree(e)===WH2.dataTree.WRATH},WH2.suppressExternalDebug=function(){return!!WH2.PageMeta.suppressExternalDebug},WH2.setupFooterMenus=function(){Menu.onLoad((()=>["help","tools","about"].forEach((e=>{const t=`footer-${e}-menu`,a=`footer_${e}`,n=WH2.ge(t);n&&(n.classList.add("hassubmenu"),Menu.add(n,Menu.getMenu(a)))}))))},WH2.getScreenshotUrl=function(e,t,a){t||(t="normal"),a=a||{};var n="normal"==t&&"string"==typeof a.description&&a.description?"-"+WH2.Strings.slug(a.description,!0):"",i={2:".jpg",3:".png",18:".webp"},s=i[a.imageType||2]||i[2];return a.staffOnly?"/admin/screenshots/view/"+e+"?ext="+s.replace(/\./,""):WH2.staticUrl+"/uploads/screenshots/"+t+"/"+e+n+s},WH2.getWowMaxLevel=()=>WH2.Wow?.getMaxPlayerLevel?.()??70,WH2.convertRatingToPercent=function(e,t,a,n){let i=(WH2.convertRatingToPercent.LT||{})[t]||{},s=i[WH2.findSparseKey(i,e)]||0;if(null!=n&&(WH2.isWrathTree()||WH2.isCataTree())&&!WH2.isRemote()){const e=WH2.Wow.Item.Stat,a=WH2.Wow.PlayerClass;[e.ID_HASTE_RATING,e.ID_HASTE_MELEE_RATING].includes(t)&&[a.PALADIN,a.DEATH_KNIGHT,a.SHAMAN,a.DRUID].includes(n)&&(s/=1.3)}return s?a/s:0},WH2.statToRating={11:0,12:1,13:2,14:3,15:4,16:5,17:6,18:7,19:8,20:9,21:10,25:15,26:15,27:15,28:17,29:18,30:19,31:5,32:8,34:15,35:15,36:17,37:23,44:24,49:25,57:26,59:11,60:12,61:13,62:16,63:20,64:21,40:29},WH2.statToJson={0:"mana",1:"health",3:"agi",4:"str",5:"int",6:"spi",7:"sta",8:"energy",9:"rage",10:"focus",13:"dodgertng",14:"parryrtng",15:"blockrtng",16:"mlehitrtng",17:"rgdhitrtng",18:"splhitrtng",19:"mlecritstrkrtng",20:"rgdcritstrkrtng",21:"splcritstrkrtng",22:"corruption",23:"corruptionres",24:"_splhitrtng",25:"_mlecritstrkrtng",26:"_rgdcritstrkrtng",27:"_splcritstrkrtng",28:"mlehastertng",29:"rgdhastertng",30:"splhastertng",31:"hitrtng",32:"critstrkrtng",33:"_hitrtng",34:"_critstrkrtng",35:"resirtng",36:"hastertng",37:"exprtng",38:"atkpwr",39:"rgdatkpwr",40:"versatility",41:"splheal",42:"spldmg",43:"manargn",44:"armorpenrtng",45:"splpwr",46:"healthrgn",47:"splpen",49:"mastrtng",50:"armorbonus",51:"firres",52:"frores",53:"holres",54:"shares",55:"natres",56:"arcres",57:"pvppower",58:"amplify",59:"multistrike",60:"readiness",61:"speedbonus",62:"lifesteal",63:"avoidance",64:"sturdiness",66:"cleave",71:"agistrint",72:"agistr",73:"agiint",74:"strint",75:"",76:"",77:"",78:"",79:"",80:"",81:""},WH2.jsonToStat={},WH2.statToJson)WH2.jsonToStat[WH2.statToJson[i]]=i;WH2.individualToGlobalStat={16:31,17:31,18:31,19:32,20:32,21:32,24:33,25:34,26:34,27:34,28:36,29:36,30:36},WH2.convertScalingFactor=function(e,t,a,n,i){var s=WH2.convertScalingFactor.SV,o=WH2.convertScalingFactor.SD.stats;if(!s||!s[e])return g_user.roles&U_GROUP_ADMIN&&alert("There are no item scaling values for level "+e),i?{}:0;var r={},l=s[e],c=o[a];if(c&&(n>=0&&n<10)){let e=WH2.findSparseKey(c,n),a=WH2.findSparseKey(c,n+10);r.n=WH2.statToJson[c[e]],r.s=c[e],r.v=Math.floor(l[t]*c[a]/1e4)}else r.v=l[t];return i?r:r.v},WH2.getScalingDistributionCurve=function(e){let t=((WH2.convertScalingFactor.SD||{}).curves||{})[e];return t?{minLevel:t[0],maxLevel:t[1],curve:t[2]}:void 0},g_itemScalingCallbacks=[],WH2.getSpellScalingIndexFromScalingClass=function(e,t){if(e===WH2.EFFECT_SCALING_CLASS_1&&WH2.isCataTree())return WH2.EFFECT_SCALING_CLASS_CATA_ITEM;switch(e){case WH2.EFFECT_SCALING_CLASS_2:if(463==t)return WH2.EFFECT_SCALING_CLASS_ITEM;break;case WH2.EFFECT_SCALING_CLASS_7:return WH2.EFFECT_SCALING_CLASS_ITEM;case WH2.EFFECT_SCALING_CLASS_8:case WH2.EFFECT_SCALING_CLASS_9:return WH2.EFFECT_SCALING_CLASS_DAMAGEREPLACESTAT}return e<0?Math.abs(e)+(WH2.EFFECT_SCALING_CLASS_ITEM-1):e},WH2.effectAverage=function(e,t,a,n){let i=WH2.convertScalingSpell.RandPropPoints,s=e.scalingClass;e.effectScalingClass&&0!=(e.effectScalingClass?.[n]??0)&&(s=e.effectScalingClass[n]);let o=e.coefficient[n]??e.coefficient[0]??0,r=1,l=0;if(0!=o&&0!=s){if(e.scalesWithItemLevel)l=s==WH2.EFFECT_SCALING_CLASS_8?i[a][0]:s==WH2.EFFECT_SCALING_CLASS_9?i[a][2]:i[a][1];else{let e=WH2.getSpellScalingIndexFromScalingClass(s);l=WH2.convertScalingSpell.SV[t][e-1]}return s!==WH2.EFFECT_SCALING_CLASS_7||!e.aura||e.aura[n]!==WH2.EFFECT_AURA_DUMMY&&e.aura[n]!==WH2.EFFECT_AURA_PROC_TRIGGER_SPELL||(r=WH2.getCombatRatingMult(a,12)),o*l*r}return e.effectBasePoints[n]},WH2.convertScalingSpell=function(e,t,a,n,i,s){var o=WH2.convertScalingSpell.SpellInformation;if(!o||!o[t])return e;a-=1,null==e.effects&&(e.effects={}),e.effects.hasOwnProperty(a+1)||(e.effects[a+1]={});var r=o[t],l=0,c=WH2.effectAverage(r,i,s,a);if(r.deltaCoefficient[a]){var d=r.deltaCoefficient[a],p=Math.ceil(c-c*d/2),u=Math.floor(c+c*d/2);0==n?l=(p+u)/2:1==n?l=p:2==n&&(l=u)}else l=0!=(r.coefficient[a]??0)||0!=c?c:r.effectBasePoints[a]??0;l=Math.abs(l);var h="avg";switch(parseInt(n)){case 0:case 3:default:h="avg";break;case 1:h="min";break;case 2:h="max";break;case 4:h="pts"}var g=5;return window.g_pageInfo&&window.g_pageInfo.type==WH2.Types.AZERITE_ESSENCE_POWER&&(g=WH2.Wow.Item.INVENTORY_TYPE_NECK),r.scalesWithItemLevel&&r.appliesRatingAura&&r.appliesRatingAura[a]&&(l*=WH2.getCombatRatingMult(s,g)),e.effects[a+1][h]=l,e},WH2.getDataSource=function(){if(WH2.isSet("g_pageInfo"))switch(g_pageInfo.type){case WH2.Types.ITEM:if(WH2.isSet("g_items"))return g_items;break;case WH2.Types.SPELL:if(WH2.isSet("g_spells"))return g_spells;break;case WH2.Types.AZERITE_ESSENCE_POWER:if(WH2.isSet("g_azeriteEssencePowers"))return g_azeriteEssencePowers;break;case WH2.Types.BATTLE_PET_ABILITY:if(WH2.isSet("g_petabilities"))return g_petabilities}return[]},WH2.setJsonItemLevel=function(e,t,a){if(a&&a.scalingcategory-11>0){for(var n=a.maxlvlscaling?Math.min(t,a.maxlvlscaling):t,i=WH2.getSpellScalingValue(a.scalingcategory,n),s=1;s<3;++s){var o=a["itemenchspell"+s],r=a["itemenchtype"+s],l=WH2.statToJson[o];if(5==r&&e[l]){var c=a["damage"+s];c&&(e[l]=Math.round(i*c))}}if(a.allstats)for(var d in e)e[d]=Math.round(i*a.damage1)}if(e.scadist&&e.scaflags){e.bonuses=e.bonuses||{};var p,u=255&e.scaflags,h=e.scaflags>>8&255,g=0!=(65536&e.scaflags),f=0!=(e.scaflags&1<<17),m=0!=(e.scaflags&1<<18);switch(u){case 5:case 1:case 7:case 17:p=7;break;case 3:case 12:p=8;break;case 16:case 11:case 14:p=9;break;case 15:p=10;break;case 23:case 21:case 22:case 13:p=11;break;default:p=-1}if(p>=0)for(s=0;s<10;++s){var W=WH2.convertScalingFactor(t,p,e.scadist,s,1);W.n&&(e[W.n]=W.v),e.bonuses[W.s]=W.v}if(m&&(e.splpwr=e.bonuses[45]=WH2.convertScalingFactor(t,6)),g)switch(u){case 3:e.armor=WH2.convertScalingFactor(t,11+h);break;case 5:e.armor=WH2.convertScalingFactor(t,15+h);break;case 1:e.armor=WH2.convertScalingFactor(t,19+h);break;case 7:e.armor=WH2.convertScalingFactor(t,23+h);break;case 16:e.armor=WH2.convertScalingFactor(t,28);break;case 14:e.armor=WH2.convertScalingFactor(t,29);break;default:e.armor=0}if(f){var H,E=e.mledps?"mle":"rgd";switch(u){case 23:case 21:case 22:case 13:e.dps=e[E+"dps"]=WH2.convertScalingFactor(t,m?2:0),H=.3;break;case 17:e.dps=e[E+"dps"]=WH2.convertScalingFactor(t,m?3:1),H=.2;break;case 15:e.dps=e[E+"dps"]=WH2.convertScalingFactor(t,19==h?5:4),H=.3;break;default:e.dps=e[E+"dps"]=0,H=0}e.dmgmin=e[E+"dmgmin"]=Math.floor(e.dps*e.speed*(1-H)),e.dmgmax=e[E+"dmgmax"]=Math.floor(e.dps*e.speed*(1+H))}}},WH2.getContentTuningLevels=function(e){let t=(WH2.contentTuningLevels||{}).keys||{},a=Object.keys(t).find((function(a){return t[a].includes(e)}));if(void 0!==a)return{minLevel:WH2.contentTuningLevels.values[a][0],maxLevel:WH2.contentTuningLevels.values[a][1]}},WH2.scaleItemEnchantment=function(e,t){var a=e.enchantment;if(e.scalinginfo&&e.scalinginfo.scalingcategory-11>0){var n=a.match(/\d+/g);if(n)for(var i=parseInt(e.scalinginfo.maxlvlscaling)?Math.min(t,parseInt(e.scalinginfo.maxlvlscaling)):t,s=WH2.getSpellScalingValue(e.scalinginfo.scalingcategory,i),o=0;o<n.length;++o){var r=e.scalinginfo["damage"+(o+1)];r&&(a=a.replace(n[o],Math.round(s*r)))}}return a},WH2.getItemRandPropPointsType=function(e,t=!1){const a=e.slotbak?e.slotbak:e.slot;if(t)switch(a){case 14:case 23:return 2;case 15:case 26:case 25:return 4}switch(a){case 1:case 4:case 5:case 7:case 15:case 17:case 20:case 25:return 0;case 2:case 9:case 11:case 16:return 2;case 3:case 6:case 8:case 10:case 12:return 1;case 13:case 14:case 21:case 22:case 23:return 3;case 26:return 19==e.subclass?3:0;case 28:return 4;default:return-1}},WH2.getItemProfessionPropPointsType=function(e){switch(e.slotbak||e.slot){case WH2.Wow.Item.INVENTORY_TYPE_PROFESSION_TOOL:return 0;case WH2.Wow.Item.INVENTORY_TYPE_PROFESSION_ACCESSORY:return 1;default:return-1}},WH2.scaleItemLevel=function(e,t){let a=e.level,n=WH2.curvePoints;if(!n)return a;let i=null,s=null,o=null;if(e.scadist){let t=WH2.getScalingDistributionCurve(e.scadist);t&&t.curve&&(s=t.minLevel,o=t.maxLevel,i=t.curve)}else{if(e.contenttuning){let t=WH2.getContentTuningLevels(e.contenttuning);t&&(s=t.minLevel,o=t.maxLevel)}i=e.playercurve}if(i){let e=t||WH2.Wow.getMaxPlayerLevel();s&&e<s&&(e=s),o&&e>o&&(e=o);let r=n[i];if(r&&r.length>0){let t=-1;for(let a in r){if(r[a][1]>=e){t=a;break}}let n=r[-1!=t?t:r.length-1],i=null,s=0;if(t>0){i=r[t-1];let a=n[1]-i[1];if(a>0){let t=(e-i[1])/a*(n[2]-i[2]);s=i[2]+t}}else s=n[2];s>0&&(a=Math.round(s))}}return a},WH2.findSparseKey=function(e,t){return e.hasOwnProperty(t)?t.toString():Object.keys(e).reduce((function(e,a){let n=parseInt(a);return n>t||parseInt(e)>n?e:a}),"0")},WH2.applyStatModifications=function(e,t,a,n,i,s,o,r){const l=WH2.Wow.Item;var c={};if(e.hasOwnProperty("level")?c=WH2.dO(e):WH2.cOr(c,e,"__"),i&&i.length)for(var d=!1,p=0;p<i.length;++p){if((W=i[p])>0&&WH2.isSet("g_itembonuses")&&g_itembonuses[W])for(var u=g_itembonuses[W],h=0;h<u.length;++h){switch((H=u[h])[0]){case 11:case 13:(!1===d||H[2]<d)&&(c.scadist=H[1],c.scadistbonus=W,c.scadistbonustype=H[0],c.contenttuning=H[3],c.playercurve=H[4],d=H[2])}}}if(c.level=WH2.scaleItemLevel(c,s),"pvp"==a&&e.pvpUpgrade&&(c.level+=e.pvpUpgrade),c.subitems&&c.subitems[t])for(var g in c.subitems[t].jsonequip)c.hasOwnProperty(g)||(c[g]=0),c[g]+=c.subitems[t].jsonequip[g];if(c.extraStats=[],i&&i.length){if(e.statsInfo)for(var p in c.statsInfo={},e.statsInfo)c.statsInfo[p]={alloc:parseInt(e.statsInfo[p].alloc),qty:e.statsInfo[p].qty,socketMult:e.statsInfo[p].socketMult};var f=[0,0,0,0,2147483647,2147483647,2147483647,2147483647],m=!c.scadistbonus&&0;let t=[24,25],a=0,n=0,s=null,o=null,r=null,l=null;for(p=0;p<i.length;++p){var W;if((W=i[p])>0&&WH2.isSet("g_itembonuses")&&g_itembonuses[W])for(u=g_itembonuses[W],h=0;h<u.length;++h){var H;if(25==(H=u[h])[0]){let e=c.statsInfo[t[a]];if(!e||!e.alloc)continue;H[0]=2,H[2]=e.alloc,delete c.statsInfo[t[a]],a=Math.min(a+1,t.length-1)}switch(H[0]){case 1:n+=H[1],m=!1;break;case 2:c.statsInfo&&(c.statsInfo.hasOwnProperty(H[1])?c.statsInfo[H[1]].alloc+=H[2]:(c.extraStats.push(H[1]),c.statsInfo[H[1]]={alloc:parseInt(H[2]),qty:0,socketMult:0}));break;case 3:c.quality=parseInt(H[1]);break;case 4:var E=H[1],T=H[2],v=4,S=4;do{if(T<=f[v]){var I=E;E=f[v-4],f[v-4]=I;var y=T;T=f[v],f[v]=y}++v,--S}while(S);break;case 5:c.nameSuffix=WH2.Wow.Item.getNameDescription(H[1])||c.nameSuffix;break;case 6:var _=c.nsockets?c.nsockets:0;c.nsockets=_+H[1];for(var b=_;b<_+H[1];++b)c["socket"+(b+1)]=H[2];break;case 8:c.reqlevel+=H[1];break;case 14:!1!==m&&(m=c.level);break;case 16:c.bond=parseInt(H[1]);break;case 35:c.limitcategory=parseInt(H[1]);break;case 42:(null==s||o>H[2])&&(s=H[1],o=H[2],m=!1);break;case 43:(null==r||l>H[2])&&(r=H[1],l=H[2],m=!1);break;case 27:if(WH2.curvePoints){let e=WH2.curvePoints[H[1]];e&&e[0]&&e[0][2]&&(c.reqlevel=e[0][2])}else WH2.error("Could not apply item stat modifications without scaling curve points.",e.id,e.name);break;case 44:c.itemNameDescStats||(c.itemNameDescStats=[]),c.itemNameDescStats.push({qty:H[1],nameDescId:H[2]})}}}c.scadistbonus||(c.level=r||(s||c.level)+n),m&&(c.level=m,c.previewLevel=m),c.namedesc=c.namedesc?c.namedesc:"";for(h=0;h<4;++h){let e=WH2.Wow.Item.getNameDescription(f[h]);if(e){let t=WH2.Wow.Item.getNameDescriptionColor(f[h]);if(t>0){let e=parseInt(t).toString(16);for(;e.length<6;)e="0"+e;c.namedesc+=WH2.sprintf('<span style="color: #$1">',e)}c.namedesc+=(c.namedesc?" ":"")+e,t>0&&(c.namedesc+="</span>")}}}!function(){if(r&&r.length&&c.statsInfo)for(let t,a=0;t=WH2.Wow.Item.Stat.CRAFTING_STAT_FROM[a];a++){let n=r[a];n&&(c.statsInfo[t]&&(c.statsInfo[n]?c.statsInfo[n].alloc+=e.statsInfo[t].alloc:(c.statsInfo[n]=c.statsInfo[t],c.extraStats.push(n)),delete c.statsInfo[t]))}}();let w=WH2.Wow.Expansion.available(WH2.Wow.Expansion.WRATH)&&c.scadist>0;if(w&&c.statsInfo){let e=WH2.convertScalingFactor.SD.stats[c.scadist];if(e){let t=l.SCALING_STATS_DISTRIBUTION_STAT_MAX;for(p=0;p<t;p++)e[p]>0&&e[p+t]>0&&(c.statsInfo[e[p]]={qty:0,alloc:parseInt(e[p+t]),socketMult:0})}}if(e.statsInfo&&e.level&&WH2.applyStatModifications.ScalingData&&(WH2.applyStatModifications.ScalingData.AL.length>1||w)){let t=WH2.applyStatModifications.ScalingData.armor.total,i=WH2.applyStatModifications.ScalingData.armor.shield,r=WH2.applyStatModifications.ScalingData.armor.quality,d=WH2.applyStatModifications.ScalingData.SV,u=WH2.applyStatModifications.ScalingData.AL,h=WH2.applyStatModifications.ScalingData.socketCost,g=WH2.applyStatModifications.ScalingData.PPP,f=WH2.convertScalingFactor.SV;c.level=n||(a&&e.upgrades&&e.upgrades[a-1]?c.level+e.upgrades[a-1]:c.level);var A=c.level-e.level,L=Math.pow(1.15,A/15);let m,W=c.slot===WH2.Wow.Item.INVENTORY_TYPE_PROFESSION_TOOL||c.slot===WH2.Wow.Item.INVENTORY_TYPE_PROFESSION_ACCESSORY,H=W?WH2.getItemProfessionPropPointsType(c):WH2.getItemRandPropPointsType(c,!WH2.Wow.Expansion.available(WH2.Wow.Expansion.MOP));var C=[];for(m=c.level;m>=0;m--)if(d.hasOwnProperty(m)){C=d[m];break}let E=0;if(-1!=H){let e=0;if(W){switch(c.quality){case WH2.Wow.Item.QUALITY_EPIC:e=0;break;case WH2.Wow.Item.QUALITY_RARE:e=2;break;case WH2.Wow.Item.QUALITY_UNCOMMON:e=4;break;default:e=-1}if(-1!==e){e+=H;let t=WH2.findSparseKey(g,m),a=WH2.findSparseKey(g[t]||{},e);E=(g[t]||{})[a]||0}}else if(w){let e=null;switch(c.slot){case WH2.Wow.Item.INVENTORY_TYPE_BACK:e=WH2.isCataTree()?9:7;break;case WH2.Wow.Item.INVENTORY_TYPE_SHOULDERS:e=30;break;case WH2.Wow.Item.INVENTORY_TYPE_TRINKET:e=31;break;case WH2.Wow.Item.INVENTORY_TYPE_FINGER:e=9;break;case WH2.Wow.Item.INVENTORY_TYPE_ONE_HAND:e=11;break;case WH2.Wow.Item.INVENTORY_TYPE_MAIN_HAND:e=WH2.isCataTree()?11:7;break;case WH2.Wow.Item.INVENTORY_TYPE_RANGED:e=10;break;default:e=7}f[s]&&f[s][e]&&(E=f[s][e])}else{switch(c.quality){case WH2.Wow.Item.QUALITY_LEGENDARY:case WH2.Wow.Item.QUALITY_EPIC:e=0;break;case WH2.Wow.Item.QUALITY_HEIRLOOM:case WH2.Wow.Item.QUALITY_RARE:e=1;break;case WH2.Wow.Item.QUALITY_UNCOMMON:e=2}let t=WH2.findSparseKey(C,e),a=WH2.findSparseKey(C[t]||{},H);E=(C[t]||{})[a]||0}}let T=h[WH2.findSparseKey(h,m)]||0;for(var p in WH2.statToJson){var R=WH2.statToJson[p];if(c[R]||c.statsInfo&&c.statsInfo[p]){var M=0,N=0;c.statsInfo.hasOwnProperty(p)&&(M=parseFloat(c.statsInfo[p].socketMult),N=parseInt(c.statsInfo[p].alloc));var D=Math.round(M*T);switch(N&&(E>0||c.contenttuning>0)?c[R]=1e-4*N*E-D:c[R]=(c[R]+D)*L-D,"sta"==R?c[R]=c[R]*WH2.getStaminaRatingMult(c.level,c.slot||g_items[c.id].slot):o&&WH2.inArray(WH2.applyStatModifications.BASE_STATS,p)<0?c[R]=c[R]*WH2.getCombatRatingMult(c.level,c.slot||g_items[c.id].slot):"corruption"!==R&&"corruptionres"!==R||(c[R]=N),R){case"agistrint":c.agi=c.str=c.int=c[R];break;case"agistr":c.agi=c.str=c[R];break;case"agiint":c.agi=c.int=c[R];break;case"strint":c.str=c.int=c[R]}}}if(c.scadist>0&&(c.dbcFlags??0)&l.DBCITEM_FLAGS_SCALING_SPELL_POWER){let e=f[s]?.[l.ITEM_SCALING_VALUE_SPELL_POWER_INDEX]??0;c.statsInfo[WH2.Wow.Item.Stat.ID_SPELL_POWER]=e,c.splpwr=e}if(c.armor||w){let e=c.quality===l.QUALITY_HEIRLOOM?l.QUALITY_RARE:c.quality,a=c.subclass===l.ARMOR_SUBCLASS_CLOAKS?l.ARMOR_SUBCLASS_CLOTH:c.subclass;if(w){let e=null;l.WRATH_ARMOR_SCALING_INDEXES[c.subclass]&&l.WRATH_ARMOR_SCALING_INDEXES[c.subclass][c.slot]&&(e=l.WRATH_ARMOR_SCALING_INDEXES[c.subclass][c.slot]),f[s]&&f[s][e]&&(c.armor=f[s][e])}else if(l.isBodyArmor(l.CLASS_ARMOR,a)){let n=WH2.findSparseKey(r,c.level),i=WH2.findSparseKey(r[n]||{},e),s=(r[n]||{})[i]||0,o=WH2.findSparseKey(t,c.level),l=WH2.findSparseKey(t[o]||{},a-1),d=(t[o]||{})[l]||0,p=u[c.slot][a-1];c.armor=Math.floor(d*s*p+.5)}if(c.subclass===l.ARMOR_SUBCLASS_SHIELDS){let t=WH2.findSparseKey(i,c.level),a=WH2.findSparseKey(i[t]||{},e);c.armor=Math.round((i[t]||{})[a]||0)}}if(c.dps||w){var O=["dps","mledps","rgddps"],P=["dmgmin1","mledmgmin","rgddmgmin","dmgmax1","mledmgmax","rgddmgmax"],x=WH2.getEffectiveWeaponDamage(c,!1),k=WH2.getEffectiveWeaponDamage(c,!0);x=Math.floor(Math.max(1,x)),k=Math.max(1,k),WH2.isRetailTree()||(x=c.damagemin||c.dmgmin1||x,k=c.damagemax||c.dmgmax1||k);let e=0;if(w){let t=null;switch(c.subclass){case l.WEAPON_SUBCLASS_DAGGER:case l.WEAPON_SUBCLASS_FIST_WEAPON:case l.WEAPON_SUBCLASS_ONE_HANDED_AXE:case l.WEAPON_SUBCLASS_ONE_HANDED_SWORD:t=0;break;case l.WEAPON_SUBCLASS_FISHING_POLE:case l.WEAPON_SUBCLASS_POLEARM:case l.WEAPON_SUBCLASS_TWO_HANDED_AXE:case l.WEAPON_SUBCLASS_TWO_HANDED_MACE:case l.WEAPON_SUBCLASS_TWO_HANDED_SWORD:t=1;break;case l.WEAPON_SUBCLASS_ONE_HANDED_MACE:t=WH2.isCataTree()?0:2;break;case l.WEAPON_SUBCLASS_STAFF:t=WH2.isCataTree()?4:3;break;case l.WEAPON_SUBCLASS_BOW:case l.WEAPON_SUBCLASS_CROSSBOW:case l.WEAPON_SUBCLASS_GUN:case l.WEAPON_SUBCLASS_THROWN:t=4;break;case l.WEAPON_SUBCLASS_WAND:t=5;break;default:t=-1}f[s]&&f[s][t]&&(e=f[s][t],x=Math.floor(e*c.speed*(1-c.dmgrange/2)),k=Math.floor(e*c.speed*(1+c.dmgrange/2)+.5),c.dmgmin1=x,c.dmgmax1=k)}else e=(x+k)/2/c.speed;var B=e>=1e3?0:WH2.isRetailTree()?1:2;for(var p in e=parseFloat(e.toFixed(B)),O)(c[O[p]]||w)&&(c[O[p]]=e);for(var p in P)c[P[p]]&&(-1!=P[p].indexOf("max")?c[P[p]]=k:c[P[p]]=x)}}return c},WH2.applyStatModifications.BASE_STATS=[4,3,5,71,72,73,74,7,1,0,8,9,2,10],WH2.getItemDamageValue=function(e,t,a){let n=WH2.applyStatModifications.ScalingData.DV;if(n&&n[e]){let i=7*a+t;return n[e][WH2.findSparseKey(n[e],i)]}return 0},WH2.getEffectiveWeaponDamage=function(e,t){var a=e.level,n=e.subclass,i=e.quality,s=e.slotbak?e.slotbak:e.slot,o=0,r=!1,l=512&e.flags2;if(2!=e.classs)return 0;if(i>7)return 0;if(7==i&&(i=3),s>22?(24==s&&(o=0,r=!0),!r&&(s<=24||s>26)&&(r=!0)):(21!=s&&22!=s&&13!=s||(o=l?WH2.getItemDamageValue(a,i,1):WH2.getItemDamageValue(a,i,0),r=!0),r||15==s||(17!=s||(o=l?WH2.getItemDamageValue(a,i,3):WH2.getItemDamageValue(a,i,2)),r=!0)),!r&&n>=2&&(2!=n&&3!=n&&18!=n||(o=l?WH2.getItemDamageValue(a,i,3):WH2.getItemDamageValue(a,i,2),r=!0),r||19!=n||(o=WH2.getItemDamageValue(a,i,1))),o>0){var c=e.dmgrange||0;return t?Math.floor(o*e.speed*(1+c/2)+.5):o*e.speed*(1-c/2)}return 0},WH2.getJsonReforge=function(e,t){if(!t){if(!WH2.reforgeStats)return[];for(var t in e.__reforge={},e.__reforge.all=[],WH2.reforgeStats){(n=WH2.getJsonReforge(e,t)).amount&&e.__reforge.all.push(n)}return e.__reforge.all}if(!WH2.reforgeStats||!WH2.reforgeStats[t])return{};for(var a in e.__statidx={},e)WH2.individualToGlobalStat[WH2.jsonToStat[a]]?e.__statidx[WH2.individualToGlobalStat[WH2.jsonToStat[a]]]=e[a]:e.__statidx[WH2.jsonToStat[a]]=e[a];e.__reforge||(e.__reforge={});var n=e.__reforge[t]=WH2.dO(WH2.reforgeStats[t]);return e.__reforge[t].amount=Math.floor(n.v*(e.__statidx[n.i1]&&!e.__statidx[n.i2]?e.__statidx[n.i1]:0)),e.__reforge[t]},WH2.getJsonItemEnchantMask=function(e){return 2==e.classs&&19==e.subclass?1<<20:1<<e.slot-1},WH2.getArtifactKnowledgeMultiplier=function(e){let t=WH2.Tooltips.getScalingData(WH2.Types.ITEM,"artifactKnowledgeMultiplier")||{};return t[WH2.findSparseKey(t,e)]||1},WH2.getCurveValue=function(e,t){var a;if(WH2.curvePoints&&(a=WH2.curvePoints[e])){var n=a[0][1],i=a[0][2];if(n>t)return i;for(var s,o=0;s=a[o];o++){if(t==s[1])return s[2];if(t<s[1])return(s[2]-i)/(s[1]-n)*(t-n)+i;n=s[1],i=s[2]}return i}},WH2.setItemModifications=function(e,t,a,n,i,s,o){if(!WH2.isSet("g_items")||!g_items[t]||!g_items[t].jsonequip)return e;const r=WH2.Wow.Item.Gems;i||(i=WH2.Wow.getMaxPlayerLevel()),a=a?a.split(":"):null,s||(s=WH2.Timewalking.getGearIlvlByStringId(n)||0),n=s?null:n;var l=WH2.applyStatModifications(g_items[t].jsonequip,0,n,s,a,i,void 0,o);!l.name&&g_items[t].hasOwnProperty("name_"+Locale.getName())&&(l.name=g_items[t]["name_"+Locale.getName()],l.quality=g_items[t].quality),e=e.replace(/(<!--ilvl-->)\d+\+?/,(function(e,t){return t+l.level+(l.previewLevel?"+":"")}));let c=!1,d=1,p=WH2.Wow.getMaxPlayerLevel();if(l.scadist){let e=WH2.getScalingDistributionCurve(l.scadist);e&&e.maxLevel&&(c=!0,d=e.minLevel||1,p=e.maxLevel)}else if(l.contenttuning){let e=WH2.getContentTuningLevels(l.contenttuning);e&&(c=!0,d=e.minLevel,p=e.maxLevel)}else if(l.scadistbonus&&13===l.scadistbonustype&&l.playercurve){let e=WH2.curvePoints[l.playercurve];d=e[0][1],p=Math.min(e[e.length-1][1],WH2.Wow.getMaxPlayerLevel()),c=!0}if(c){i=i&&i<=p?i:p,e=e.replace(/(<!--lvl-->)\d+/g,(function(e,t){return t+(i&&i<=p?i:p)})),e=e.replace(/(<!--minlvl-->)\d+/,(function(e,t){return t+d})),e=e.replace(/(<!--maxlvl-->)\d+/,(function(e,t){return t+p}));let a=!1;e=e.replace(/<!--i\?(\d+):(\d+):(\d+):(\d+)(?::(\d+):(\d+))?/,(function(e,t,n,s,o,r,c){return a=!0,"\x3c!--i?"+t+":"+d+":"+p+":"+i+":"+(l.scadist||l.contenttuning)+":"+(c||0)})),a||(e+="\x3c!--i?"+t+":"+d+":"+p+":"+i+":"+(l.scadist||l.contenttuning)+":0--\x3e"),e=e.replace(/(<!--huindex-->)\d+/,(function(e,t){let a=0;if(l.scadistbonus&&l.heirloombonuses)for(let e,t=0;e=l.heirloombonuses[t];t++)if(parseInt(l.scadistbonus)===e){a=t+1;break}return t+a}))}else e=e.replace(/<!--i\?(\d+):(\d+):(\d+):(\d+)(?::(\d+):(\d+))?/,(function(e,t,a,n,s,o,r){return"\x3c!--i?"+t+":"+a+":"+n+":"+(i||n)}));var u;(u=WH2.ge("sl"+t))&&(u.style.display=c?"block":"none"),e=e.replace(/(<!--pvpilvl-->)\d+/,(function(e,t){return t+(l.level+("pvp"!=n?l.pvpUpgrade:0))})),e=e.replace(/(<!--ilvldelta-->)\d+/,(function(e,t){return t+Math.floor(WH2.getCurveValue(1718,l.level)||2)})),e=e.replace(/(<!--rlvl-->)\d+/,(function(e,t){return t+l.reqlevel})),e=e.replace(/(<!--uindex-->)\d+/,(function(e,t){return n&&"pvp"!=n?t+n:e}));var h=void 0!==l.dmgrange&&l.dmgrange,g=new RegExp("(\x3c!--dmg--\x3e)[\\d,]+"+(h?"(\\D*?)[\\d,]+":""));e=e.replace(g,(function(e,t,a){return t+WH2.numberFormat(l.dmgmin1)+(h?a+WH2.numberFormat(l.dmgmax1):"")})),e=e.replace(/(<!--dps-->\D*?)([\d,]+(?:\.\d+)?)/,(function(e,t){var a=l.dps>=1e3?0:WH2.isRetailTree()?1:2;return t+(l.dps?WH2.numberFormat(l.dps.toFixed(a)):"0")})),e=e.replace(/(<!--amr-->)\d+/,(function(e,t){return t+l.armor}));var f=WH2.getCombatRatingMult(l.level,g_items[t].slot);if(e=function(e){let t=WH2.ce("div",{innerHTML:e});return WH2.qsa("span",t).forEach((function(e){let t,a,n,i;if(e.childNodes.forEach((function(e){if(e.nodeType===Node.COMMENT_NODE){let s;(s=(e.nodeValue||"").match(/^stat(\d+)$/))&&(t=parseInt(s[1]),n=e),(s=(e.nodeValue||"").match(/^rtg(\d+)$/))&&(a=parseInt(s[1]),i=e)}})),void 0===t&&void 0===a)return;let s=!1;if(a){let e=l[WH2.statToJson[a]]?l[WH2.statToJson[a]]:0,t=e<0?"-":"+";e?e=Math.round(e*f):(s=!0,e=0);let n=i.previousSibling;n&&n.nodeType===Node.TEXT_NODE&&(n.nodeValue=n.nodeValue.replace(/[-+]$/,t));let o=i.nextSibling;o&&o.nodeType===Node.TEXT_NODE&&(o.nodeValue=o.nodeValue.replace(/[-\d\.,]+/,e))}else{let e=l[WH2.statToJson[t]]?l[WH2.statToJson[t]]:0;if(e){let t=Math.round(e);e=(t>0?"+":"-")+WH2.numberLocaleFormat(t)}else s=!0,e="+0";let a=n.nextSibling;a&&a.nodeType===Node.TEXT_NODE&&(a.nodeValue=a.nodeValue.replace(/[-+][-\d\.,]+/,e))}if(s){WH2.displayNone(e);let t=e.nextSibling;for(;t;){if(t.nodeType===Node.ELEMENT_NODE){"br"===t.nodeName.toLowerCase()&&t.parentNode.replaceChild(document.createComment("br"),t);break}t=t.nextSibling}}else WH2.displayDefault(e)})),t.innerHTML}(e),l.extraStats&&l.extraStats.length){e=e.replace(/<!--re--><span[^<]*?<\/span>(<br \/>)?/,"");var m=WH2.applyStatModifications.BASE_STATS;e=e.replace(/<!--ebstats-->/,(function(e){for(var t="",a=0;a<l.extraStats.length;++a){var n=l.extraStats[a];if(-1!=m.indexOf(n)){var i="$1$2 "+(WH2.statToJson&&WH2.statToJson[n]&&WH2.Wow.Item.Stat.jsonToName(WH2.statToJson[n])||"Unknown"),s=WH2.statToJson&&WH2.statToJson[n]?l[WH2.statToJson[n]]:0,o=Math.round(s*f),r=WH2.numberLocaleFormat(o);t+="<br /><span>\x3c!--stat"+n+"--\x3e"+WH2.sprintf(i,o<0?"-":"+",r)+"</span>"}}return t+e})),e=e.replace(/<!--egstats-->/,(function(e){for(var t="",a=0;a<l.extraStats.length;++a){var n=l.extraStats[a];if(-1==m.indexOf(n)){var i=f,s="q2";switch(WH2.statToJson[n]){case"corruption":s="stat-corruption",i=1;break;case"corruptionres":s="q6",i=1}var o="$1$2 "+(WH2.statToJson&&WH2.statToJson[n]&&WH2.Wow.Item.Stat.jsonToName(WH2.statToJson[n])||"Unknown"),r=WH2.statToJson&&WH2.statToJson[n]?l[WH2.statToJson[n]]:0,c=Math.round(r*i),d=WH2.numberLocaleFormat(c),p=WH2.sprintf("\x3c!--rtg$1--\x3e$2",n,d),u="";WH2.statToRating&&WH2.statToRating[n]&&(u=WH2.sprintf("&nbsp;<small>(\x3c!--rtg%$1--\x3e0&nbsp;@&nbsp;L$2"+WH2.Wow.getMaxPlayerLevel()+")</small>",n,"\x3c!--lvl--\x3e"));var h="";50==n&&(h="\x3c!--stat%d--\x3e"),64==n&&(o=o.substr(5),u=""),t+='<br /><span class="'+s+'">'+h+WH2.sprintf(o,c>=0?"+":"-",p)+u+"</span>"}}return t+e}))}l.itemNameDescStats?.length&&(e=e.replace(/<!--nameDescStats-->/,(e=>{let t="";return l.itemNameDescStats.forEach((e=>{let a=WH2.Wow.Item.getNameDescription(e.nameDescId);if(a){let n=WH2.Wow.Item.getNameDescriptionColor(e.nameDescId),i=parseInt(n).toString(16);for(;i.length<6;)i="0"+i;t+=WH2.sprintf('<br><span style="color: $1">$2$3 $4</span>',"#"+i,e.qty>=0?"+":"",e.qty,a)}})),t+e}))),e=e.replace(/(<!--nstart-->)(.*)(<!--nend-->)/,(function(e,t,a,n){var i=l.quality,s=l.name,o=l.nameSuffix?" "+l.nameSuffix:"";return t+WH2.sprintf('<b class="q$1">$2</b>',i,s+o)+n})),e=e.replace(/(<!--ndstart-->)(.*)(<!--ndend-->)/,(function(e,t,a,n){return l.namedesc?t+"<br />"+l.namedesc+n:t+n}));var W=0|g_items[t].jsonequip.nsockets;if(!W&&l.nsockets||W&&l.nsockets>W){const t=81,a=225,n=1,i=2,s=3,o=4,c=5,d=6,p=9,u=10,h=11,g=12,f=13,m=14,H=15,E=16;e=e.replace(/<!--ps-->(<br(?: \/)?>)?/,(function(e,T){for(var v="",S=W;S<l.nsockets;++S){if(!l["socket"+(S+1)])continue;let e=l["socket"+(S+1)];var I="socket-unknown";let W=t;var y=e;switch(e){case r.SOCKET_META:I="socket-meta",W=t,y=n;break;case r.SOCKET_RED:I="socket-red",W=t,y=i;break;case r.SOCKET_YELLOW:I="socket-yellow",W=t,y=s;break;case r.SOCKET_BLUE:I="socket-blue",W=t,y=o;break;case r.SOCKET_SHA_TOUCHED:I="socket-hydraulic",W=t,y=c;break;case r.SOCKET_COGWHEEL:I="socket-cogwheel",W=t,y=d;break;case r.SOCKET_PRISMATIC:I="socket-prismatic",W=t,y=p;break;case r.SOCKET_RELIC_IRON:I="socket-relic-iron",W=a,y=64;break;case r.SOCKET_RELIC_BLOOD:I="socket-relic-blood",W=a,y=128;break;case r.SOCKET_RELIC_SHADOW:I="socket-relic-shadow",W=a,y=256;break;case r.SOCKET_RELIC_FEL:I="socket-relic-fel",W=a,y=512;break;case r.SOCKET_RELIC_ARCANE:I="socket-relic-arcane",W=a,y=1024;break;case r.SOCKET_RELIC_FROST:I="socket-relic-frost",W=a,y=2048;break;case r.SOCKET_RELIC_FIRE:I="socket-relic-fire",W=a,y=4096;break;case r.SOCKET_RELIC_WATER:I="socket-relic-water",W=a,y=8192;break;case r.SOCKET_RELIC_LIFE:I="socket-relic-life",W=a,y=16384;break;case r.SOCKET_RELIC_STORM:I="socket-relic-storm",W=a,y=32768;break;case r.SOCKET_RELIC_HOLY:I="socket-relic-holy",W=a,y=65536;break;case r.SOCKET_PUNCHCARD_RED:I="socket-red",W=t,y=u;break;case r.SOCKET_PUNCHCARD_YELLOW:I="socket-yellow",W=t,y=h;break;case r.SOCKET_PUNCHCARD_BLUE:I="socket-blue",W=t,y=g;break;case r.SOCKET_DOMINATION:I="socket-domination",W=t,y=f;break;case r.SOCKET_CRYSTALLIC:I="socket-crystallic",W=t,y=m;break;case r.SOCKET_TINKER:I="socket-tinker",W=t,y=H;break;case r.SOCKET_PRIMORDIAL:I="socket-primordial",W=t,y=E}let T=WH2.Url.generatePath(WH2.sprintf("/items/gems?filter=$1;$2;0",W,y));var _=WH2.sprintf('<a href="'+WH2.Strings.escapeHtml(T)+'" class="$1 q0">',I);_+=r.getSocketName(e)||"Unknown Socket",v+="<br>"+(_+="</a>")}return(0==W?"<br>":"")+v+"<br><br>"}))}if(a){let t=WH2.Tooltips.getScalingData(WH2.Types.ITEM,"bonusEffects"),n=t&&t.bonus;n&&(e=e.replace(/<!--itemEffects:(\d)-->/,(function(e,i){let s=l.extraStats&&l.extraStats.indexOf(parseInt(WH2.jsonToStat.corruption))>=0,o="";for(let e,i=0;e=a[i];i++){let a=n[e]||[];for(let e,n=0;e=a[n];n++){let a=t.effect[e];a&&(s&&(a=a.replace(/\b(class=")q2\b/g,"$1stat-corruption")),o+=(o?"<br>":"")+a)}}return o+(o&&i?"<br>":"")+e})))}if(WH2.applyStatModifications&&WH2.convertScalingSpell.SpellInformation){for(var H,E={effects:{}},T=/(<!--pts(\d):(\d):(\d+(?:\.\d+)?):(\d+)(:\d+(?:\.\d+)?)?(:crm)?-->(?:<!--rtg\d+-->)?)(\d+(?:\.\d+)?)(<!---->(%?))?/g;null!==(H=T.exec(e));){var v=H[2],S=H[3],I=H[5];if(I<=0)continue;E[I]=E[I]||{};let e=l.scadistbonus&&13===l.scadistbonustype?g_items[t].level:l.level;WH2.cO(E[I],WH2.convertScalingSpell(E[I],I,v,S,i,e))}e=WH2.adjustSpellPoints(e,E,l.level,g_items[t].jsonequip.slot)}let y=WH2.Timewalking.getCharLevelFromIlvl(s)||0;return y&&(e=e.replace(/<!--ee(\d+):(\d+):(\d+):(\d+):(\d+):(\d+)-->([^<]*)<\/span>/gi,(function(e,t,a,n,i,s,o,r){var l={enchantment:r,scalinginfo:{scalingcategory:t,minlvlscaling:a,maxlvlscaling:n,damage1:i/1e3,damage2:s/1e3,damage3:o/1e3}};return"\x3c!--ee--\x3e"+WH2.scaleItemEnchantment(l,y)+"</span>"}))),e=e.replace(/(<!--rtg%(\d+)-->)([\.,0-9]+)%?/g,(function(t,a,n,s){if(_=e.match(new RegExp("\x3c!--rtg"+n+"--\x3e([\\d\\.,]+)(-[\\d\\.,]+)?")),!_)return t;_[2]&&(_[2]=_[2].replace(/\D/,"")),_[1]=_[1].replace(/\D/,"");var o=_[2]?(Math.abs(parseInt(_[2]))+parseInt(_[1]))/2:_[1];return a+(_[2]?"~":"")+Math.round(100*WH2.convertRatingToPercent(i||WH2.Wow.getMaxPlayerLevel(),n,o))/100+(49!=n?"%":"")})),e=e.replace(/<!--bo-->(<br(?: \/)?>)?([^<]+)/,(function(e,t,a){return l.bond&&(a=WH2.Wow.Item.getBondTypeName(l.bond)),"\x3c!--bo--\x3e"+t+a})),e=e.replace(/<!--bo-->/,(function(e){if(!a)return e;let t=WH2.getPageData("wow.item.bonuses.upgrades")||{},n="";return a.some((function(e){if(t[e]){let a=WH2.ce("div");return WH2.ae(a,WH2.ce("br")),WH2.ae(a,WH2.ce("span",{className:"q"},WH2.ct(t[e][2]?WH2.Strings.sprintf(WH2.GlobalStrings.ITEM_UPGRADE_TOOLTIP_FORMAT_STRING,t[e][2],t[e][0],t[e][1]):WH2.Strings.sprintf(WH2.GlobalStrings.ITEM_UPGRADE_TOOLTIP_FORMAT,t[e][0],t[e][1])))),n=a.innerHTML,!0}})),n+e})),e=e.replace(/<!--ue-->/,(function(){if(!l.limitcategory)return"";let e="",t=(WH2.getPageData("wow.item.bonusLimitCategoryNames")||{})[l.limitcategory];if(t){let a=t.uniqueEquipped?WH2.GlobalStrings.ITEM_UNIQUE_EQUIPPABLE:WH2.GlobalStrings.ITEM_UNIQUE;e=WH2.Strings.escapeHtml(a+WH2.TERMS.colon_punct+WH2.Strings.sprintf(WH2.TERMS.parens_format,t.name,t.maxCount)),e="<br />"+e}return e})),function(){var a=WH2.ce("div");a.innerHTML=e,a.querySelectorAll('a[href*="/spell="]').forEach((function(e){var t=e.dataset.wowhead||"";t=t.replace(/(^|&)i?lvl=\d+/g,""),i&&(t+=(t?"&":"")+"lvl="+i),l.level&&(t+=(t?"&":"")+"ilvl="+l.level),e.dataset.wowhead=t}));let n=WH2.getPageData("item.sellprice."+t),s=a.querySelector(".WH2tt-sellprice");if(n&&s){let e=s.firstChild;WH2.ee(s),WH2.ae(s,e);let t=n.itemLevel,a=t[l.level]||t[Math.max.apply(null,Object.keys(t))],i=n.quality[l.quality]||0,o=Math.floor(n.base*a*i);WH2.ae(s,WH2.Wow.buildMoney({copper:o}))}e=a.innerHTML}(),e},WH2.setTooltipLevel=function(e,t,a){var n=typeof e;if("number"==n){var i=WH2.getDataSource();if(!i[e]||!i[e][(a?"buff_":"tooltip_")+Locale.getName()])return e;e=i[e][(a?"buff_":"tooltip_")+Locale.getName()]}else if("string"!=n)return e;e=e.replace(/<!--(gem|ee)(\d+):(\d+):(\d+):(\d+):(\d+):(\d+)-->([^<]*)<\/span>/gi,(function(e,a,n,i,s,o,r,l,c){var d={enchantment:c,scalinginfo:{scalingcategory:n,minlvlscaling:i,maxlvlscaling:s,damage1:o/1e3,damage2:r/1e3,damage3:l/1e3}};return"\x3c!--"+a+"--\x3e"+WH2.scaleItemEnchantment(d,t)+"</span>"}));var s,o,r=e.match(/<!--i?\?([0-9-:]*)-->/);if(r&&(s=r[1].split(":").map(Number),t=Math.min(s[2],Math.max(s[1],t)),o=s[4]||0),o)if(e.match(/<!--pts\d:\d:\d+(?:\.\d+)?:\d+-->/g)||o<0||a)if(o>0){!s[7]&&WH2.isSet("g_pageInfo")&&3==g_pageInfo.type&&g_items[g_pageInfo.typeId]&&7!=g_items[g_pageInfo.typeId].quality&&(t=Math.min(g_items[g_pageInfo.typeId].reqlevel,t));var l={scadist:o};e=e.replace(/<!--cast-->\d+\.\d+/,"\x3c!--cast--\x3e"+l.cast);var c=/<!--pts([0-9-:]*)-->/g,d=c.exec(e);for(l.effects=!0;null!=d;){var p=d[1].split(":").map(Number),u=p[0],h=p[1],g=p[3];g>0&&(null==l[g]&&(l[g]={},l[g].effects={}),WH2.cO(l[g],WH2.convertScalingSpell(l[g],g,u,h,t,t))),d=c.exec(e)}if(l.effects){var f=5;if(window.g_pageInfo&&window.g_pageInfo.type==WH2.Types.AZERITE_ESSENCE_POWER&&(f=WH2.Wow.Item.INVENTORY_TYPE_NECK),e=WH2.adjustSpellPoints(e,l,t,f),this.modified)for(var m in this.modified[1])for(var W=this.modified[1][m],H=0;H<W.length;++H)W[H][0]=WH2.adjustSpellPoints(W[H][0],l,t,f),W[H][1]=WH2.adjustSpellPoints(W[H][1],l,t,f)}}else for(var E=-o,T=WH2.getSpellScalingValue(E,t),v=0;v<3;++v){var S=s[5+v]/1e3;e=e.replace(new RegExp("\x3c!--gem"+(v+1)+"--\x3e(.+?)<"),"\x3c!--gem"+(v+1)+"--\x3e"+Math.round(T*S)+"<")}else e=WH2.setItemModifications(e,s[0],null,null,t),WH2.updateItemStringLink.call(this);return e=e.replace(/<!--ppl(\d+):(\d+):(\d+):(\d+):(\d+)(?::(1))?-->\s*\d+/gi,(function(e,a,n,i,s,o,r){return"\x3c!--ppl"+a+":"+n+":"+i+":"+s+":"+o+"--\x3e"+(r?Math.ceil:Math.floor)(parseInt(s)+(Math.min(Math.max(t,n),i)-n)*o/100)})),e=e.replace(/(<!--rtg%(\d+)-->)([\.0-9]+)%?/g,(function(a,n,i,s){return _=e.match(new RegExp("\x3c!--rtg"+i+"--\x3e(\\d+)")),_?n+Math.round(100*WH2.convertRatingToPercent(t,i,_[1]))/100+(49!=i?"%":""):a})),e=e.replace(/<!--pl(\d+):(\d+):(\d+)-->\s?(\d+)/gi,(function(e,a,n,i,s){return"\x3c!--pl"+a+":"+n+":"+i+"--\x3e"+(t=Math.min(t,WH2.Wow.getMaxPlayerLevel()))})),e=(e=e.replace(/(<!--i?\?\d+:\d+:\d+:)\d+/g,"$1"+t)).replace(/<!--lvl-->\d+/g,"\x3c!--lvl--\x3e"+t)},WH2.updateTooltipSingular=function(e){return e.replace(/(\d+)(\D*)<!--singular:(.*?):(.*?)-->.*?<!--singular-->/gi,(function(e,t,a,n,i){return t+a+"\x3c!--singular:"+n+":"+i+"--\x3e"+(1===parseInt(t)?n:i)+"\x3c!--singular--\x3e"}))},WH2.getSpellScalingValue=function(e,t){var a=WH2.convertScalingSpell?WH2.convertScalingSpell.SV:null;return a?a[t][e-1]:0},WH2.adjustSpellPoints=function(e,t,a,n){var i=1;a&&n&&(i=WH2.getCombatRatingMult(a,n));for(var s=1;s<=20;++s)e=e.replace(new RegExp("\x3c!--pts"+s+":0:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r){var l=t[a]&&t[a].hasOwnProperty("effects")?t[a].effects[s]:t.effects[s];if(!l)return e;var c=Math.round(l.avg*(o?i:1));return"\x3c!--pts"+s+":0:0:"+a+(n||"")+(o||"")+"--\x3e"+(r||"")+c+"<"})),e=e.replace(new RegExp("\x3c!--pts"+s+":1:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r){var l=t[a]&&t[a].hasOwnProperty("effects")?t[a].effects[s]:t.effects[s];if(!l)return e;var c=Math.round(l.min*(o?i:1));return"\x3c!--pts"+s+":1:0:"+a+(n||"")+(o||"")+"--\x3e"+(r||"")+c+"<"})),e=e.replace(new RegExp("\x3c!--pts"+s+":2:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r){var l=t[a]&&t[a].hasOwnProperty("effects")?t[a].effects[s]:t.effects[s];if(!l)return e;var c=Math.round(l.max*(o?i:1));return"\x3c!--pts"+s+":2:0:"+a+(n||"")+(o||"")+"--\x3e"+(r||"")+c+"<"})),e=e.replace(new RegExp("\x3c!--pts"+s+":3:(\\d+(?:\\.\\d+)?):(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r,l){var c=t[n]&&t[n].hasOwnProperty("effects")?t[n].effects[s]:t.effects[s];if(!c)return e;var d=Math.round(c.avg*a*(r?i:1));return"\x3c!--pts"+s+":3:"+a+":"+n+(o||"")+(r||"")+"--\x3e"+(l||"")+d+"<"})),e=e.replace(new RegExp("\x3c!--pts"+s+":4:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?--\x3e(\x3c!--rtg\\d+--\x3e)?(.+?)<","g"),(function(e,a,n,o,r){var l=t[a]&&t[a].hasOwnProperty("effects")?t[a].effects[s]:t.effects[s];if(!l)return e;var c=Math.round(l.pts*(o?i:1));return"\x3c!--pts"+s+":4:0:"+a+(n||"")+(o||"")+"--\x3e"+(r||"")+c+"<"}));return e},WH2.getStaminaRatingMult=function(e,t){if(!WH2.staminaFactor)return 1;let a=0;switch(t){case 2:case 11:a=3;break;case 12:a=2;break;case 13:case 14:case 15:case 17:case 21:case 22:case 23:case 25:case 26:a=1}let n=WH2.findSparseKey(WH2.staminaFactor,e),i=WH2.findSparseKey(WH2.staminaFactor[n]||{},a);return(WH2.staminaFactor[n]||{})[i]||1},WH2.getCombatRatingMult=function(e,t){if(!WH2.convertRatingToPercent.RM)return 1;let a=0;switch(t){case 2:case 11:a=3;break;case 12:a=2;break;case 13:case 14:case 15:case 17:case 21:case 22:case 23:case 25:case 26:a=1}let n=WH2.findSparseKey(WH2.convertRatingToPercent.RM,e),i=WH2.findSparseKey(WH2.convertRatingToPercent.RM[n]||{},a);return(WH2.convertRatingToPercent.RM[n]||{})[i]||1},WH2.roundArtifactPower=function(e){var t=1;return e>50&&(t=5),e>1e3&&(t=25),e>5e3&&(t=50),WH2.roundHalfEven(e/t)*t},WH2.roundHalfEven=function(e){if(Math.floor(1e5*e)%1e5==5e4){var t=Math.floor(e);return t+t%2}return Math.round(e)},WH2.setTooltipSpells=function(e,t,a,n,i=0){if(a=a||{},(t=t||[]).length){let e=window.g_pageInfo?g_pageInfo.typeId:null;if(e){let a=t.indexOf(parseInt(e));-1!==a&&(t[a]=0)}}else t=[0];if(void 0===n){var s=function(e){var t=[];e.hasOwnProperty("data")&&t.push(e.data);for(var a=0;a<e.children.length;a++)t=t.concat(s(e.children[a]));return t};for(let e in a)if(a.hasOwnProperty(e)&&!(a[e].length<2)){for(var o=0;o<a[e].length;o++){a[e][o]={data:a[e][o],children:[]};for(var r=0,l=0;l<=1;l++)for(var c=-1;(c=a[e][o].data[l].indexOf("\x3c!--sp"+e+"--\x3e",c+1))>=0;)r++;var d=o-r;if(!(d<0))for(;r-- >0;){var p=a[e].splice(d,1);o--,a[e][o].children.push(p[0])}}a[e]=s({children:a[e]})}}n=n||{};for(var u,h=function(e){n[e]=(n[e]||0)+1,n[e]>=(a[e]||[]).length&&(n[e]=0)},g=[],f=/<!--sp([0-9]+):[01]-->/g;u=f.exec(e);){var m=u[0],W=u.index+m.length,H="\x3c!--sp"+u[1]+"--\x3e",E=e.indexOf(H,W);if(E<0)return WH2.warn("Could not find closing end tag for tooltip spell.",H,e),e;var T=new RegExp("\x3c!--sp"+u[1]+":[01]--\x3e","g");T.lastIndex=W;for(var v=T.exec(e);v&&v.index<E;){if((E=e.indexOf(H,E+H.length))<0)return WH2.warn("Could not find nested closing end tag for tooltip spell.",H,e),e;v=T.exec(e)}g.push(e.substring(u.index,E+H.length)),f.lastIndex=E+H.length}for(var S=0,I=/^(<!--sp([0-9]+):[01]-->).*(<!--sp\2-->)$/,y=0;y<g.length;++y){var _=g[y].match(I)[2],b=WH2.inArray(t,parseInt(_))>=0?1:0;if(null!=a[_]){null==n[_]&&(n[_]=0);var w=a[_][n[_]];if(null!=w&&null!=w[b]){h(_),b&&(u=w[2].match(/^(!?)(\d+)$/))&&(u[1]?WH2.inArray(t,parseInt(u[2]))>=0&&(b=0):t.push(parseInt(u[2])));var A=w[b],L="\x3c!--sp"+_+":"+b+"--\x3e"+(A=WH2.setTooltipSpells(A,t,a,n,i+1))+"\x3c!--sp"+_+"--\x3e";if(S=(e=e.substr(0,S)+e.substr(S).replace(g[y],L)).indexOf(L,S)+L.length,b)for(var C=y+1;C<g.length&&e.indexOf(g[C],S)===S;C++)L=(u=g[C].match(I))[1]+u[3],e=e.substr(0,S)+e.substr(S).replace(g[C],L),h(u[2]),S+=L.length,y++}}}return e=WH2.Tooltips.evalFormulas(e,i)},WH2.enhanceTooltip=function(e,t,a,n,i,s,o,r,l,c,d,p,u){if((!WH2.applyStatModifications||!WH2.applyStatModifications.ScalingData)&&(u||r))return g_itemScalingCallbacks.push(function(h){return function(){var g=WH2.enhanceTooltip.call(h,e,t,a,n,i,s,o,r,l,c,d,p,u);WH2.updateTooltip.call(h,g)}}(this)),WH2.TERMS.loading_ellipsis;var h,g,f=typeof e,m=WH2.getDataSource(),W=WH2.isSet("g_pageInfo")?g_pageInfo.type:null;if(g=WH2.isSet("g_pageInfo")?g_pageInfo.typeId:null,this._spellModifiers=s,"number"==f){var H="tooltip_";if(i&&(H="buff_"),d&&(H="tooltip_premium_"),p&&(H="text_"),!m[g=e]||!m[g][H+Locale.getName()])return e;e=m[g][H+Locale.getName()],h=m[g][(i?"buff":"")+"spells_"+Locale.getName()],this._rppmModList=m[g].rppmmod,h&&(e=WH2.setTooltipSpells(e,s,h))}else if("string"!=f)return e;let E,T;if(a){var v=WH2.getGets();if(v.lvl)T=Math.min(v.lvl,WH2.Wow.getMaxPlayerLevel()),e=WH2.setTooltipLevel(e,T,i);else{let e=WH2.Wow.Season.MAX_LEVEL_BY_PHASE[WH2.getDataEnv()]?.[WH2.Wow.Season.getCurrentPhase()];e&&(T=e)}T&&(e=WH2.setTooltipLevel(e,T,i)),E=v.ilvl}let S,I=WH2.parseQueryString(WH2.getQueryString()),y=function(){return I["crafted-stats"]?I["crafted-stats"].split(":").map((function(e){return parseInt(e)})).filter((function(e){return WH2.Wow.Item.Stat.CRAFTING_STAT_TO.includes(e)})):[]},_=y();if((u||r||_.length)&&g&&(e=WH2.setItemModifications(e,g,u,r,this._selectedLevel?this._selectedLevel:null,E,_)),t&&(e=e.replace(/\(([^\)]*?<!--lvl-->[^\(]*?)\)/gi,(function(e,t){return'(<a href="javascript:" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="WH2.staticTooltipLevelClick(this, null, 0)" onmouseover="WH2.Tooltips.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + WH2.TERMS.clicktochangelevel_stc + \'</span>\')" onmousemove="WH2.Tooltips.cursorUpdate(event)" onmouseout="WH2.Tooltips.hide()">'+t+"</a>)"})),e.indexOf("\x3c!--artpow:")>0)){if(!this.hasOwnProperty("_knowledgeLevel")){var b=/(&|\?)artk=(\d+)/.exec(location.href);b&&parseInt(b[2])<=g_artifact_knowledge_max_level&&(this._knowledgeLevel=parseInt(b[2]))}var w=this._knowledgeLevel?parseInt(this._knowledgeLevel):0;e=e.replace(/(<!--ndstart-->)?<!--ndend-->/i,(function(e,t){return(t?t+"<br />":" ")+'<a href="javascript:" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="WH2.staticTooltipKnowledgeLevelClick(this, null, '+g+')" onmouseover="WH2.Tooltips.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + WH2.TERMS.clicktochangelevel_stc + \'</span>\')" onmousemove="WH2.Tooltips.cursorUpdate(event)" onmouseout="WH2.Tooltips.hide()">'+WH2.sprintf(WH2.TERMS.knowledge_format.replace("%d","$1"),w)+"</a>"})),e=e.replace(/(<!--artpow:(\d+)-->)[\d\.\,]+/,(function(e,t,a){return t+WH2.numberLocaleFormat(WH2.roundArtifactPower(parseInt(a)*WH2.getArtifactKnowledgeMultiplier(w)))}))}if(n&&Slider){var A=WH2.groupSizeScalingShouldShow(g);if(i)i.bufftip=this,A&&WH2.isSet("g_difficulties")&&g_difficulties[A]&&(e=WH2.groupSizeScalingOnChange.call(i,this,g_difficulties[A].maxplayers,1,!0));else{var L=new RegExp("\x3c!--"+(W&&3==W?"i":"")+"\\?(\\d+):(\\d+):(\\d+):(\\d+)"),C=e.match(L);if(void 0===C&&3==W&&(L=new RegExp("\x3c!--\\?(\\d+):(\\d+):(\\d+):(\\d+)"),C=e.match(L)),!C&&!WH2.isRetailTree()){L=new RegExp("\x3c!--ppl(\\d+):(\\d+):(\\d+):(\\d+):(\\d+)");let t=e.match(L);t&&(C=[null,null,t[2],WH2.Wow.getMaxPlayerLevel(),T??WH2.Wow.getMaxPlayerLevel()])}if(!C){L=new RegExp("\x3c!--pl(\\d+):(\\d+):(\\d+)--\x3e\\s?(\\d+)");let t=e.match(L);t&&(C=[null,null,t[2],t[3],T??t[4]])}if(A&&WH2.isSet("g_difficulties")&&g_difficulties[A]){var R=WH2.ce("label");R.innerHTML=WH2.TERMS.difficulty+": ",this._difficultyBtn=WH2.ce("a"),this._difficultyBtn.ttId=g,WH2.difficultyBtnBuildMenu.call(this,g),Menu.add(this._difficultyBtn,this._difficultyBtn.menu);let t=WH2.ge("dd"+g);WH2.ae(t,R),WH2.ae(t,this._difficultyBtn),t.style.display="block",WH2.difficultyBtnOnChange.call(this,m[g].initial_dd||A,m[g].initial_ddSize),e=WH2.groupSizeScalingOnChange.call(this,this,g_difficulties[A].maxplayers,0,!0)}else C&&C[2]!=C[3]&&(this.slider=Slider.init(n,{maxValue:parseInt(C[3]),minValue:Math.max(parseInt(C[2]),1),onMove:WH2.tooltipSliderMove.bind(this),title:WH2.GlobalStrings.LEVEL}),n.style.display="block",Slider.setValue(this.slider,parseInt(C[4])),this.slider.onmouseover=function(e){WH2.Tooltips.showAtCursor(e,WH2.TERMS.dragtochangelevel_stc,"q2")},this.slider.onmousemove=WH2.Tooltips.cursorUpdate,this.slider.onmouseout=WH2.Tooltips.hide,WH2.Tooltips.attach(Slider.getInput(this.slider),WH2.TERMS.clicktochangelevel_stc,"q2"))}}if(o&&!o.dataset.initialized){if(i&&i.modified)i.bufftip=this;else{let e=WH2.getPageData("WH2.Wow.Covenant.data");for(let t in h){let a=Object.keys(e).find((a=>e[a].spellId===parseInt(t)));if((!WH2.Gatherer.get(WH2.Types.SPELL,t)||s.includes(t))&&!a)continue;let n=WH2.Gatherer.get(WH2.Types.SPELL,t),i=n["name_"+Locale.getName()],r=n["rank_"+Locale.getName()]||"",l=r?WH2.term("parens_format",i,r):i,c=WH2.ce("label"),d=WH2.ce("input",{type:"checkbox",dataset:{spellId:t}});WH2.ae(c,d),WH2.aE(d,"click",WH2.tooltipSpellsChange.bind(this));let p=WH2.ce("a",void 0,WH2.ct(l));a?p.classList.add("covenant-"+WH2.Wow.Covenant.getSlug(a)):(p.href=WH2.Entity.getUrl(WH2.Types.SPELL,t,i),WH2.aE(p,"click",(function(e){e.preventDefault(),d.click()}))),WH2.ae(c,p),c.setAttribute("unselectable",""),WH2.ae(o,c),WH2.ae(o,WH2.ce("br"))}}WH2.onLoad((()=>{let e=e=>{let t=WH2.qs(`.tooltip-options #ks${g} input[type="checkbox"][data-spell-id="${e}"]`);t&&(t.checked=!0)},t=WH2.Url.parseQueryString(location.search);if(t.covenant){let a=((WH2.getPageData("WH2.Wow.Covenant.data")||{})[t.covenant]||{}).spellId;a&&e(a)}t.spellModifier&&t.spellModifier.split(":").forEach((t=>{e(t)})),WH2.tooltipSpellsChange.call(this)})),this.modified=[o,h,s],o.style.display=WH2.DOM.isEmpty(o)?"none":"inline-block",o.dataset.initialized="true"}if(c){var M=e.match(/<!--rppm-->(\d+(?:\.\d+)?)<!--rppm-->/);if(M){var N=$("#rppm"+g);if(this._rppmModList.hasOwnProperty(4))if(this._rppmModBase=parseFloat(M[1]),N.is(":empty"))for(var D in this._rppmSpecModList=this._rppmModList[4],this._rppmSpecModList.splice(0,0,{spec:-1,modifiervalue:0,filename:""}),N.append(WH2.getMajorHeading(WH2.TERMS.realppmmodifiers,2,3)),this._rppmSpecModList){var O=Icon.create(this._rppmSpecModList[D].filename,0,null);O.style.display="inline-block",O.style.verticalAlign="middle";var P=$('<input name="rppmmod" type="radio" id="rppm-'+D+'" />');P.get(0).checked=-1==this._rppmSpecModList[D].spec,N.append(P).append(-1==this._rppmSpecModList[D].spec?"":O).append('<label for="rppm-'+D+'"> <a>'+(-1==this._rppmSpecModList[D].spec?WH2.TERMS.none:WH2.Wow.PlayerClass.Specialization.getName(this._rppmSpecModList[D].spec))+"</a></label>").append("<br />");var x=this;$("#rppm-"+D).change((function(){WH2.tooltipRPPMChange.call(this,x)}))}else{var k=this._rppmModBase,B=this._rppmSpecModList;e=e.replace(/<!--rppm-->(\[?)(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,(function(e,t,a,n){return"\x3c!--rppm--\x3e"+t+(k*(1+parseFloat(B[$('input[name="rppmmod"]:checked',N).attr("id").match(/\d+$/)[0]].modifiervalue))).toFixed(2)+n+"\x3c!--rppm--\x3e"}))}N.toggle(!N.is(":empty"));var F="";this._rppmModList.hasOwnProperty(1)?F+=" + "+WH2.Wow.Item.Stat.jsonToAbbr("hastertng"):this._rppmModList.hasOwnProperty(2)&&(F+=" + "+WH2.Wow.Item.Stat.jsonToAbbr("critstrkrtng")),6==g_pageInfo.type&&this._rppmModList.hasOwnProperty(6)&&(F+=" + Budget"),F.length>0&&(e=e.replace(/<!--rppm-->\[?(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,(function(e,t,a){return"\x3c!--rppm--\x3e["+t+F+"]"+a+"\x3c!--rppm--\x3e"})))}}if(l){m[g]&&m[g].hasOwnProperty("tooltip_"+Locale.getName()+"_pvp")&&($(l).append('<input type="checkbox" id="item-upgrade-pvp" />').append('<label for="item-upgrade-pvp"><a>'+WH2.TERMS.pvpmode+"</a></label>").append("<br />"),$("#item-upgrade-pvp").change(WH2.upgradeItemTooltip.bind(this,l,"pvp")));let e=WH2.Timewalking.getConfigs();if(e.length>0){let t=WH2.ce("span",void 0,WH2.ct(WH2.TERMS.timewalkingScaling));WH2.Tooltips.attach(t,WH2.TERMS.timewalkingScaling_tip,"q");let a=WH2.ce("label",void 0,[t,WH2.ct(WH2.TERMS.colon_punct)]),n=WH2.ce("a",void 0,WH2.ct(WH2.TERMS.none));WH2.ae(l,a),WH2.ae(l,n);let i=[];i.push(Menu.createItem({label:WH2.TERMS.none,url:()=>{delete l.dataset.selected,WH2.upgradeItemTooltip.bind(this,l,void 0,!0)(),WH2.st(n,WH2.TERMS.none)},options:{checkedFunc:()=>!l.dataset.selected}})),e.forEach((e=>{let t=`tooltip_${Locale.getName()}_${e.stringId}`;if(!m[g]||!m[g].hasOwnProperty(t))return;let a=WH2.Wow.Expansion.getName(e.id);i.push(Menu.createItem({label:a,crumb:e.stringId,url:()=>{l.dataset.selected!==e.stringId&&(delete l.dataset.selected,l.dataset.selected=e.stringId,WH2.upgradeItemTooltip.bind(this,l,e.stringId,!0)(),WH2.st(n,a))},options:{checkedFunc:()=>e.stringId===l.dataset.selected,className:`item-upgrade-${e.stringId}`}})),$(l).toggle(!$(l).is(":empty"))})),Menu.add(n,i)}}if(3==W){var U=$("#cs"+g);if(U&&WH2.Wow.Item.tooltipHasSpecStats(e)){if(!this._classSpecBtn){var G=WH2.ce("label");G.innerHTML=WH2.TERMS.showingtooltipfor_stc+" ",this._classSpecBtn=WH2.ce("a"),this._classSpecBtn.ttId=g,WH2.classSpecBtnBuildMenu.call(this,!!m[g].hasOwnProperty("validMenuSpecs")&&m[g].validMenuSpecs),Menu.add(this._classSpecBtn,this._classSpecBtn.menu),U.append(G).append(this._classSpecBtn).show()}S=WH2.LocalStorage.get(WH2.LocalStorage.KEY_WOW_DATABASE_SPEC_FILTER),"object"!=typeof S&&(S=null);var q=/(&|\?)class=(\d+)/.exec(location.href);q&&(S={classId:parseInt(q[2]),specId:0});var z,j,Y=/(&|\?)spec=(\d+)/.exec(location.href);Y&&(z=parseInt(Y[2]),(j=WH2.Wow.PlayerClass.getBySpec(z))&&(S={classId:j,specId:z})),S?e=WH2.classSpecBtnOnChange.call(this,S.classId,S.specId,e,!0):$(this._classSpecBtn).text(WH2.isRetailTree()?WH2.TERMS.chooseaspec_stc:WH2.TERMS.chooseAClass_stc)}}W===WH2.Types.ITEM&&m[g]&&WH2.Page.WowItem.initBonuses(this,u),function(){let e=WH2.ge("craftedStatsSelector"+g);if(!m[g]||!e||e.dataset.initialized)return;const t=this;let a,n=0,i=function(e){let t=y(),a=t.indexOf(e);if(a>=0?t.splice(a,1):(t.push(e),t=t.slice(-1*n)),WH2.Url.replacePageQuery((function(e){t.length?e["crafted-stats"]=t.join(":"):delete e["crafted-stats"]})),s(),m[g]["tooltip_"+Locale.getName()]){let e=this._bonusesBtn&&this._bonusesBtn.selectedBonus?this._bonusesBtn.selectedBonus:null,t=WH2.enhanceTooltip.call(this,g,!0,!0,!1,null,this._spellModifiers,WH2.ge("ks"+g),r,null,!0,null,null,e);WH2.updateTooltip.call(this,t)}},s=function(){let e="",t=y();t.length?t.forEach((function(t){e+=(e?" + ":"")+WH2.Wow.Item.Stat.jsonToDesc(WH2.statToJson[t])})):e=WH2.TERMS.none,WH2.st(a,e)};e.dataset.initialized=1;let o=m[g].jsonequip&&m[g].jsonequip.statsInfo||{};if(WH2.Wow.Item.Stat.CRAFTING_STAT_FROM.forEach((function(e){o.hasOwnProperty(e)&&n++})),!n)return;WH2.displayDefault(e),WH2.ae(e,WH2.ce("label",{},WH2.ct(WH2.TERMS.optionalReagentStats+WH2.TERMS.colon_punct))),a=WH2.ce("a",{},WH2.ct(WH2.TERMS.none)),WH2.ae(e,a);let l=[];WH2.Wow.Item.Stat.CRAFTING_STAT_TO.forEach((function(e){l.push(Menu.createItem({crumb:e,label:WH2.Wow.Item.Stat.jsonToDesc(WH2.statToJson[e]),url:i.bind(t,e),options:{checkedFunc:function(e){return y().includes(parseInt(e[Menu.ITEM_CRUMB]))}}}))})),l.sort((function(e,t){return e[Menu.ITEM_LABEL].localeCompare(t[Menu.ITEM_LABEL])})),Menu.add(a,l),s()}.call(this);let K=this.slider?this.slider._max:WH2.Wow.getMaxPlayerLevel(),V=this._selectedLevel||K,Q=S?S.classId:WH2.Wow.PlayerClass.WARRIOR;return e=WH2.addRatingPercent(e,V,K,Q),W===WH2.Types.ITEM&&WH2.updateItemStringLink.call(this),e=WH2.updateTooltipSingular(e),I.spec&&(e=WH2.Tooltips.parseItemEffectTooltipForSpec(e,parseInt(I.spec))),e},WH2.addRatingPercent=function(e,t,a,n){let i=WH2.ce("div",{innerHTML:e});return WH2.qsa("span",i).forEach((function(e){let i,s;if(e.childNodes.forEach((function(e){if(e.nodeType===Node.COMMENT_NODE){let t=(e.nodeValue||"").match(/^rtg(\d+)$/);t&&(i=parseInt(t[1]),s=e)}})),void 0===i)return;let o=s.nextSibling.nodeValue.match(/(\d+)(.*)$/);if(!o)return;let r=WH2.qs("small.rating-percent");r&&WH2.de(r);let l=parseInt(o[0]),c=o[2],d=WH2.convertRatingToPercent(t,i,l,n),p=WH2.TERMS?WH2.term("valueAtLevel_format",d.toFixed(2),t):" ("+d.toFixed(2)+"% @ L"+t+")",u=s.nextSibling,h=WH2.ce("small",{className:"rating-percent"},WH2.ct(p));"."===c?(u.parentNode.insertBefore(WH2.ct(l),u),u.parentNode.insertBefore(h,u),u.parentNode.insertBefore(WH2.ct("."),u)):(u.parentNode.insertBefore(WH2.ce("span",null,WH2.ct(l+c)),u),u.parentNode.insertBefore(h,u)),u.parentNode.removeChild(u),h.setAttribute("onclick","WH2.tooltipLevelPrompt("+t+", "+a+");")})),i.innerHTML},WH2.tooltipLevelPrompt=function(e,t){let a=prompt(WH2.sprintf(WH2.TERMS.ratinglevel_format,1,t),e.toString());if(null===a)return;if(a=parseInt(a),a<1||a>t)return void alert("Invalid value; must be between 1 and "+t+".");let n=WH2.qs(".wowhead-tooltip");n.slider&&Slider.setValue(n.slider,a),WH2.staticTooltipLevelClick(n,a,1)},WH2.groupSizeScalingShouldShow=function(e){return!!(WH2.isSet("g_difficulties")&&WH2.isSet("g_spells")&&g_spells[e]&&g_spells[e].difficulties&&g_spells[e].difficulties.length>0)&&g_spells[e].difficulties[0]},WH2.groupSizeScalingSliderMove=function(e,t,a){var n=WH2.getDataSource(),i=WH2.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(!n[i])return;let s=this._difficultyBtn.selectedDD,o=a.value;WH2.Url.replacePageQuery((function(e){s!=WH2.groupSizeScalingShouldShow(i)||o!=g_difficulties[WH2.groupSizeScalingShouldShow(i)].maxplayers?(e.dd=s,e.ddsize=o):(delete e.dd,delete e.ddsize)})),WH2.groupSizeScalingOnChange.call(this,this,a.value,0),this.bufftip&&WH2.groupSizeScalingOnChange.call(this,this.bufftip,a.value,1),WH2.Tooltips.hide()},WH2.groupSizeScalingOnChange=function(e,t,a,n){const i=this;for(;-1==e.className.indexOf("tooltip");)e=e.parentNode;if(t=parseInt(t),!isNaN(t)){var s=WH2.getDataSource(),o=WH2.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(s[o]){var r=this._difficultyBtn.selectedDD,l=Locale.getName(),c="server_"+(a?"buff_":"tooltip_")+l,d="dd"+r+"ddsize"+t;if(WH2.groupSizeScalingOnChange.lastCall=d,!s[o][c]){s[o]["server_tooltip_"+l]={},s[o]["server_buff_"+l]={};var p="dd"+s[o].initial_dd+"ddsize"+s[o].initial_ddSize;s[o]["server_tooltip_"+l][p]=s[o]["tooltip_"+l],s[o]["server_buff_"+l][p]=s[o]["buff_"+l]}if(s[o][c][d]){var u=s[o][c][d];return n?u:void WH2.updateTooltip.call(e,u)}if(n)return s[o][c.substr(7)];if(!a&&!s[o][c].hasOwnProperty(d)){s[o][c][d]="";var h=WH2.Entity.getUrl(WH2.Types.SPELL,o)+"?dd="+r+"&ddsize="+t;(WH2.isBeta()||WH2.isPtr()||WH2.isPtr2())&&(h+="&"+WH2.getDataCacheVersion()),WH2.xhrJsonRequest(h,(function(a){a&&(s[o]["server_tooltip_"+l][d]=a.tooltip,s[o]["server_buff_"+l][d]=a.buff,WH2.groupSizeScalingOnChange.lastCall===d&&(WH2.groupSizeScalingOnChange.call(i,e,t),i.bufftip&&WH2.groupSizeScalingOnChange.call(i,i.bufftip,t,!0)))}))}}}},WH2.difficultyBtnBuildMenu=function(e){for(var t=[],a=g_spells[e],n=0;n<a.difficulties.length;++n){var i=a.difficulties[n],s=[i,WH2.Wow.Difficulty.getName(i),WH2.difficultyBtnOnChange.bind(this,i,!1)];t.push(s)}this._difficultyBtn.menu=t},WH2.difficultyBtnOnChange=function(e,t){this._difficultyBtn.selectedDD=e,$(this._difficultyBtn).text(""),WH2.arrayWalk(this._difficultyBtn.menu,(function(e){e.checked=!1}));var a=Menu.findItem(this._difficultyBtn.menu,[e]);a.checked=!0,$(this._difficultyBtn).text(a[Menu.ITEM_LABEL]);var n=this._difficultyBtn.selectedPlayers||t,i=g_difficulties[e].minplayers,s=g_difficulties[e].maxplayers,o=g_difficulties[e].maxplayers;n&&(o=n>s?s:n<i?i:n),i=s;var r=$("#sl"+this._difficultyBtn.ttId);r.html("").hide(),this.slider=null,i!=s&&(r.show(),this.slider=Slider.init(r.get(0),{maxValue:parseInt(s),minValue:parseInt(i),onMove:WH2.groupSizeScalingSliderMove.bind(this),title:WH2.TERMS.players}),Slider.setValue(this.slider,parseInt(o)),this.slider.onmouseover=function(e){WH2.Tooltips.showAtCursor(e,WH2.TERMS.dragtochangeplayers_stc,"q2")},this.slider.onmousemove=WH2.Tooltips.cursorUpdate,this.slider.onmouseout=WH2.Tooltips.hide,WH2.Tooltips.attach(Slider.getInput(this.slider),WH2.TERMS.clicktochangeplayers_stc,"q2")),WH2.groupSizeScalingSliderMove.call(this,null,null,{value:o})},WH2.classSpecBtnOnChange=function(e,t,a,n){const i=WH2.LocalStorage;e=parseInt(e),t=t?parseInt(t):null,WH2.ee(this._classSpecBtn),this._classSpecBtn.selectedSpec=t;let s=Menu.findItem(this._classSpecBtn.menu,[e,t]);if(s&&s[Menu.ITEM_OPTIONS]&&s[Menu.ITEM_OPTIONS].tinyIcon){let e=s[Menu.ITEM_OPTIONS].tinyIcon,t=WH2.Icon.create(e,WH2.Icon.SMALL,"javascript:");t.style.display="inline-block",t.style.verticalAlign="middle",WH2.ae(this._classSpecBtn,t)}let o=WH2.Wow.PlayerClass.Specialization.getName(t);WH2.ae(this._classSpecBtn,WH2.ce("span",void 0,WH2.ct(" "+(WH2.isRetailTree()&&o?WH2.Strings.sprintf(WH2.TERMS.specclass_format,o,WH2.Wow.PlayerClass.getName(e)):WH2.Wow.PlayerClass.getName(e))))),n||i.set(i.KEY_WOW_DATABASE_SPEC_FILTER,{classId:e,specId:t});var r=a||this.innerHTML;return r=r.replace(/<!--scstart(\d+):(\d+)--><span class="q(\d+)">(<!--asc\d+-->)?(.*?)<\/span><!--scend-->/i,(function(t,a,n,i,s,o){i=1;var r=2==a&&(!g_classes_allowed_weapon[e]||-1==WH2.inArray(g_classes_allowed_weapon[e],n)),l=4==a&&(!g_classes_allowed_armor[e]||-1==WH2.inArray(g_classes_allowed_armor[e],n));return(r||l)&&(i=10),"\x3c!--scstart"+a+":"+n+'--\x3e<span class="q'+i+'">'+(s||"")+o+"</span>\x3c!--scend--\x3e"})),WH2.isRetailTree()&&(r=r.replace(/<span[^>]*?><!--stat(\d+)-->([-+][\d\.,]+(?:-[\d\.,]+)?)(\D*?)<\/span>/gi,(function(a,n,i,s){let o=WH2.ce("div",{innerHTML:a}),r=WH2.qs("span",o);r.classList.remove("q0","q2"),50===(n=parseInt(n))&&r.classList.add("q2"),g_grayedOutStats[n]&&-1!=g_grayedOutStats[n].indexOf(t)&&(r.classList.remove("q2"),r.classList.add("q0"));let l=t?WH2.getStatForSpec(n,t):WH2.getStatForClass(n,e);if(l!==n&&WH2.statToJson[l]){let e=WH2.Wow.Item.Stat.jsonToName(WH2.statToJson[l]);e&&(s=" "+e)}return r.innerHTML="\x3c!--stat"+n+"--\x3e",WH2.ae(r,WH2.ct(i+s)),r.outerHTML})),r=r.replace(/(<!--traitspecstart:(\d+)(?::(\d+))?-->)[\w\W]*?(<!--traitspecend-->)/g,(function(e,a,n,i,s){var o="";return WH2.isSet("g_pageInfo")&&g_pageInfo.hasOwnProperty("typeId")&&3==g_pageInfo.type&&g_items.hasOwnProperty(g_pageInfo.typeId)&&g_items[g_pageInfo.typeId].hasOwnProperty("affectsArtifactPowerTypesData")&&g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData.hasOwnProperty(n)&&g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData[n].hasOwnProperty(t)?o=g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData[n][t]:i&&(o='<span style="color: #00FF00">'+WH2.term("relicrank"+(1!=i?"s":"")+"increase_format",i)+": </span>"+WH2.TERMS.relic_minortrait),a+o+s}))),t&&(r=WH2.Tooltips.parseItemEffectTooltipForSpec(r,t)),WH2.Url.replacePageQuery((function(a){e?a.class=e:delete a.class,WH2.isRetailTree()&&t?a.spec=t:delete a.spec})),a||(this.innerHTML=WH2.Tooltips.evalFormulas(r)),r},WH2.classSpecBtnBuildMenu=function(e){const t=WH2.Wow.PlayerClass,a=WH2.Wow.PlayerClass.Specialization,n=WH2.isRetailTree();let i=[Menu.createHeading({label:n?WH2.TERMS.chooseaspec_stc:WH2.TERMS.chooseAClass_stc})];e&&(e=e.map((e=>parseInt(`${e}`)))),t.getAll().forEach((s=>{const o=Menu.createItem({crumb:`${s}`,label:t.getName(s),options:{className:"c{$classId}",tinyIcon:t.getIconName(s)}});if(n){const t=[];a.getByClass(s).forEach((n=>{const i=!e||e.includes(n),o=Menu.createItem({crumb:`${n}`,label:a.getName(n),url:i?WH2.classSpecBtnOnChange.bind(this,s,n,!1):"javascript:",options:i?{tinyIcon:a.getIconName(n)}:{className:"q0"}});t.push(o)})),Menu.setSubmenu(o,t)}else Menu.setItemUrl(o,WH2.classSpecBtnOnChange.bind(this,s,0,!1));i.push(o)})),this._classSpecBtn.menu=i},WH2.getStatForClass=function(e,t){let a,n=WH2.Wow.PlayerClass.Specialization.getByClass(t)||[];for(let t,i=0;t=n[i];i++){let n=WH2.getStatForSpec(e,t);if(void 0===a)a=n;else if(a!==n){a=null;break}}return a},WH2.getStatForSpec=function(e,t){var a,n,i=g_specPrimaryStatOrders[t],s=g_specPrimaryStatOrders[t].length;if(71===e){if(n=0,!s)return 5;for(;!((a=i[n])>=3&&a<=5);)if(++n>=s)return 5}else{if(72!==e){if(73!==e){if(74!==e)return e;if(n=0,s){for(;!((a=i[n])>=4&&a<=5);)if(++n>=s)return 5;return a}return 5}if(n=0,s){for(;a=i[n],3!==i[n]&&5!==i[n];)if(++n>=s)return 5;return a}return 5}if(n=0,!s)return 3;for(;!((a=i[n])>=3&&a<=4);)if(++n>=s)return 3}return a},WH2.getItemBonusChanceType=function(e){var t=0;if(e>0&&WH2.isSet("g_itembonuses")&&g_itembonuses&&g_itembonuses[e])for(var a=g_itembonuses[e],n=0;n<a.length;++n){var i=0;switch(a[n][0]){case 1:case 3:case 4:case 5:case 11:i=1;break;case 2:i=2;break;case 6:i=4}i&&(!t||i<t)&&(t=i)}return t},WH2.getItemBonusUpgradeType=function(e){if(e>0&&WH2.isSet("g_itembonuses")&&g_itembonuses&&g_itembonuses[e])for(var t=g_itembonuses[e],a=0;a<t.length;++a){var n=t[a];switch(n[0]){case 3:case 4:case 5:case 11:return 1<<n[0]}}return 0},WH2.bonusesBtnGetContextBonusId=function(e){let t=0,a=WH2.getPageData("wow.item.bonuses.listGroup");if(e&&e.length)for(let n=0;n<e.length;++n){let i=parseInt(e[n]);if(window.g_itembonuses&&g_itembonuses[-1]&&g_itembonuses[-1].includes(i)||null!==a&&a.includes(i)){t=e[n];break}}return t},WH2.bonusesGetItem=function(){return WH2.getDataSource()[this._bonusesBtn.ttId]},WH2.updateItemStringLink=function(){var e=WH2.getDataSource(),t=WH2.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(e[t]){var a="",n=[];this._bonusesBtn&&this._bonusesBtn.selectedBonus&&(n=(a=this._bonusesBtn.selectedBonus.replace(/u:/,"")).split(":"));var i=this._selectedLevel?this._selectedLevel:WH2.Wow.getMaxPlayerLevel(),s=this._knowledgeLevel?this._knowledgeLevel:0,o=this._classSpecBtn&&this._classSpecBtn.selectedSpec?this._classSpecBtn.selectedSpec:"",r=0,l="";if(n.length&&g_itembonuses)e:for(var c,d=0;c=n[d];d++)if(g_itembonuses[c])for(var p,u=0;p=g_itembonuses[c][u];u++)if(11==p[0]||13==p[0]){r|=512,l=(l?":":"")+i;break e}s&&(r|=8388608,l=(l?":":"")+(s+1));var h=(r||"")+"::"+(n.length?n.length+":":"")+a+":"+l,g=WH2.ge("open-links-button");if(g){var f={type:3,typeId:t,linkColor:"ff"+WH2.Wow.Item.getQualityColor(e[t].quality,!0).replace(/^#/,""),linkId:"item:"+t+"::::::::"+i+":"+o+":"+h,linkName:e[t]["name_"+Locale.getName()],bonuses:n,slot:e[t].slot};i!=WH2.Wow.getMaxPlayerLevel()&&(f.lvl=i),o&&(f.spec=o),(sliderControl=WH2.ge("sl"+t))&&(f.dropLevel=$(sliderControl).find("input").val()),g.onclick=WH2.Links.show.bind(WH2.Links,g,f)}}},WH2.upgradeItemTooltip=function(e,t,a){let n=WH2.getDataSource(),i=g_pageInfo.typeId;if(n[i]){if(a)return void s(this);let o=$("#"+e.id+" > input"),r=null;"number"!=typeof t?o.each((function(e,a){if(-1!=a.id.indexOf(t))return r=a,!1})):r=o.get(t-1);let l=r.checked;function s(e){if(this._selectedUpgrade=t,WH2.updateItemStringLink.call(e),n[i]["tooltip_"+Locale.getName()]){let a=e._bonusesBtn&&e._bonusesBtn.selectedBonus?e._bonusesBtn.selectedBonus:null,n=WH2.enhanceTooltip.call(e,i,!0,!0,!1,null,e._spellModifiers,WH2.ge("ks"+i),t,null,!0,null,null,a);WH2.updateTooltip.call(e,n)}}o.each((function(e,t){t.checked=!1})),r.checked=l,l||(t=null),s(this)}},WH2.updateTooltip=function(e){e=WH2.updateTooltipSingular(e),this.classList.contains("partial-sub-tooltip")?this.innerHTML=WH2.Tooltips.evalFormulas(e):(this.innerHTML="<table><tr><td>"+WH2.Tooltips.evalFormulas(e)+'</td><th style="background-position: top right"></th></tr><tr><th style="background-position: bottom left"></th><th style="background-position: bottom right"></th></tr></table>',WH2.Tooltips.finalizeSizeAndReveal(this))},WH2.staticTooltipLevelClick=function(e,t,a,n){for(;-1==e.className.indexOf("tooltip");)e=e.parentNode;var i=e.innerHTML,s=i.match(/<!--i\?(\d+):(\d+):(\d+):(\d+)/);if(s||(s=i.match(/<!--\?(\d+):(\d+):(\d+):(\d+)/)),s||WH2.isRetailTree()||(s=i.match(/<!--ppl(\d+):(\d+):(\d+):(\d+):(\d+)/))&&(s=[null,s[1],s[2],WH2.Wow.getMaxPlayerLevel(),0]),s||(s=i.match(/<!--pl(\d+):(\d+):(\d+)-->\s?(\d+)/))&&(WH2.isSet("g_pageInfo")&&g_pageInfo.type==WH2.Types.ITEM&&(s[1]=g_pageInfo.typeId),s=[null,s[1],s[2],s[3],s[4]]),s){var o=parseInt(s[1]),r=parseInt(s[2]),l=parseInt(s[3]),c=parseInt(s[4]);if(!(r>=l||(isNaN(t)&&(t=prompt(WH2.sprintf(WH2.TERMS.ratinglevel_format,r,l),c)),t=parseInt(t),isNaN(t)||t==c||t<r||t>l))){e._selectedLevel=t;var d=WH2.getDataSource();s=WH2.setTooltipLevel.bind(e,d[o][(n?"buff_":"tooltip_")+Locale.getName()],t,n)();var p=e._bonusesBtn&&e._bonusesBtn.selectedBonus?e._bonusesBtn.selectedBonus:null,u=e._selectedUpgrade?e._selectedUpgrade:0;s=WH2.enhanceTooltip.call(e,s,!0,null,null,null,null,null,u,null,null,null,null,p),WH2.updateTooltip.call(e,s),e.slider&&!a&&Slider.setValue(e.slider,t),n||WH2.tooltipSpellsChange.bind(e)()}}},WH2.staticTooltipKnowledgeLevelClick=function(e,t,a){for(;-1==e.className.indexOf("tooltip");)e=e.parentNode;var n=e.innerHTML;if(isNaN(t)&&(WH2.Tooltips.hide(),t=prompt(WH2.sprintf(WH2.TERMS.ratinglevel_format,0,g_artifact_knowledge_max_level),e._knowledgeLevel?e._knowledgeLevel:0)),t=parseInt(t),!isNaN(t)&&!(t<0||t>g_artifact_knowledge_max_level)){e._knowledgeLevel=t,WH2.Url.replacePageQuery((function(e){t?e.artk=t:delete e.artk}));var i=WH2.getDataSource();n=WH2.setTooltipLevel.bind(e,i[a]["tooltip_"+Locale.getName()],e._selectedLevel,null)();var s=e._bonusesBtn&&e._bonusesBtn.selectedBonus?e._bonusesBtn.selectedBonus:null,o=e._selectedUpgrade?e._selectedUpgrade:0;n=WH2.enhanceTooltip.call(e,n,!0,null,null,null,null,null,o,null,null,null,null,s),WH2.updateTooltip.call(e,n)}},WH2.tooltipSliderMove=function(e,t,a){WH2.staticTooltipLevelClick(this,a.value,1),this.bufftip&&WH2.staticTooltipLevelClick(this.bufftip,a.value,1,1),WH2.Tooltips.hide()},WH2.tooltipSpellsChange=function(){if(this.modified){var e=this.modified[0],t=this.modified[1],a=[];$.each($("input:checked",e),(function(e,t){a.push(parseInt(t.dataset.spellId))})),this.modified[2]=a,WH2.qsa(".lazy-load-background",this).forEach((e=>e.classList.remove("lazy-load-background"))),this.innerHTML=WH2.setTooltipSpells(this.innerHTML,a,t),this.bufftip&&WH2.tooltipSpellsChange.bind(this.bufftip)(),WH2.Url.replacePageQuery((function(e){let t=WH2.getPageData("WH2.Wow.Covenant.data");delete e.spellModifier,delete e.covenant;let n=[];a.forEach((a=>{let i=Object.keys(t).find((e=>t[e].spellId===a));i?e.covenant=i:n.push(a)})),n.length&&(e.spellModifier=n.join(":"))}))}},WH2.tooltipRPPMChange=function(e){var t=$(this).attr("id").match(/\d+$/)[0];WH2.qsa(".lazy-load-background",e).forEach((e=>e.classList.remove("lazy-load-background"))),e.innerHTML=WH2.Tooltips.evalFormulas(e.innerHTML.replace(/<!--rppm-->(\[?)(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,(function(a,n,i,s){return"\x3c!--rppm--\x3e"+n+(e._rppmModBase*(1+parseFloat(e._rppmSpecModList[t].modifiervalue))).toFixed(2)+s+"\x3c!--rppm--\x3e"})))},WH2.validateBpet=function(e,t){var a=1,n=25,i=0,s=4,o=1023,r=3,l=$.extend({},t);return e.minlevel&&(a=e.minlevel),e.maxlevel&&(n=e.maxlevel),e.companion&&(n=a),l.level||(l.level=25),l.level=Math.min(Math.max(l.level,a),n),e.minquality&&(i=e.minquality,e.untameable&&(s=i)),e.maxquality&&(s=e.maxquality),null==l.quality&&(l.quality=3),l.quality=Math.min(Math.max(l.quality,i),s),e.companion&&delete l.quality,e.breeds>0&&(o=e.breeds&o),o&1<<r-3||(r=Math.floor(3+Math.log(o)/Math.LN2)),l.breed&&l.breed>=13&&(l.breed-=10),l.breed&&o&1<<l.breed-3||(l.breed=r),l},WH2.calcBattlePetStats=function(e,t,a,n,i){WH2.battlePetBreedStats[t]||(t=3);var s=e.health;isNaN(s)&&(s=0);var o=e.power;isNaN(o)&&(o=0);var r=e.speed;isNaN(r)&&(r=0),isNaN(a)&&(a=1),a=Math.min(Math.max(0,a),5),isNaN(n)&&(n=1),n=Math.min(Math.max(1,n),25);var l=WH2.battlePetBreedStats[t],c=1+a/10;return s=5*(s+l[0])*n*c+100,o=(o+l[1])*n*c,r=(r+l[2])*n*c,i&&(s=5*s/6,o=4*o/5),{health:Math.round(s),power:Math.round(o),speed:Math.round(r)}},WH2.battlePetBreedStats={3:[.5,.5,.5],4:[0,2,0],5:[0,0,2],6:[2,0,0],7:[.9,.9,0],8:[0,.9,.9],9:[.9,0,.9],10:[.4,.9,.4],11:[.4,.4,.9],12:[.9,.4,.4]},WH2.battlePetAbilityLevels=[1,2,4,10,15,20],WH2.createButton=function(e,t,a){var n="btn btn-site",i="",s="",o="",r=[],l=[];if(a||(a={}),a["no-margin"]||l.push("margin-left:5px"),"string"==typeof t&&""!==t||(t="javascript:"),a["new-window"]&&(i=' target="_blank"'),"string"==typeof a.id&&(s=' id="'+a.id+'"'),void 0!==a.size)switch(a.size){case"small":case"large":r.push("btn-"+a.size)}else r.push("btn-small");if("string"==typeof a.class&&r.push(a.class),"string"==typeof a.type)switch(a.type){case"default":case"gray":n="btn";break;default:n="btn btn-"+a.type}a.disabled&&(r.push("btn-disabled"),t="javascript:"),r.length&&(n+=" "+r.join(" ")),n&&(n=' class="'+n+'"'),(void 0===a.float||a.float)&&l.push("float:right"),"string"==typeof a.style&&l.push(a.style),l.length&&(o=' style="'+l.join(";")+'"');var c='<a href="'+t+'"'+i+s+n+o+">"+(e||"")+"</a>",d=WH2.ce("div");d.innerHTML=c;var p=d.childNodes[0];return"function"!=typeof a.click||a.disabled||(p.onclick=a.click),void 0!==a.tooltip&&(!1!==a.tooltip&&p.setAttribute("data-whattach","true"),!1===a.tooltip?p.rel="np":"string"==typeof a.tooltip?WH2.Tooltips.attach(p,a.tooltip):"object"==typeof a.tooltip&&a.tooltip.text&&WH2.Tooltips.attach(p,a.tooltip.text,a.tooltip.class)),p},WH2.D4=new function(){this.getImageUrlFromHash=(e,t)=>{"string"==typeof e&&(e=parseInt(e)),t??=WH2.getDataEnv(),WH2.Game.getByEnv(t)!==WH2.Game.D4&&(t=WH2.Game.getEnv(WH2.Game.D4));const a=WH2.isDataEnvRestricted(t);let n=`/d4/${WH2.getDataEnvKey(t)}/texture/`,i=WH2.WebP.getImageExtension(),s=e?`${n}hash/${255&e}/${e}${i}`:`${n}hash/74/582516298${i}`;return a?WH2.Url.generatePrivate(s):`${WH2.STATIC_URL}${s}`},this.getStringHash=(e,t=!0)=>{let a=Array.from(t?e.toLowerCase():e).map((e=>e.charCodeAt(0))).reduce(((e,t)=>(e<<5)+e+t&4294967295),0);return a<0?a+4294967296:a}},WH2.Device=new function(){const e={isMobile:void 0,isTablet:void 0,isTouch:void 0};this.isMobile=function(){return e.isMobile},this.isTablet=function(){return e.isTablet},this.isTouch=function(){return e.isTouch},function(){let t=navigator.userAgent||navigator.vendor||window.opera;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e.isMobile=!0),e.isMobile||/(android|ipad|playbook|silk)/i.test(t)&&(e.isTablet=!0),e.isTouch=e.isMobile||e.isTablet}()},WH2.DI=new function(){},WH2.Game=new function(){const e=this;this.WOW=1,this.D2=2,this.DI=3,this.D4=4,this.DEFAULT=this.WOW;const t=[WH2.dataTree.RETAIL,WH2.dataTree.CLASSIC,WH2.dataTree.CATA,WH2.dataTree.D4],a={[this.D2]:{dataTrees:[WH2.dataTree.D2],defaultTree:WH2.dataTree.D2,term:"diablo2Resurrected",termAbbrev:"diablo2_abbrev",termSeo:"diablo2Resurrected"},[this.DI]:{dataTrees:[WH2.dataTree.DI],defaultTree:WH2.dataTree.DI,term:"diabloImmortal",termAbbrev:"diabloImmortal_abbrev",termSeo:"diabloImmortal"},[this.D4]:{dataTrees:[WH2.dataTree.D4],defaultTree:WH2.dataTree.D4,term:"diablo4",termAbbrev:"diablo4_abbrev",termSeo:"diablo4_seo"},[this.WOW]:{dataTrees:[WH2.dataTree.RETAIL,WH2.dataTree.CLASSIC,WH2.dataTree.TBC,WH2.dataTree.WRATH,WH2.dataTree.CATA],defaultTree:WH2.dataTree.RETAIL,term:"worldofwarcraft",termAbbrev:"worldOfWarcraft_abbrev",termSeo:"worldofwarcraft"}},n={[this.D2]:"d2",[this.DI]:"di",[this.WOW]:"wow",[this.D4]:"d4"},i={[this.D2]:WH2.dataEnv.D2,[this.DI]:WH2.dataEnv.DI,[this.WOW]:WH2.dataEnv.MAIN,[this.D4]:WH2.dataEnv.D4};let s={[WH2.dataEnv.BETA]:"beta",[WH2.dataEnv.D2]:"diablo-2",[WH2.dataEnv.DI]:"diablo-immortal",[WH2.dataEnv.WRATH]:"wotlk",[WH2.dataEnv.CLASSIC]:"classic",[WH2.dataEnv.PTR]:"ptr",[WH2.dataEnv.PTR2]:"ptr-2",[WH2.dataEnv.TBC]:"tbc",[WH2.dataEnv.D4]:"diablo-4",[WH2.dataEnv.CATA]:"cata",[WH2.dataEnv.D4PTR]:"diablo-4-ptr",[WH2.dataEnv.D4BETA]:"diablo-4-beta"};const o={[WH2.dataTree.RETAIL]:this.WOW,[WH2.dataTree.CLASSIC]:this.WOW,[WH2.dataTree.TBC]:this.WOW,[WH2.dataTree.D2]:this.D2,[WH2.dataTree.DI]:this.DI,[WH2.dataTree.WRATH]:this.WOW,[WH2.dataTree.D4]:this.D4,[WH2.dataTree.CATA]:this.WOW},r=[this.D2,this.DI],l={[this.WOW]:"wow_token01",[this.D2]:"inv_diablostone",[this.DI]:"inv_cape_special_treasuregoblin_d_01",[this.D4]:"diabloanniversary_achievement"};this.get=()=>e.getByTree(WH2.getDataTree()),this.getAll=()=>Object.keys(n).map(Number),this.getAllSelectors=()=>Object.values(s),this.getAllSorted=()=>{let t=e.getAll();return t.sort(((t,a)=>t===e.WOW?-1:a===e.WOW?1:a-t)),t},this.getByKey=e=>{for(let t of Object.keys(n))if(n[t]===e)return parseInt(t)},this.getByEnv=t=>e.getByTree(WH2.getDataTree(t)),this.getByTree=e=>o[e],this.getDataEnvBySelector=e=>WH2.findKey(s,e,!0),this.getDataEnvs=e=>{let t=[],n=a[e].dataTrees;return Object.entries(WH2.dataEnvToTree).forEach((([e,a])=>{n.includes(a)&&t.push(parseInt(e))})),t},this.getDataTrees=e=>{let t=a[e]?.dataTrees||[];if(!WH2.REMOTE){const e=WH2.PageMeta.availableDataEnvs.map((e=>WH2.getDataTree(e)));t=t.filter((t=>e.includes(t)))}return t.length?t:void 0},this.getDefaultEnv=e=>i[e],this.getEnv=t=>(t=t||e.DEFAULT)===WH2.Game.get()?WH2.getDataEnv():WH2.Game.getDefaultEnv(t),this.getFeaturedTrees=()=>t,this.getName=e=>a[e]?WH2.TERMS[a[e].term]:void 0,this.getAbbrev=e=>a[e]?WH2.TERMS[a[e].termAbbrev]:void 0,this.getKey=e=>n[e],this.getRoot=t=>WH2.getRootEnv(e.getEnv(t)),this.getSelectorByDataEnv=e=>s[e],this.getSeoName=e=>a[e]?WH2.TERMS[a[e].termSeo]:void 0,this.getWowIconName=e=>l[e],this.hasAccess=t=>(e.getDataTrees(t)||[]).length>0,this.isUnderstated=e=>r.includes(e),this.supportsRandomPages=t=>[e.WOW,e.DI].includes(t)},WH2.Fonts=new function(){const e=WH2.Game,t="https://use.typekit.net/kxf7wgk.css",a=`${WH2.STATIC_URL}/css/fonts/d4.css`,n="https://use.typekit.net/qwt0uqi.css",i={[e.D2]:[n],[e.D4]:[t,a],[e.DI]:[n]},s={requestedUrls:new Set};this.load=e=>{i[e]&&i[e].forEach((e=>function(e){if(!e||s.requestedUrls.has(e))return;s.requestedUrls.add(e),e===t&&s.requestedUrls.add(n);if(document.head.querySelector('link[rel="stylesheet"][href="'+e+'"]'))return;WH2.ae(document.head,WH2.ce("link",{href:e,rel:"stylesheet",type:"text/css"}))}(e)))}},WH2.Icon=new function(){const e=this,t=WH2.Game,n=WH2.Types;this.TINY="tiny",this.SMALL="small",this.MEDIUM="medium",this.LARGE="large",this.BLIZZARD="blizzard",this.LEGACY_IDS={0:this.SMALL,1:this.MEDIUM,2:this.LARGE,3:this.BLIZZARD},this.WOW_MEDIUM_SELECTED_CLASS="iconmedium-gold-selected",this.UNKNOWN="inv_misc_questionmark",this.UNKNOWN_ZONE="inv_misc_map08";const i=[this.TINY,this.SMALL,this.MEDIUM,this.LARGE,this.BLIZZARD];this.create=function(i,s,o,r){i&&(i=`${i}`);let l=(r=r||{}).dataEnv||r.type&&n.getPreferredDataEnv(r.type)||t.getEnv(r.game),c=t.getByEnv(l);if(s===e.TINY)return WH2.ce("img",{className:"icontiny",src:e.getIconUrl(i,s,l)});let d=WH2.ce(r.span?"span":"div",{className:"icon"+s,dataset:{env:WH2.getDataEnvKey(l),tree:WH2.getDataTreeKey(WH2.getDataTree(l)),game:t.getKey(c)}});WH2.ae(d,WH2.ce("ins")),!1!==r.border&&WH2.ae(d,WH2.ce("del"));let p=r.type&&n.getStringId(r.type);p&&(d.dataset.type=p),!0===r.simple?d.dataset.kind="simple":r.kind&&(d.dataset.kind=r.kind),r.color&&(d.dataset.color=r.color),WH2.cO(d.dataset,r.dataset),i&&(i.includes("/")?e.setImage(d,i,!0,r.isMask):e.setImage(d,e.getIconUrl(i,s,l),!1,r.isMask),WH2.isRemote()||!1===r.lazyLoad||WH2.DOM.lazyLoadBackground(d.firstChild));const u=r.ariaLabel||WH2.TERMS.icon;if(o){let e=WH2.ce("a",{ariaLabel:u,href:o});-1===o.indexOf("wowhead.com")&&/^https?:/.test(o)&&(e.target="_blank"),WH2.ae(d,e)}else if(i){-1!==d.firstChild.style.backgroundImage.indexOf("/avatars/")||null!==o&&(WH2.ae(d,WH2.ce("a",{ariaLabel:u,href:"javascript:"})),d.onclick=Icon.onClick)}return r.rel&&"undefined"!=typeof a&&(a.rel=r.rel),e.setText(d,r.number,r.quantity),d},this.createByEntity=function(t,a,i,s){let o=(s=s||{}).size;delete s.size,s.dataEnv=s.dataEnv||t.dataEnv||(n.getRequiredTrees(a)||[])[0],s.type=a,s.ariaLabel??=t.name;const r=WH2.DI.GeneralItem;switch(a){case n.DI_EQUIP_ITEM:s.dataset=s.dataset||{},s.dataset.gridType=s.gridType||t.gridType||([6,11,4,3,7,9,8].includes(t.inventoryPosition)?r.GRID_TYPE_1x1:r.GRID_TYPE_2x1),delete s.gridType,null!=t.inventoryColor&&(s.dataset.inventoryColor=t.inventoryColor);break;case n.DI_MISC_ITEM:s.dataset=s.dataset||{},s.dataset.gridType=s.gridType||t.gridType||r.GRID_TYPE_2x1,delete s.gridType,null!=t.inventoryColor&&(s.dataset.inventoryColor=t.inventoryColor);break;case n.DI_PARAGON_SKILL:s.dataset=s.dataset||{},s.dataset.specSkill=JSON.stringify(!(!s.isSpecSkill&&!t.isSpecSkill));break;case n.D4_PARAGON_NODE:s.dataset=s.dataset||{},s.isMask=!!t.iconImageHash,s.dataset.nodeType=`${t.type}`,s.dataset.isGate=`${!!t.isGate}`,s.dataset.hasSocket=`${!!t.hasSocket}`;case n.D4_ITEM:case n.D4_PARAGON_GLYPH:case n.D4_SENESCHAL_STONE:null!=t.quality&&(s.dataset=s.dataset||{},s.dataset.quality=t.quality);break;case n.D4_SKILL:!1===(s.active??t.active)&&delete(s={...s,dataset:{skillType:"passive"}}).active}return e.create(t.icon||t.iconImageHash,o||e.MEDIUM,i,s)},this.getIconUrl=function(a,n,s=t.getEnv(t.DEFAULT)){-1===i.indexOf(n)&&(n=e.MEDIUM);let o=t.getByEnv(s),r=WH2.isDataEnvRestricted(s);switch(o){case t.DI:return new WH2.DI.UiImage(a).getUrl(r);case t.D4:return WH2.D4.getImageUrlFromHash(a,s);case t.WOW:default:let i=t.getKey(o);i||(WH2.warn('Invalid game provided for "'+a+'" icon: '+o),i=t.getKey(t.WOW),a=e.UNKNOWN);let l=n===e.TINY?".gif":".jpg",c=`/images/${i}/icons/${n}/${a.toLowerCase()}${l}`;return r?WH2.Url.generatePrivate(c):`${WH2.STATIC_URL}${c}`}},this.getLink=function(e){return e.querySelector("a")},this.isValidSize=function(e){return-1!==i.indexOf(e)},this.setImage=function(e,t,a,n){let i=e.firstChild;i.style.backgroundPosition="",n?i.style["-webkit-mask-image"]=t?'url("'+t+'")':"":i.style.backgroundImage=t?'url("'+t+'")':"",!0===a&&(i.style.backgroundSize="contain")},this.setLinkUrl=function(t,a){let n=e.getLink(t);n&&(n.href=a)},this.setName=function(t,a,n,i){n?(a===e.BLIZZARD&&(a=e.LARGE),e.setImage(t,e.getIconUrl(n,a,i))):e.setImage(t,null)},this.setText=function(e,t,a){WH2.qsa(".WH2-icon-text",e).forEach((e=>WH2.de(e))),null!=t&&(t>1&&t<2147483647||t.length&&"0"!==t&&"1"!==t)&&WH2.ae(e,WH2.ce("span",{className:"wh-icon-text",dataset:{type:"number"}},WH2.ct(t))),null!=a&&a>0&&WH2.ae(e,WH2.ce("span",{className:"wh-icon-text",dataset:{type:"quantity"}},WH2.ct("("+a+")")))}};var Icon={questionMarkIcon:WH2.Icon.UNKNOWN,sizes:["small","medium","large","blizzard"],sizes2:[18,36,56,64],sizeIds:{small:0,medium:1,large:2,blizzard:3},premiumOffsets:[[-56,-36],[-56,0],[0,0],[0,0]],premiumBorderClasses:["-premium","-gold","","-premiumred","-red",""],STANDARD_BORDER:2,privilegeBorderClasses:{uncommon:"-q2",rare:"-q3",epic:"-q4",legendary:"-q5"},idLookupCache:{},create:function(e,t,a,n,i,s,o,r,l,c,d){return d=d||{},null==t&&(t=Icon.sizeIds.medium),WH2.Icon.create(e,WH2.Icon.LEGACY_IDS[t],!1===n?null:n,{border:!o,color:d.color,game:d.game,lazyLoad:d.lazyLoad,number:i,quantity:s,rel:r,simple:c,span:l,type:d.type})},createUser:function(e,t,a,n,i,s,o){2==e&&(t=WH2.staticUrl+"/uploads/avatars/"+t+".jpg");var r=Icon.create(t,a,null,n,null,null,s);return i!=Icon.STANDARD_BORDER?Icon.premiumBorderClasses[i]&&(r.className+=" "+r.className+Icon.premiumBorderClasses[i]):o&&Icon.privilegeBorderClasses.hasOwnProperty(o)&&(r.className+=" "+r.className+Icon.privilegeBorderClasses[o]),2==e&&Icon.moveTexture(r,a,Icon.premiumOffsets[a][0],Icon.premiumOffsets[a][1],!0),r.classList.add("icon"+Icon.sizes[a]+"-sprite"),r},getIdFromName:function(e,t){Icon.idLookupCache.hasOwnProperty(e)?window.requestAnimationFrame((function(){t(Icon.idLookupCache[e]||void 0)})):$.ajax({url:WH2.Url.generatePath("/icon/get-id-from-name"),data:{name:e},dataType:"json",success:function(a){Icon.idLookupCache[e]=a,t(a||void 0)}})},getPrivilegeBorder:function(e){var t=!1;return e>=5e3&&(t="uncommon"),e>=1e4&&(t="rare"),e>=15e3&&(t="epic"),e>=25e3&&(t="legendary"),t},setUrl:function(e,t){t||(t="javascript:"),Icon.getLink(e).href=t},setTexture:function(e,t,a){var n=e.firstChild.style;if(n.backgroundSize="",n.backgroundPosition="",a)if(-1!==a.indexOf("/"))n.backgroundImage="url("+a+")",n.backgroundSize="contain";else{let e=Icon.sizes[t];"blizzard"===e&&(e="large"),n.backgroundImage=`url("${WH2.Icon.getIconUrl(a,e)}")`}else n.backgroundImage=null},moveTexture:function(e,t,a,n,i){var s=e.firstChild.style;s.backgroundSize="",a||n?s.backgroundPosition=i?a+"px "+n+"px":-a*Icon.sizes2[t]+"px "+-n*Icon.sizes2[t]+"px":s.backgroundPosition&&(s.backgroundPosition="")},getLink:function(e){return WH2.gE(e,"a")[0]},showIconInfo:function(e){const t=e.dataset.env?WH2.getDataEnvFromKey(e.dataset.env):null;if(e.firstChild&&t){let a=e.firstChild.style;if(a.backgroundImage&&(!WH2.STATIC_URL||a.backgroundImage.indexOf(WH2.STATIC_URL)>=4)){let e=a.backgroundImage.match(/images\/([^/]+)\/icons\/[^/]+\/([^/.]+).(?:jpg|gif)/);e&&Icon.displayIcon(e[2],t)}}},onClick:function(){Icon.showIconInfo(this)},displayIcon:function(e,t){Dialog.templates.icondisplay||(Dialog.templates.icondisplay={title:WH2.TERMS.icon,width:500,buttons:[["arrow",WH2.TERMS.original],["x",WH2.TERMS.close]],fields:[{id:"icon",label:WH2.TERMS.name_colon,required:1,type:"text",labelAlign:"left",compute:function(e,a,n,i){i.classList.add("icon-dialog-content");var s=this.iconDiv=WH2.ce("div");s.update=function(){setTimeout((function(){WH2.safeSelect(e)}),10),WH2.ee(s),WH2.ae(s,WH2.Icon.create(e.value,WH2.Icon.LARGE,void 0,{dataEnv:t}))},WH2.ae(s,WH2.Icon.create(a,WH2.Icon.LARGE,void 0,{dataEnv:t})),WH2.ae(i,s),WH2.ae(i,e)}},{id:"iconId",label:WH2.TERMS.id+WH2.TERMS.colon_punct,type:"text",labelAlign:"left",compute:function(e,t,a,n){n.classList.add("icon-dialog-content"),e.value="",this.iconIdField=e}},{id:"location",label:" ",required:1,type:"caption",compute:function(e,t,a,n,i){WH2.ee(n),n.classList.add("icon-dialog-caption");let s=WH2.Strings.escapeHtml(WH2.Url.generatePath("/items?filter=142;0;"+this.data.icon)),o=WH2.Strings.escapeHtml(WH2.Url.generatePath("/spells?filter=15;0;"+this.data.icon)),r=WH2.Strings.escapeHtml(WH2.Url.generatePath("/achievements?filter=10;0;"+this.data.icon));var l=WH2.TERMS.seeallusingicon_format;l=(l=(l=l.replace("$1",'<a href="'+s+'">'+WH2.Types.getLowerPlural(WH2.Types.ITEM)+"</a>")).replace("$2",'<a href="'+o+'">'+WH2.Types.getLowerPlural(WH2.Types.SPELL)+"</a>")).replace("$3",'<a href="'+r+'">'+WH2.Types.getLowerPlural(WH2.Types.ACHIEVEMENT)+"</a>"),n.innerHTML=l}}],onInit:function(e){this.updateIcon=this.template.updateIcon.bind(this,e)},onShow:function(e){this.updateIcon(),location.hash&&-1==location.hash.indexOf("#icon")?this.oldHash=location.hash:this.oldHash="";var t="#icon";window.g_pageInfo&&g_pageInfo.type&&[WH2.Types.ITEM,WH2.Types.SPELL,WH2.Types.ACHIEVEMENT].includes(g_pageInfo.type)||(t+=`:${this.data.icon}`,this.data.env&&this.data.env!==WH2.getDataEnv()&&(t+=`:${WH2.getDataEnvKey(this.data.env)}`)),location.hash=t},onHide:function(e){this.oldHash?WH2.setHash(this.oldHash):WH2.clearHash()},updateIcon:function(e){this.iconDiv.update();var t=this.iconIdField;Icon.getIdFromName(e.icon.value,(function(e){t.value=e||""}))},onSubmit:function(e,t,a,n){if("arrow"===a){let e=WH2.Icon.getIconUrl(t.icon,WH2.Icon.LARGE,t.env);return window.open(e,"_blank").focus(),!1}return!0}}),Icon.icDialog||(Icon.icDialog=new Dialog),Icon.icDialog.show("icondisplay",{data:{icon:e,env:t}})},checkPound:function(){if(location.hash&&0===location.hash.indexOf("#icon")){let e,t=location.hash.split(":"),a=WH2.getDataEnv();3===t.length?(e=t[1],a=WH2.getDataEnvFromKey(t[2])??a):2===t.length?e=t[1]:1===t.length&&window.g_pageInfo&&(e=WH2.Gatherer.getIconName(g_pageInfo.type,g_pageInfo.typeId)),e&&Icon.displayIcon(e,a)}}};WH2.REMOTE||WH2.onLoad(Icon.checkPound),WH2.Tooltips=WH2.Tooltips||new function(){const e=this,t=WH2.Game,a=WH2.Icon,n=WH2.Types,i="nether",s=550,o={garrisonability:"mission-ability",itemset:"item-set",petability:"pet-ability"},r={1:299204,2:299205,3:299206,4:299207},l=15,c=15,d=[n.ACHIEVEMENT,n.AFFIX,n.AZERITE_ESSENCE,n.AZERITE_ESSENCE_POWER,n.ITEM,n.SPELL,n.DI_EQUIP_ITEM,n.DI_MISC_ITEM,n.DI_PARAGON_SKILL,n.DI_SKILL,n.D4_AFFIX,n.D4_ASPECT,n.D4_ITEM,n.D4_PARAGON_GLYPH,n.D4_PARAGON_NODE,n.D4_SKILL,n.D4_VAMPIRIC_POWER,n.D4_SENESCHAL_STONE],p={"-1000":{name:"Mount",path:"mount",mobile:!0,data:{},maxId:5e4},"-1001":{name:"Recipe",path:"recipe",mobile:!0,data:{},maxId:5e5},"-1002":{name:"Battle Pet",path:"battle-pet",mobile:!0,data:{},maxId:5e4},[n.NPC]:{name:"NPC",path:"npc",mobile:!1,data:{},maxId:5e5},[n.OBJECT]:{name:"Object",path:"object",mobile:!1,data:{},maxId:75e4},[n.ITEM]:{name:"Item",path:"item",mobile:!0,data:{},maxId:5e5},[n.ITEM_SET]:{name:"Item Set",path:"item-set",mobile:!0,data:{},maxId:1e4,minId:-5e3},[n.QUEST]:{name:"Quest",path:"quest",mobile:!1,data:{},maxId:1e5},[n.SPELL]:{name:"Spell",path:"spell",mobile:!0,data:{},maxId:5e5},[n.ZONE]:{name:"Zone",path:"zone",mobile:!1,data:{},maxId:5e4},[n.ACHIEVEMENT]:{name:"Achievement",path:"achievement",mobile:!0,data:{},maxId:5e4},[n.EVENT]:{name:"Event",path:"event",mobile:!1,data:{},maxId:1e4},[n.CURRENCY]:{name:"Currency",path:"currency",mobile:!1,data:{},maxId:1e4},[n.BUILDING]:{name:"Building",path:"building",mobile:!1,data:{},maxId:1e3},[n.FOLLOWER]:{name:"Follower",path:"follower",mobile:!0,data:{},maxId:1e4},[n.MISSION_ABILITY]:{name:"Mission Ability",path:"mission-ability",mobile:!0,data:{},maxId:1e4},[n.MISSION]:{name:"Mission",path:"mission",mobile:!0,data:{},maxId:1e4},[n.SHIP]:{name:"Ship",path:"ship",mobile:!0,data:{},maxId:1e4},[n.THREAT]:{name:"Threat",path:"threat",mobile:!1,data:{},maxId:1e3},[n.RESOURCE]:{name:"Resource",path:"resource",mobile:!0,data:{},maxId:100,minId:0},[n.CHAMPION]:{name:"Champion",path:"champion",mobile:!0,data:{},maxId:1e4},[n.ORDER_ADVANCEMENT]:{name:"Order Advancement",path:"order-advancement",mobile:!0,data:{},maxId:5e3},[n.BFA_CHAMPION]:{name:"BFA Champion",path:"bfa-champion",mobile:!0,data:{},maxId:1e4},[n.AFFIX]:{name:"Affix",path:"affix",mobile:!0,data:{},maxId:1e3},[n.AZERITE_ESSENCE_POWER]:{name:"Azerite Essence Power",path:"azerite-essence-power",mobile:!0,data:{},maxId:1e3},[n.AZERITE_ESSENCE]:{name:"Azerite Essence",path:"azerite-essence",mobile:!1,data:{},maxId:100},[n.STORYLINE]:{name:"Storyline",path:"storyline",mobile:!1,data:{},maxId:1e4},[n.ADVENTURE_COMBATANT_ABILITY]:{name:"Adventure Combatant Ability",path:"adventure-combatant-ability",mobile:!0,data:{},maxId:1e4},[n.GUIDE]:{name:"Guide",path:"guide",mobile:!1,data:{}},[n.TRANSMOG_SET]:{name:"Transmog Set",path:"transmog-set",mobile:!0,data:{},maxId:5e4},[n.OUTFIT]:{name:"Outfit",path:"outfit",mobile:!0,data:{}},[n.BATTLE_PET_ABILITY]:{name:"Battle Pet Ability",path:"pet-ability",mobile:!0,data:{},maxId:1e4},[n.DI_EQUIP_ITEM]:{name:"Equipment Item",path:"equip-item",mobile:!0,data:{},embeddedIcons:!0},[n.DI_MISC_ITEM]:{name:"Miscellaneous Item",path:"misc-item",mobile:!0,data:{},embeddedIcons:!0},[n.DI_NPC]:{name:"NPC",path:"npc",mobile:!0,data:{}},[n.DI_PARAGON_SKILL]:{name:"Paragon Skill",path:"paragon-skill",mobile:!0,data:{}},[n.DI_QUEST]:{name:"Quest",path:"quest",mobile:!0,data:{}},[n.DI_SET]:{name:"Set",path:"set",mobile:!0,data:{}},[n.DI_SKILL]:{name:"Skill",path:"skill",mobile:!0,data:{}},[n.DI_ZONE]:{name:"Zone",path:"zone",mobile:!0,data:{}},[n.D4_AFFIX]:{name:"Affix",path:"affix",mobile:!0,data:{},embeddedIcons:!0},[n.D4_ASPECT]:{name:"Aspect",path:"aspect",mobile:!0,data:{},embeddedIcons:!0},[n.D4_PARAGON_GLYPH]:{name:"Paragon Glyph",path:"paragon-glyph",mobile:!0,data:{},embeddedIcons:!0},[n.D4_PARAGON_NODE]:{name:"Paragon Node",path:"paragon-node",mobile:!0,data:{},embeddedIcons:!0},[n.D4_SKILL]:{name:"Skill",path:"skill",mobile:!0,data:{},embeddedIcons:!0},[n.PROFESSION_TRAIT]:{name:"Profession Trait",path:"profession-trait",mobile:!0,data:{},maxId:5e5},[n.D4_ITEM]:{name:"Item",path:"item",mobile:!0,data:{},embeddedIcons:!0},[n.TRADING_POST_ACTIVITY]:{name:"Trading Post Activity",path:"trading-post-activity",mobile:!0,data:{},maxId:1e4},[n.D4_VAMPIRIC_POWER]:{name:"Vampiric Power",path:"vampiric-power",mobile:!0,data:{},embeddedIcons:!0},[n.D4_SENESCHAL_STONE]:{name:"Seneschal Stone",path:"seneschal-stone",mobile:!0,data:{},embeddedIcons:!0}},u=(()=>{let e={[WH2.dataTree.D2]:["guide"],[WH2.dataTree.D4]:["affix","aspect","guide","item","paragon-glyph","paragon-node","seneschal-stone","skill","vampiric-power"],[WH2.dataTree.DI]:["equip-item","guide","misc-item","npc","paragon-skill","set","skill"],[WH2.dataTree.RETAIL]:["achievement","adventure-combatant-ability","affix","azerite-essence","azerite-essence-power","battle-pet","bfa-champion","building","champion","currency","event","follower","garrisonability","guide","item","item-set","itemset","mission","mission-ability","mount","npc","object","order-advancement","outfit","pet-ability","petability","profession-trait","quest","recipe","resource","ship","spell","statistic","storyline","threat","trading-post-activity","transmog-set","zone"],[WH2.dataTree.CLASSIC]:["currency","event","guide","item","item-set","itemset","npc","object","outfit","pet-ability","petability","quest","resource","spell","statistic","transmog-set","zone"]};return e[WH2.dataTree.TBC]=e[WH2.dataTree.CLASSIC],e[WH2.dataTree.WRATH]=e[WH2.dataTree.TBC].concat(["achievement"]),e[WH2.dataTree.CATA]=e[WH2.dataTree.WRATH],e})(),h={traits:{agi:["Agility","Agi","Agi"],arcres:["Arcane resistance","Arcane Resist","ArcR"],arcsplpwr:["Arcane spell power","Arcane Power","ArcP"],armor:["Armor","Armor","Armor"],armorbonus:["Additional armor","Bonus Armor","AddAr"],armorpenrtng:["Armor penetration rating","Armor Pen","Pen"],atkpwr:["Attack power","AP","AP"],block:["Block value","Block Value","BkVal"],blockrtng:["Block rating","Block","Block"],critstrkrtng:["Critical strike rating","Crit","Crit"],defrtng:["Defense rating","Defense","Def"],dmg:["Weapon damage","Damage","Dmg"],dmgmax1:["Maximum damage","Max Damage","Max"],dmgmin1:["Minimum damage","Min Damage","Min"],dodgertng:["Dodge rating","Dodge","Dodge"],dps:["Damage per second","DPS","DPS"],exprtng:["Expertise rating","Expertise","Exp"],firres:["Fire resistance","Fire Resist","FirR"],firsplpwr:["Fire spell power","Fire Power","FireP"],frores:["Frost resistance","Frost Resist","FroR"],frosplpwr:["Frost spell power","Frost Power","FroP"],hastertng:["Haste rating","Haste","Haste"],health:["Health","Health","Hlth"],healthrgn:["Health regeneration","HP5","HP5"],hitrtng:["Hit rating","Hit","Hit"],holres:["Holy resistance","Holy Resist","HolR"],holsplpwr:["Holy spell power","Holy Power","HolP"],int:["Intellect","Int","Int"],level:["Level","Level","Lvl"],mana:["Mana","Mana","Mana"],manargn:["Mana regeneration","MP5","MP5"],mastrtng:["Mastery rating","Mastery","Mastery"],mleatkpwr:["Melee attack power","Melee AP","AP"],mlecritstrkrtng:["Melee critical strike rating","Melee Crit","Crit"],mledmgmax:["Melee maximum damage","Melee Max Damage","Max"],mledmgmin:["Melee minimum damage","Melee Min Damage","Min"],mledps:["Melee DPS","Melee DPS","DPS"],mlehastertng:["Melee haste rating","Melee Haste","Haste"],mlehitrtng:["Melee hit rating","Melee Hit","Hit"],mlespeed:["Melee speed","Melee Speed","Speed"],natres:["Nature resistance","Nature Resist","NatR"],natsplpwr:["Nature spell power","Nature Power","NatP"],nsockets:["Number of sockets","Sockets","Sockt"],parryrtng:["Parry rating","Parry","Parry"],reqarenartng:["Required personal and team arena rating","Req Rating","Rating"],reqlevel:["Required level","Req Level","Level"],resirtng:["PvP Resilience rating","PvP Resilience","Resil"],rgdatkpwr:["Ranged attack power","Ranged AP","RAP"],rgdcritstrkrtng:["Ranged critical strike rating","Ranged Crit","Crit"],rgddmgmax:["Ranged maximum damage","Ranged Max Damage","Max"],rgddmgmin:["Ranged minimum damage","Ranged Min Damage","Min"],rgddps:["Ranged DPS","Ranged DPS","DPS"],rgdhastertng:["Ranged haste rating","Ranged Haste","Haste"],rgdhitrtng:["Ranged hit rating","Ranged Hit","Hit"],rgdspeed:["Ranged speed","Ranged Speed","Speed"],sepbasestats:"Base stats",sepdefensivestats:"Defensive stats",sepindividualstats:"Individual stats",sepoffensivestats:"Offensive stats",sepresistances:"Resistances",sepweaponstats:"Weapon stats",shares:["Shadow resistance","Shadow Resist","ShaR"],shasplpwr:["Shadow spell power","Shadow Power","ShaP"],speed:["Speed","Speed","Speed"],spi:["Spirit","Spi","Spi"],splcritstrkrtng:["Spell critical strike rating","Spell Crit","Crit"],spldmg:["Damage done by spells","Spell Damage","Dmg"],splheal:["Healing done by spells","Healing","Heal"],splpwr:["Spell power","Spell Power","SP"],splhastertng:["Spell haste rating","Spell Haste","Haste"],splhitrtng:["Spell hit rating","Spell Hit","Hit"],splpen:["Spell penetration","Spell Pen","Pen"],sta:["Stamina","Sta","Sta"],str:["Strength","Str","Str"],pvppower:["PvP Power","PvPPower","PvPPower"]}},g={colorLinks:"colorlinks",iconizeLinks:"iconizelinks",renameLinks:"renamelinks"},f=WH2.TERMS||{genericequip_tip:'<span class="q2">Equip: Increases your $1 by \x3c!--rtg$2--\x3e$3.</span><br />',reforged_format:"Reforged ($1 $2 &rarr; $1 $3)"},m={0:"enus",1:"kokr",2:"frfr",3:"dede",4:"zhcn",6:"eses",7:"ruru",8:"ptbr",9:"itit"},W=320,H=0,E=5,T=3,v=4,S=1,I=2,y=[{},{top:!1},{right:!1},{right:!1,top:!1}],_=/([a-zA-Z0-9-]+)=?([^&?#]*)/g,b=(()=>{let e={};return Object.entries(p).forEach((([a,i])=>{let s=parseInt(a);if(s<0)return void(e[i.path]=s);let o=n.getGame(s),r=o===t.WOW?"":`${t.getKey(o)}-`;n.getHistoricalDetailPageNames(s).forEach((t=>e[r+t]=s))})),e})(),w="(?![^/?&#])",A="^https?://(.+?)?\\.?(?:wowhead)\\.com(?:\\:\\d+)?/",L=new RegExp(A+"\\??("+u[WH2.dataTree.RETAIL].join("|")+")[=/](?:[^/?&#]+-)?(-?\\d+(?:\\.\\d+)?)"+w),C=new RegExp(A+"(guide)s?/([^?&#]+)"),R=[WH2.dataEnv.MAIN,WH2.dataEnv.PTR,WH2.dataEnv.PTR2,WH2.dataEnv.BETA,WH2.dataEnv.CATA,WH2.dataEnv.D4,WH2.dataEnv.D4PTR,WH2.dataEnv.D4BETA,WH2.dataEnv.WRATH,WH2.dataEnv.DI,WH2.dataEnv.TBC,WH2.dataEnv.CLASSIC,WH2.dataEnv.D2].map((e=>{let a=WH2.getDataTree(e),n=t.getByTree(a),i=u[a],s=t.getSelectorByDataEnv(e),o="^https?://(?:\\w+\\.)*wowhead\\.com(?:\\:\\d+)?"+(s?`/${s}`:"")+"/(?:(\\w\\w)/)?",r="("+i.join("|")+")";return{detailPagePrefix:n===t.WOW?"":`${t.getKey(n)}-`,envId:e,prefixedDetailPageNames:n===t.WOW?[]:i.filter((e=>"guide"!==e)),regexFrontPaths:new RegExp(o+r+"/(?:[^/?&#]+-)?(\\d+)"+w),regexGuidePaths:new RegExp(o+"(guide)s?/([^?&#]+)"),regexLegacyPaths:new RegExp(o+r+"=(-?\\d+(?:\\.\\d+)?)"),treeId:a}})),M=-1,N=0,D=1,O=0,P=1,x=2,k=3,B=4,F=5,U={[P]:"loading",[F]:"loading",[x]:"error",[O]:"loading",[k]:"error",[B]:"ok"},G=[n.GUIDE],q={0:{achievementComplete:"Achievement earned by $1 on $2/$3/$4",loading:"Loading",noResponse:"No response from server :(",notFound:"%s Not Found"},1:{achievementComplete:"$1() $2/$3/$4  ",loading:" ",noResponse:"   :(",notFound:"%s ()   "},2:{achievementComplete:"Haut-fait reu par $1 le $2/$3/$4",loading:"Chargement",noResponse:"Pas de rponse du serveur :(",notFound:"%s non trouv"},3:{achievementComplete:"Erfolg wurde von $1 am $3.$2.$4 errungen",loading:"Ldt",noResponse:"Keine Antwort vom Server :(",notFound:"%s nicht gefunden"},4:{achievementComplete:"$1$2/$3/$4",loading:"",noResponse:" :(",notFound:"%s"},6:{achievementComplete:"Logro conseguido por $1 el $2/$3/$4",loading:"Cargando",noResponse:"No hay respuesta del servidor :(",notFound:"%s no encontrado/a"},7:{achievementComplete:"$1 ()   $2/$3/$4",loading:"",noResponse:"    :(",notFound:"%s  "},8:{achievementComplete:"Conquista conseguida por $1 em $3/$2/$4",loading:"Carregando",noResponse:"Sem resposta do servidor :(",notFound:"%s no encontrado(a)"},9:{achievementComplete:"Impresa compiuta da $1 su $2/$3/$4",loading:"Caricamento",noResponse:"Nessuna risposta dal server :(",notFound:"%s Non Trovato"}},$=WH2.Device.isTouch(),z={cursorX:void 0,cursorY:void 0,enabled:!0,element:void 0,elements:{icon:void 0,logo:void 0,screen:void 0,screenCaption:void 0,screenInnerBox:void 0,screenInnerWrapper:void 0,tooltip:void 0,tooltip2:void 0,tooltipTable:void 0,tooltipTable2:void 0,tooltipTd:void 0,tooltipTd2:void 0},showScreenshots:!1,initiatedByUser:!1,iScroll:null,mobileScrollInitialized:!1,show:{dataEnv:void 0,fullId:void 0,hasLogo:!0,locale:void 0,mode:H,params:{},type:void 0},showCharacterCompletion:!WH2.REMOTE,showIcon:!1,showSecondary:!1,showingTooltip:!1,touchElement:void 0,usingScreen:!1};function j(e,t){if(e.classList)for(let a=0,n=t.length;a<n;a++)e.classList.add(t[a]);else for(var a=0;a<t.length;a++){let n=e.getAttribute&&e.getAttribute("class")||"";(" "+n+" ").indexOf(" "+t[a]+" ")<0&&e.setAttribute("class",(n?n+" ":"")+t[a])}}function Y(e,t){let a=WH2.reforgeStats?.[t];if(!a)return e;let n,i=[a.i1];for(let e in WH2.individualToGlobalStat)WH2.individualToGlobalStat[e]===i[0]&&i.push(e);if((n=e.match(new RegExp("(\x3c!--(stat|rtg)("+i.join("|")+")--\x3e)[+-]?([0-9]+)")))&&!e.match(new RegExp("\x3c!--(stat|rtg)"+a.i2+"--\x3e[+-]?[0-9]+"))){let t=Math.floor(n[4]*a.v),i=h.traits[a.s2][0];e=(e=(e=6==a.i2?e.replace("\x3c!--rs--\x3e","<br />+"+t+" "+i):e.replace("\x3c!--rr--\x3e",WH2.sprintfGlobal(f.genericequip_tip,i.toLowerCase(),a.i2,t))).replace(n[0],n[1]+(n[4]-t))).replace("\x3c!--rf--\x3e",'<span class="q2">'+WH2.sprintfGlobal(f.reforged_format,t,h.traits[a.s1][2],h.traits[a.s2][2])+"</span><br />")}return e}function K(e,t,a,n){n?e.dataset.status=U[n]:delete e.dataset.status;let i=t&&WH2.Game.getKey(WH2.Game.getByEnv(t));i?e.dataset.game=i:delete e.dataset.game;let s=t&&WH2.getDataTreeKey(WH2.getDataTree(t));s?e.dataset.tree=s:delete e.dataset.tree;let o=t&&WH2.getDataEnvKey(t);o?e.dataset.env=o:delete e.dataset.env;let r=a&&WH2.Types.getReferenceName(a);r?e.dataset.type=r:delete e.dataset.type}function V(){WH2.aE(document,"keydown",(function(t){if(27===t.keyCode)e.clearTouchTooltip(),He()})),$?J():WH2.aE(document,"mouseover",Ce),V=()=>{}}function Q(e){e.dataset&&"true"!==e.dataset.hasWhTouchEvent&&(null==e.onclick?e.onclick=Re:WH2.aE(e,"click",Re),e.dataset.hasWhTouchEvent="true")}function J(e){$&&we((function(){e=e||document.body;for(var t=WH2.gE(e,"a"),a=0,n=t.length;a<n;a++)Q(t[a])}))}function X(e,t){t.style.maxHeight=null,delete e.WH2ttHeightCap,delete e.dataset.height,e.style.maxHeight=null}function Z(e,t){let a=WH2.ce("div",{className:"wowhead-tooltip"}),n=WH2.ce("table"),i=WH2.ce("tbody"),s=WH2.ce("tr"),o=WH2.ce("tr"),r=WH2.ce("td"),l=WH2.ce("th",{style:{backgroundPosition:"top right"}}),c=WH2.ce("th",{style:{backgroundPosition:"bottom left"}}),d=WH2.ce("th",{style:{backgroundPosition:"bottom right"}}),p={tooltip:a};return e&&(r.innerHTML=e),WH2.ae(s,r),WH2.ae(s,l),WH2.ae(i,s),WH2.ae(o,c),WH2.ae(o,d),WH2.ae(i,o),WH2.ae(n,i),t||(p.icon=WH2.ce("div",{className:"whtt-tooltip-icon",style:{visibility:"hidden"}}),WH2.ae(a,p.icon)),WH2.ae(a,n),t||(p.logo=WH2.ce("div",{className:"wowhead-tooltip-powered"}),WH2.ae(a,p.logo)),p}function ee(t,a,n,i,s){var o=ce(t,a,s=s||{});z.show.type=t,z.show.fullId=o,z.show.dataEnv=n,z.show.locale=i,z.show.params=s,Ze.isLoaded(t,n);let r=e.getEntity(t,o,n,i);r.status===B||r.status===k?Qe():r.status===P||r.status===F?-1===WH2.inArray(G,t)&&Ve(r.status,i,pe(i,"loading")):xe(t,a,n,i,-1!==WH2.inArray(G,t),s)}function te(e){return!(!e||!e.icon&&!e.iconImageHash)}function ae(e,t){let a=WH2.qs("table",e),n=WH2.qs("td",a),i=n.childNodes;if(e.classList.remove("tooltip-slider"),i.length>=2&&"TABLE"===i[0].nodeName&&"TABLE"===i[1].nodeName){let s=i[0],o=i[1];s.style.WH2iteSpace="nowrap";let r=parseInt(e.style.width);e.slider&&r||(r=Math.max(s.getBoundingClientRect().width,o.getBoundingClientRect().width)+20),r>W&&(s.style.WH2iteSpace=null);for(let e=2;e<i.length;e++)"BLOCKQUOTE"===i[e].nodeName&&(r=Math.max(r,i[e].getBoundingClientRect().width+20));r=Math.min(W,r),r>20&&(e.slider&&(Slider.setSize(e.slider,r-6),e.classList.add("tooltip-slider")),e.classList.add("wowhead-tooltip-width-restriction"),e.classList.add("wowhead-tooltip-width-"+r),e.style.width=r+"px",WH2.qsa(":scope > table",n).forEach((e=>e.style.width="100%")),t&&e.offsetHeight>ge()&&a.classList.add("shrink"))}else if(i.length&&e.slider){let n=i[0],s="TABLE"===n.nodeName;s&&(n.style.WH2iteSpace="nowrap");let o=parseInt(e.style.width);!o&&s?(o=n.getBoundingClientRect().width+20,o>W&&(n.style.WH2iteSpace=null)):o=a.getBoundingClientRect().width+20,o=Math.min(W,o),o>20&&(e.style.width=o+"px",s&&(n.style.width="100%"),e.slider&&(Slider.setSize(e.slider,o-6),e.classList.add("tooltip-slider")),t&&e.offsetHeight>ge()&&a.classList.add("shrink"))}}function ne(e){ae(e,!1),qe(e,!0)}function ie(e){if(z.elements.tooltip)try{z.elements.tooltip.dispatchEvent(new Event(e))}catch(t){try{let t=document.createEvent("Event");t.initEvent(e,!0,!0),z.elements.tooltip.dispatchEvent(t)}catch(e){}}}function se(){let e=[];for(let t=0;t<document.links.length;t++)e.push(document.links[t]);return e}function oe(e){if("object"==typeof p[e]){if(WH2.REMOTE&&p[e].hasOwnProperty("maxId"))return{min:p[e].hasOwnProperty("minId")?p[e].minId:1,max:p[e].maxId}}else WH2.error("Wowhead tooltips could not find config for entity type.",e)}function re(e){return"object"!=typeof p[e]?(WH2.error("Wowhead tooltips could not find config for entity type.",e),"Entity"):p[e].name}function le(e){return"object"!=typeof p[e]?(WH2.error("Wowhead tooltips could not find config for entity type.",e),"unknown"):p[e].path}function ce(e,t,a){return a.build?t+"build"+a.build:t+(a.rand?"r"+a.rand:"")+(a.ench?"e"+a.ench.join(","):"")+(a.gems?"g"+a.gems.join(","):"")+(a.sock?"s":"")+(a.twtbc?"twtbc":"")+(a.twwotlk?"twwotlk":"")+(a.twcata?"twcata":"")+(a.twmists?"twmists":"")+(a.twwod?"twwod":"")+(a.ilvl?"ilvl"+a.ilvl:"")+(a.lvl?"lvl"+a.lvl:"")+(a.gem1lvl?"g1lvl"+a.gem1lvl:"")+(a.gem2lvl?"g2lvl"+a.gem2lvl:"")+(a.gem3lvl?"g3lvl"+a.gem3lvl:"")+(a.artk?"ak"+a.artk:"")+(a.nlc?"nlc"+a.nlc:"")+(a.transmog?"transmog"+a.transmog:"")+(a.tink?"tink"+a.tink:"")+(a.pvp?"pvp":"")+(a.bonus?"b"+a.bonus.join(","):"")+(a.gem1bonus?"g1b"+a.gem1bonus.join(","):"")+(a.gem2bonus?"g2b"+a.gem2bonus.join(","):"")+(a.gem3bonus?"g3b"+a.gem3bonus.join(","):"")+(a["crafted-stats"]?"craftedStats"+a["crafted-stats"].join(","):"")+(a["crafting-quality"]?"craftingQuality"+a["crafting-quality"]:"")+(a.q?"q"+a.q:"")+(a.level?"level"+a.level:"")+(a.abil?"abil"+a.abil.join(","):"")+(a.dd?"dd"+a.dd:"")+(a.ddsize?"ddsize"+a.ddsize:"")+(a.diff===n.SPELL?"diff"+a.diff:"")+(a.def?"def"+a.def:"")+(a.rank?"rank"+a.rank:"")+(a.alt?"alt"+a.alt.join(","):"")+(a.awakened?"awakened"+a.awakened:"")+(a.class?"class"+a.class:"")+(e!==n.SPELL&&a.spec?"spec"+a.spec:"")+(a.rewards?"rewards"+a.rewards.join(":"):"")+(a["azerite-powers"]?"azPowers"+a["azerite-powers"]:"")+(a["azerite-essence-powers"]?"aePowers"+a["azerite-essence-powers"]:"")+(a.nomajor?"nomajor":"")+(a.affixes?"affixes"+a.affixes.join(","):"")+(a.board?"board"+a.board:"")+(a.glyph?"glyph"+a.glyph:"")+(a.greaterAffixes?"greaterAffixes"+a.greaterAffixes.join(","):"")+(a.itemPower?"itemPower"+a.itemPower:"")+(a.itemType?"itemType"+a.itemType:"")+(a.masterworking?"masterworking"+a.masterworking.join(","):"")+(a.hasOwnProperty("mod")?"mod"+a.mod:"")+(a.mods?"mods"+a.mods.join(","):"")+(a.nodes?"nodes"+a.nodes.join(","):"")+(a.upgrades?"upgrades"+a.upgrades:"")+(a.stars?"stars"+a.stars:"")}function de(e,t,a){if(WH2.REMOTE)return!1;if(!WH2.User.isPremium())return!1;if(!z.showScreenshots)return!1;let i=WH2.Gatherer.get(e,t,a,!0);if(i){if(i.screenshot&&i.screenshot.id)return[WH2.getScreenshotUrl(i.screenshot.id,"small",{imageType:i.screenshot.imageType}),"screenshot"];if(!WH2.REMOTE&&e===n.ITEM&&i.jsonequip&&i.jsonequip.displayid){let e=i.jsonequip.displayid,t=i.reqrace||i.jsonequip.races,a=WH2.Wow.Models.getRaceIdFromMask(t);(i.classs&&i.classs!==WH2.Wow.Item.CLASS_ARMOR||i.jsonequip.slotbak&&!WH2.Wow.Item.isArmorInvType(i.jsonequip.slotbak))&&(a=void 0);let n=Listview.funcBox.getCurrentItemBonuses.call(this,i),s=g_items.getAppearance(i.id,n);if(s&&s[0]&&(e=s[0]),e)return[WH2.Wow.Item.getThumbUrl(e,a),"screenshot"]}}return!1}function pe(e,t){return(q[e]||q[0])[t]||""}function ue(e){var t=he();return t?t.hasOwnProperty(e)?t[e]:g[e]&&t.hasOwnProperty(g[e])?t[g[e]]:null:null}function he(){return"object"==typeof whTooltips?whTooltips:"object"==typeof wowhead_tooltips?wowhead_tooltips:null}function ge(){let e=document.documentElement,t=document.body;return Math.max(t.offsetHeight,t.scrollHeight,e.clientHeight,e.offsetHeight,e.scrollHeight)}function fe(){return(z.show.params&&z.show.params.buff?"buff":"")+"spells"}function me(e){var t="tooltip";return z.show.params&&z.show.params.buff&&(t="buff"),z.show.params&&z.show.params.text&&(t="text"),z.show.params&&z.show.params.premium&&(t="tooltip_premium"),t+(e||"")}function We(e){if(e=e||"www",!WH2.isDev())return"https://"+e+".wowhead.com";var t=document.location.hostname.split(".");t=t[t.length-3];var a="https://"+(e="www"===e?t:e+"."+t)+".wowhead.com";return""!==document.location.port&&(a+=(document.location.port.indexOf(":")<0?":":"")+document.location.port),"https:"!==document.location.protocol&&(a=a.replace(/^https:/,"http:")),a}function He(){if(z.elements.tooltip){let e=z.elements.tooltip;z.showingTooltip=!1,e.style.display="none",qe(e,!1),z.elements.tooltipTable.className="";let t=(e.WH2ttHeightCap||{}).innerScroll;t&&X(e,t),Fe(),WH2.WAS&&WH2.WAS.restoreHidden(),ie("hide")}z.elements.tooltip2&&(z.elements.tooltip2.style.display="none",qe(z.elements.tooltip2,!1),z.elements.tooltipTable2.className="")}function Ee(e,t){if(WH2.REMOTE||!WH2.isRetailTree(t.dataEnv))return e;let a=WH2.Profiler.getFavorite(!0);return a?((WH2.User.Completion.getByType(WH2.Types.ACHIEVEMENT)[a.id]||[]).includes(parseInt(t.fullId))?e=e.replace(new RegExp("\x3c!--cr\\d+:[^<]+","g"),'<span class="q2">$&</span>'):(WH2.User.Completion.getAchievementCriteria()[t.fullId]||[]).forEach((t=>{e=e.replace(new RegExp("\x3c!--cr"+t+":[^<]+","g"),'<span class="q2">$&</span>')})),e):e}function Te(e,i,s,o){o&&a.isValidSize(o)||(o="tiny");let r=s.icon;switch(WH2.Types.getGame(i)){case t.WOW:r=r.toLowerCase();break;case t.D4:r=s.iconImageHash}if("tiny"===o){let s=n.getGame(i),o=a.getIconUrl(r,a.TINY,t.getEnv(s));j(e,["icontinyl"]),e.dataset.game=t.getKey(s),e.dataset.type=n.getStringId(i),e.style.backgroundImage="url("+o+")"}else{if("true"===e.getAttribute("data-wh-icon-added"))return;WH2.aef(e,a.createByEntity(s,i,null,{size:o,span:!0}))}e.setAttribute("data-wh-icon-added","true")}function ve(){var e=ue("hide");if(!e)return;if(!document.styleSheets)return;var t=document.createElement("style");t.type="text/css",document.head.appendChild(t),window.createPopup||document.head.appendChild(WH2.ct(""));let a=document.styleSheets[document.styleSheets.length-1];for(var n in e)e.hasOwnProperty(n)&&e[n]&&(a.insertRule?a.insertRule(".wowhead-tooltip .WH2tt-"+n+"{display: none}",a.cssRules.length):a.addRule&&a.addRule(".wowhead-tooltip .WH2tt-"+n,"display: none",-1));ve=()=>{}}function Se(e){return"object"!=typeof p[e]?(WH2.error("Wowhead tooltips could not find config for entity type.",e),!1):p[e].mobile}function Ie(t,a,n,i){let s=e.getEntity(t,a,n,i);s.status=x,z.show.type===t&&z.show.fullId===a&&z.show.dataEnv===n&&z.show.locale===i&&Ve(s.status,i,pe(i,"noResponse"))}function ye(e,t,a,n,i,s){if(!z.elements.tooltip)return;let o=z.elements.tooltip;o.style.left="-1000px",o.style.top="-1000px",o.style.width=null,o.style.maxWidth=W+"px";let r=o.getBoundingClientRect().width,l=z.elements.tooltip2;l.style.left="-1000px",l.style.top="-1000px",l.style.width=null,l.style.maxWidth=W+"px";let c,d,p=z.showSecondary?l.getBoundingClientRect().width:0;if(o.style.maxWidth=null,l.style.maxWidth=null,o.style.width=r?r+"px":"auto",l.style.width=p+"px",e||t){let e=o.WH2ttHeightCap,t=(e||{}).maxHeight||window.innerHeight,a=(e||{}).innerScroll;if(o.offsetHeight>=t){if((a=a||WH2.qs(".WH2tt-scroll",o))&&(o.dataset.height="restricted",o.style.maxHeight=t+"px",!e)){let e=o.scrollHeight-o.offsetHeight;a.style.maxHeight=a.scrollHeight-e+"px",o.WH2ttHeightCap={innerScroll:a,maxHeight:o.offsetHeight}}}else a&&X(o,a)}for(let o=0,r=y.length;o<r;++o){let r=y[o];if(c=_e(e,t,a,n,i,s,r.right,r.top),WH2.WAS&&!WH2.WAS.intersect(c)){d=!0;break}if(!WH2.WAS)break}WH2.WAS&&!d&&WH2.WAS.intersect(c,!0),o.style.left=c.l+"px",o.style.top=t+25+"px",qe(o,!0),z.showSecondary&&(l.style.left=c.l+"px",l.style.top=t+25+"px",qe(l,!0)),ie("move")}function _e(e,t,a,n,i,s,o,r){let l=e,c=t,d=z.elements.tooltip,p=z.elements.tooltip.getBoundingClientRect(),u=p.width,h=p.height,g=z.elements.tooltip2.getBoundingClientRect(),f=z.showSecondary?g.width:0,m=z.showSecondary?g.height:0,W=WH2.getWindowSize(),H=WH2.getScroll(),E=H.x,T=H.y,v=H.x+W.w,S=H.y+W.h;return"fixed"===d.style.position&&(l-=e-=H.x,c-=t-=H.y,H={x:0,y:0},E=T=0,v=W.w,S=W.h),window.ZUL?.getEnabled()&&(T+=ZUL.HEIGHT),null==o&&(o=e+a+u+f<=v),null==r&&(r=t-Math.max(h,m)>=T),o?e+=a+i:e=Math.max(e-(u+f),E)-i,r?t-=Math.max(h,m)+s:t+=n+s,e<E?e=E:e+u+f>v&&(e=v-(u+f)),t<T?t=T:t+Math.max(h,m)>S&&(t=Math.max(H.y,S-Math.max(h,m))),z.showIcon&&l>=e-48&&l<=e&&c>=t-4&&c<=t+48&&(t-=48-(c-t)),WH2.createRect(e,t,u,h)}function be(t,a,i,s,r,l,c,d){if(!d.ctrlKey||2!==d.button)return;d.preventDefault(),d.stopPropagation();let p=WH2.DOM.getData(this,"menu");if(p)return void Menu.show(p,this);p=[];let u=e.getEntity(i,ce(i,r,l),t,a);u.data.name&&p.push(Menu.createItem({label:WH2.term("copy_format",WH2.TERMS.name),url:WH2.copyToClipboard.bind(void 0,u.data.name)})),p.push(Menu.createItem({label:WH2.term("copy_format",WH2.TERMS.id),url:WH2.copyToClipboard.bind(void 0,r)}));let h=c;!h&&n.existsInDataEnv(i)&&(h=WH2.Entity.getUrl(i,r,void 0,void 0,t,a)),h&&p.push(Menu.createItem({label:WH2.term("copy_format",WH2.TERMS.url),url:WH2.copyToClipboard.bind(void 0,c)}));let g=o[s]||s;if(WH2.markup.tags[g]){let e="";i===WH2.Types.SPELL&&l.def&&l.rank&&(e+=` def=${l.def} rank=${l.rank}`),p.push(Menu.createItem({label:WH2.term("copy_format",WH2.TERMS.wowheadMarkupTag),url:WH2.copyToClipboard.bind(void 0,`[${g}=${r}${e}]`)}))}Menu.add(this,p,{noEvents:!0,showAtElement:!0,showImmediately:!0},d)}function we(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}function Ae(e){Xe(e),ye(z.cursorX,z.cursorY,0,0,l,c)}function Le(){z.show.type=void 0,z.element=void 0,He()}function Ce(e){let t=e.target,a=0;for(;t&&a<5&&ke(t,e)===M;)t=t.parentNode,a++}function Re(e){let t=this;if(!0===t.hasWHTouchTooltip)return;let a,n=0;for(;t&&n<5&&(a=ke(t,e))===M;)t=t.parentNode,n++;return a===D?(z.touchElement&&(z.touchElement.removeAttribute("data-showing-touch-tooltip"),z.touchElement.hasWHTouchTooltip=!1),z.touchElement=t,z.touchElement.hasWHTouchTooltip=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1):void 0}function Me(e,t,a){switch(t){case"awakened":case"buff":case"map":case"noimage":case"nomajor":case"notip":case"premium":case"pvp":case"sock":case"text":case"twcata":case"twmists":case"twtbc":case"twwod":case"twwotlk":e[t]=!0;break;case"artk":case"board":case"c":case"class":case"covenant":case"crafting-quality":case"dd":case"ddsize":case"def":case"diff":case"diffnew":case"gem1lvl":case"gem2lvl":case"gem3lvl":case"glyph":case"ilvl":case"itemPower":case"itemType":case"level":case"lvl":case"mod":case"nlc":case"pwr":case"q":case"rand":case"rank":case"spec":case"stars":case"tink":case"upgrades":e[t]=parseInt(a);break;case"abil":case"affixes":case"alt":case"azerite-essence-powers":case"azerite-powers":case"bonus":case"crafted-stats":case"cri":case"ench":case"forg":case"gem1bonus":case"gem2bonus":case"gem3bonus":case"gems":case"greaterAffixes":case"know":case"masterworking":case"mods":case"nodes":case"pcs":case"rewards":case"spellModifier":e[t]=a.split(":");break;case"build":case"domain":case"gender":case"who":e[t]=a;break;case"image":"premium"===a?e[a]=!0:e[t]=a?"_"+a:"";break;case"transmog":e[t]="hidden"===a?a:parseInt(a);break;case"when":e[t]=new Date(parseInt(a))}}function Ne(t,a,i,s){switch(s.type){case n.ACHIEVEMENT:t=Ee(t,s),window.requestAnimationFrame(i.bind(null,t));break;case n.AZERITE_ESSENCE_POWER:let o=e.getEntity(s.type,s.fullId,s.dataEnv,s.locale);if(!(!s.params.spec||s.params.know&&s.params.know.length)){Ze.getSpellsBySpec(s.params.spec,(function(e){t=t.replace(/<!--embed:([^>]+)-->/g,(function(t,a){return WH2.setTooltipSpells(o.data.embeds[a].tooltip,e,o.data.embeds[a].spells)})),i(t)}));break}t=t.replace(/<!--embed:([^>]+)-->/g,(function(e,t){return WH2.setTooltipSpells(o.data.embeds[t].tooltip,s.params.know,o.data.embeds[t].spells)})),window.requestAnimationFrame(i.bind(null,t));break;case n.SPELL:if(s.params.spec&&(!s.params.know||!s.params.know.length)){Ze.getSpellsBySpec(s.params.spec,(function(e){t=WH2.setTooltipSpells(t,e,a),i(t)}));break}window.requestAnimationFrame(i.bind(null,t));break;default:window.requestAnimationFrame(i.bind(null,t))}}function De(e,a,n,i,s){if(!z.elements.tooltip){let e=Z();z.elements.icon=e.icon,z.elements.logo=e.logo;let t=e.tooltip;t.style.left=t.style.top="-2323px",z.elements.tooltip=t,z.elements.tooltipTable=WH2.gE(t,"table")[0],z.elements.tooltipTd=WH2.gE(t,"td")[0];let a=Z(void 0,!0).tooltip;a.style.left=a.style.top="-2323px",z.elements.tooltip2=a,z.elements.tooltipTable2=WH2.gE(a,"table")[0],z.elements.tooltipTd2=WH2.gE(a,"td")[0]}K(z.elements.tooltip,e,a,s),K(z.elements.tooltip2,e,a,s);let o=!0===n?"fixed":"absolute";z.elements.tooltip.style.position=o,z.elements.tooltip2.style.position=o;let r=i||document.fullscreenElement||document.body;WH2.ae(r,z.elements.tooltip),WH2.ae(r,z.elements.tooltip2);let l=t.getByEnv(e);l!==t.get()&&WH2.Fonts.load(l)}function Oe(){if(z.elements.screen)z.elements.screen.style.display="block";else{z.elements.screen=WH2.ce("div",{id:"wowhead-tooltip-screen",className:"wowhead-tooltip-screen"});let t=WH2.ce("a",{id:"wowhead-tooltip-screen-close",className:"wowhead-tooltip-screen-close",onclick:WH2.Tooltips.clearTouchTooltip});z.elements.screenInnerWrapper=WH2.ce("div",{id:"wowhead-tooltip-screen-inner-wrapper",className:"wowhead-tooltip-screen-inner-wrapper"});let a=WH2.ce("div",{id:"wowhead-tooltip-screen-inner",className:"wowhead-tooltip-screen-inner"});z.elements.screenInnerBox=WH2.ce("div",{id:"wowhead-tooltip-screen-inner-box",className:"wowhead-tooltip-screen-inner-box"}),z.elements.screenCaption=WH2.ce("div",{id:"wowhead-tooltip-screen-caption",className:"wowhead-tooltip-screen-caption"}),WH2.ae(z.elements.screen,t),WH2.ae(a,z.elements.screenInnerBox),WH2.ae(z.elements.screenInnerWrapper,a),WH2.ae(z.elements.screen,z.elements.screenInnerWrapper),WH2.ae(z.elements.screen,z.elements.screenCaption),WH2.ae(document.body,z.elements.screen),WH2.aE(z.elements.screenInnerWrapper,"click",(t=>{t.target.closest(".wowhead-tooltip")||e.clearTouchTooltip()}))}z.usingScreen=!0,function(){if(!z.mobileScrollInitialized){let e=function(e){z.usingScreen&&(document.getElementById("wowhead-tooltip-screen-inner").contains(e.target)||e.preventDefault())};WH2.aE(document.body,"touchmove",e),WH2.aE(document.body,"mousewheel",e),z.mobileScrollInitialized=!0}"function"==typeof IScroll&&setTimeout((function(){z.iScroll&&(z.iScroll.destroy(),z.iScroll=null),z.iScroll=new IScroll(z.elements.screenInnerWrapper,{mouseWheel:!0,tap:!0})}),1)}()}function Pe(e,t,a,n){if("string"==typeof(e="function"==typeof e?e.call(n.target,n):e)){void 0===t&&e.length<30&&(t=!0);let n=[];t&&n.push(' class="no-wrap"'),a&&!isNaN(a)&&n.push(' style="max-width:'+a+'px"'),n.length&&(e=`<div${n.join("")}>${e}</div>`)}return e}function xe(t,a,s,o,r,l){var c=ce(t,a,l);let d=e.getEntity(t,c,s,o);if(d.status!==O&&d.status!==x)return;d.status=P;var p=oe(t);if(p&&(parseInt(a,10)<p.min||parseInt(a,10)>p.max))return void e.register(t,a,s,o,{error:"ID is out of range"});r||(d.timer=setTimeout(Ke.bind(this,t,c,s,o),333));var u=[];for(var h in l)switch(h){case"spec":if(t===n.SPELL||t===n.AZERITE_ESSENCE_POWER)break;case"abil":case"affixes":case"alt":case"artk":case"awakened":case"azerite-essence-powers":case"azerite-powers":case"board":case"bonus":case"build":case"class":case"covenant":case"crafted-stats":case"crafting-quality":case"dd":case"ddsize":case"def":case"diff":case"diffnew":case"ench":case"gem1bonus":case"gem1lvl":case"gem2bonus":case"gem2lvl":case"gem3bonus":case"gem3lvl":case"gems":case"gender":case"glyph":case"greaterAffixes":case"ilvl":case"itemPower":case"itemType":case"level":case"lvl":case"masterworking":case"mod":case"mods":case"nlc":case"nodes":case"nomajor":case"pvp":case"q":case"rand":case"rank":case"rewards":case"sock":case"stars":case"tink":case"transmog":case"twcata":case"twmists":case"twtbc":case"twwod":case"twwotlk":case"upgrades":"object"==typeof l[h]?u.push(h+"="+l[h].join(":")):!0===l[h]?u.push(h):u.push(h+"="+l[h])}u.push("dataEnv="+s),u.push("locale="+o),s!==WH2.dataEnv.PTR&&s!==WH2.dataEnv.PTR2&&s!==WH2.dataEnv.BETA||"0"!==WH2.getDataCacheVersion(s)&&u.push(WH2.getDataCacheVersion(s)),Ze.isLoaded(t,s)||Ze.fetch(t,s),t===n.ITEM&&l&&l.hasOwnProperty("lvl")&&!Ze.isLoaded(n.SPELL,s)&&Ze.fetch(n.SPELL,s);let g=u.length?"?"+u.join("&"):"",f=(WH2.isDataEnvRestricted(WH2.getDataEnv())||WH2.isEntityRestricted(t)?We():We(i))+"/tooltip/"+le(t)+"/"+a+g;WH2.xhrJsonRequest(f,function(t,a,n,i,s,o){o?(o.error&&(G.includes(t)||WH2.error("Wowhead tooltip request responded with an error.",o.error,re(t)+" #"+a)),e.register(t,n,i,s,o)):WH2.error("Wowhead tooltips failed to load entity data.",re(t)+" #"+a)}.bind(null,t,a,c,s,o))}function ke(a,i,o){if(i&&a.dataset&&a.dataset.simpleTooltip)return $||a.onmouseout||("attach"!==a.dataset.tooltipMode&&(a.onmousemove=Ae),a.onmouseout=Le),$e(a,a.dataset.simpleTooltip.length<30?'<div class="no-wrap">'+a.dataset.simpleTooltip+"</div>":a.dataset.simpleTooltip),D;if("A"!==a.nodeName&&"AREA"!==a.nodeName)return M;var r=a.rel;try{a.dataset&&a.dataset.hasOwnProperty("wowhead")?r=a.dataset.wowhead:a.getAttribute&&a.getAttribute("data-wowhead")&&(r=a.getAttribute("data-wowhead"))}catch(e){}let l=a.href;if(!l.length&&!r||r&&/^np\b/.test(r)||"true"===a.getAttribute("data-disable-wowhead-tooltip")||$&&"true"===a.getAttribute("data-disable-wowhead-touch-tooltip"))return N;if(/(?:^|\.)wow(?:classic)?db\.com$/.test(new URL(l).hostname))return N;let c=l.match(/^https?:\/\/(?:[^/]+\.)?(classic|tbc)\.(?:[^/]+\.)?wowhead\.com\/talent-calc\/embed\/[^#]+/);if(c||(c=l.match(/^https?:\/\/(?:[^/]+\.)?wowhead\.com\/(classic|tbc|wotlk)\/talent-calc\/embed\/[^#]+/)),WH2.REMOTE&&c){let e=513,t=750;"tbc"===c[1]?e+=120:"wotlk"===c[1]&&(e+=517);let n=e/t*100+"%";return a.parentNode.replaceChild(WH2.ce("div",{style:{margin:"10px auto",maxHeight:e+"px",maxWidth:t+"px"},className:"wowhead-embed wowhead-embed-talent-calc"},WH2.ce("div",{style:{height:0,paddingTop:n,position:"relative",width:"100%"}},WH2.ce("iframe",{src:c[0],width:"100%",height:"100%",style:{border:0,left:0,position:"absolute",top:0,borderRadius:"6px"},sandbox:"allow-scripts allow-top-navigation"}))),a),D}let p=l.match(/^https?:\/\/(?:[^/]+\.)?wowhead\.com\/soulbind-calc\/embed\/.+/);if(WH2.REMOTE&&p)return a.parentNode.replaceChild(WH2.ce("div",{style:{maxWidth:"734px",maxHeight:"1060px",margin:"10px auto"},className:"wowhead-embed wowhead-embed-soulbind-calc"},WH2.ce("div",{style:{position:"relative",width:"100%",height:0,paddingTop:"144.5%"}},WH2.ce("iframe",{src:p[0],width:"100%",height:"100%",style:{border:0,left:0,position:"absolute",top:0,borderRadius:"6px"},sandbox:"allow-scripts allow-top-navigation"}))),a),D;if(WH2.REMOTE){let e=/^https?:\/\/(?:[^/]+\.)?wowhead\.com\/(?:(?:ptr|ptr-2|beta)\/)?(?:\w\w\/)?talent-calc\/embed\/.+/,t=l.match(e);if(t)return a.parentNode.replaceChild(WH2.ce("div",{style:{minHeight:"680px",position:"relative"},className:"wowhead-embed wowhead-embed-talent-calc"},WH2.ce("div",{style:{width:"100%",height:0,paddingTop:"calc(55.555% + 200px)"}},WH2.ce("iframe",{src:t[0],width:"100%",height:"100%",style:{border:0,left:0,position:"absolute",top:0,borderRadius:"6px"},sandbox:"allow-scripts allow-top-navigation"}))),a),D}let h=l.match(/^https?:\/\/(?:[^/]+\.)?wowhead\.com\/diablo-2\/skill-calc\/embed\/.+/);if(WH2.REMOTE&&h)return a.parentNode.replaceChild(WH2.ce("div",{style:{margin:"10px auto"},className:"wowhead-embed wowhead-embed-diablo-2-skill-calc"},WH2.ce("div",{style:{position:"relative",width:"100%",height:0,paddingTop:"50%"}},WH2.ce("iframe",{src:h[0],width:"100%",height:"100%",style:{border:0,left:0,position:"absolute",top:0,borderRadius:"6px"},sandbox:"allow-scripts allow-top-navigation"}))),a),D;let g,f,m,W,y={};if(z.show.params=y,l.startsWith("https://")||l.startsWith("http://")){let e=l.match(L);e||(e=l.match(C)),e?(g=e[1],f=e[2],m=e[3],W=l):R.some((e=>{let t=l.match(e.regexGuidePaths)||u[e.treeId].length&&(l.match(e.regexFrontPaths)||l.match(e.regexLegacyPaths));return t&&(g=(t[1]?t[1]+".":"")+WH2.getDataEnvKey(e.envId),f=(e.prefixedDetailPageNames.includes(t[2])?e.detailPagePrefix:"")+t[2],m=t[3],W=l),!!t})),z.show.hasLogo=!1}if(r&&(!f||/\bignore-url\b/.test(r))){let e=[];R.forEach((t=>{e=t.prefixedDetailPageNames.length?e.concat(t.prefixedDetailPageNames.map((e=>t.detailPagePrefix+e))):e.concat(u[t.treeId])})),e=[...new Set(e)];let t=r.match(new RegExp("("+e.join("|")+").?(-?\\d+(?:\\.\\d+)?)"));t&&(f=t[1],m=t[2]),z.show.hasLogo=!1}if(!f)return N;let w=b[f];if($&&!o&&!Se(w))return N;l.replace(_,((e,t,a)=>Me(y,t,a)||"")),r&&r.replace(_,((e,t,a)=>Me(y,t,a)||"")),z.element=a;let A=function(e,a){let n,i={dataEnv:WH2.getDataEnv(),locale:Locale.getId()};if(a?n=a.toLowerCase():e&&(n=e.toLowerCase().replace(/(?:^|\.)(staging|dev)$/,"")),void 0!==n){i.dataEnv=WH2.dataEnv.MAIN,i.locale=0;let e=n.split("."),a=WH2.getLocaleFromDomain.L[e[0]];a&&(i.locale=a,e.shift()),e[0]&&Object.values(WH2.dataEnv).some((a=>{if([WH2.dataEnvKey[a],t.getSelectorByDataEnv(a)].includes(e[0]))return i.dataEnv=a,!0}))}return WH2.isDataEnvActive(i.dataEnv)||(i.dataEnv=WH2.getRootEnv(i.dataEnv)),[WH2.dataEnv.BETA,WH2.dataEnv.PTR,WH2.dataEnv.PTR2].indexOf(i.dataEnv)>=0&&(i.locale=0),i}(g,y.domain),x=A.dataEnv,k=A.locale,U=WH2.Types.getRequiredTrees(w)||[];U.length&&!U.includes(WH2.getDataTree(x))&&(x=WH2.getRootByTree(U[0]));let G=t.getByEnv(x);if(G===t.WOW){if(y.gems&&y.gems.length>0){for(J=Math.min(3,y.gems.length-1);J>=0&&!parseInt(y.gems[J]);--J);0===++J?delete y.gems:J<y.gems.length&&(y.gems=y.gems.slice(0,J))}for(var q,Y=["bonus","gem1bonus","gem2bonus","gem3bonus"],K=0;q=Y[K];K++)if(y[q]&&y[q].length>0){for(J=Math.min(16,y[q].length-1);J>=0&&!parseInt(y[q][J]);--J);0===++J?delete y[q]:J<y[q].length&&(y[q]=y[q].slice(0,J))}if(y["crafted-stats"]&&y["crafted-stats"].length>0){let e=[];for(let t=0;t<Math.min(2,y["crafted-stats"].length);t++){let a=parseInt(y["crafted-stats"][t]);isNaN(a)||e.push(a)}0===e.length?delete y["crafted-stats"]:y["crafted-stats"]=e}if(y.abil&&y.abil.length>0){var V,Q=[];for(J=0;J<Math.min(8,y.abil.length);J++)(V=parseInt(y.abil[J]))&&Q.push(V);0===Q.length?delete y.abil:y.abil=Q}if(y.alt&&y.alt.length>0&&(y.alt=y.alt.map((e=>parseInt(e))).filter((e=>!isNaN(e))),0===y.alt.length&&delete y.alt),y.rewards&&y.rewards.length>0){var J;for(J=Math.min(3,y.rewards.length-1);J>=0&&!/^\d+.\d+$/.test(y.rewards[J]);--J);0===++J?delete y.rewards:J<y.rewards.length&&(y.rewards=y.rewards.slice(0,J))}}if(-1!==l.indexOf("#")&&-1!==document.location.href.indexOf(f+"="+m))return N;if(z.show.mode=H,$&&!a.dataset.noTouchLightbox&&document.documentElement.offsetWidth<s)z.show.mode=I;else if(["iconmedium","iconsmall","iconlarge","iconblizzard"].some((e=>a.parentNode?.classList.contains(e)))||"icon"===a.dataset.WH2attach||"icon"===a.dataset.tooltipMode)z.show.mode=S;else if($||"true"===a.dataset.WH2attach||"attach"===a.dataset.tooltipMode)z.show.mode=T;else if(!WH2.REMOTE)for(var X=a.parentNode,Z=0;X;){if(0===(X.getAttribute&&X.getAttribute("class")||"").indexOf("menu-inner")){z.show.mode=v;break}if(++Z>9)break;X=X.parentNode}if($||a.onmouseout||(z.show.mode===H&&(a.onmousemove=Ae),a.onmouseout=Le),z.show.mode===H&&"false"===a.dataset.WH2tticon&&(z.show.mode=E),WH2.REMOTE||a.WH2ContextMenuAttached||(a.WH2ContextMenuAttached=!0,WH2.aE(a,"contextmenu",be.bind(a,x,k,w,f,m,y,W))),i&&(z.initiatedByUser=!0,Xe(i),z.showingTooltip=!0,ee(w,m,x,k,y)),i||!he())return D;let ae=e.getEntity(w,ce(w,m,y),x,k);var ne=[];(ue("renameLinks")&&"false"!==a.getAttribute("data-wh-rename-link")||"true"===a.getAttribute("data-wh-rename-link"))&&ne.push((function(){delete a.dataset.WH2IconAdded,a.innerHTML="<span>"+ae.data.name+"</span>"}));var ie=a.getAttribute("data-wh-icon-size");let se=a.dataset.WH2IconizeLink;if(("true"===se||ie||ue("iconizeLinks"))&&"false"!==se&&d.includes(w)&&(ie||(ie=ue("iconSize")),ne.push((function(){te(ae.data)&&"true"!==a.dataset.WH2IconAdded&&Te(a,w,ae.data,ie)}))),ue("colorLinks"))switch(G){case t.D4:ne.push((()=>{null!=ae.data.quality&&j(a,["d4-q"+ae.data.quality])}));break;case t.DI:switch(w){case n.DI_EQUIP_ITEM:case n.DI_MISC_ITEM:ne.push((()=>{null!=ae.data.inventoryColor&&j(a,["di-ic"+ae.data.inventoryColor]),null!=ae.data.dropRank&&j(a,["q"+ae.data.dropRank])}));break;case n.DI_SET:ne.push((()=>{null!=ae.data.inventoryColor&&j(a,["di-ic"+ae.data.inventoryColor])}))}break;case t.WOW:ne.push((()=>{null!=ae.data.quality&&ae.data.quality>-1&&j(a,["q"+ae.data.quality])}))}if(ne.length)if(ae.status===O||ae.status===P)ae.callbacks=ae.callbacks.concat(ne),ae.status===O&&xe(w,m,x,k,!0,y);else if(ae.status===B||ae.status===F)for(;ne.length;)ne.shift()();return D}function Be(t,a,n,i){if(z.elements.tooltip.style.width="550px",z.elements.tooltip.style.left="-2323px",z.elements.tooltip.style.top="-2323px",z.elements.tooltip.className="wowhead-tooltip",t.nodeName?(WH2.ee(z.elements.tooltipTd),WH2.ae(z.elements.tooltipTd,t)):("wow"===z.elements.tooltip.dataset.game&&(t=e.evalFormulas(t)),z.elements.tooltipTd.innerHTML=t),z.elements.tooltip.style.display="",qe(z.elements.tooltip,!0),ae(z.elements.tooltip,!0),a?(z.showSecondary=!0,z.elements.tooltip2.style.width="550px",z.elements.tooltip2.style.left="-2323px",z.elements.tooltip2.style.top="-2323px",a.nodeName?(WH2.ee(z.elements.tooltipTd2),WH2.ae(z.elements.tooltipTd2,a)):z.elements.tooltipTd2.innerHTML=e.evalFormulas(a),z.elements.tooltip2.style.display="",ae(z.elements.tooltip2,!0)):z.showSecondary=!1,WH2.Device.isTouch()){let e=z.showSecondary?z.elements.tooltipTd2:z.elements.tooltipTd,t=WH2.ce("a");t.href="javascript:",t.className="wowhead-touch-tooltip-closer",t.onclick=WH2.Tooltips.clearTouchTooltip,WH2.ae(e,t)}z.elements.tooltipTable.style.display=""==t?"none":"",function(e,t){WH2.qsa(":scope > .image",z.elements.tooltipTable.parentNode).forEach((e=>WH2.de(e)));let a=typeof e;if("number"===a){let t=WH2.getDataSource(),a=e;if(!t[a]||!t[a]["image_"+Locale.getName()])return;e=t[a]["image_"+Locale.getName()]}else if("string"!==a||!e)return;let n=WH2.ce("div",{className:"image"+(t?" "+t:""),style:{backgroundImage:"url("+e+")"}});z.elements.tooltipTable.parentNode.insertBefore(n,z.elements.tooltipTable.nextSibling)}(n,i),ie("show")}function Fe(e,t,a){Ge(z.elements.icon,e?{icon:e}:void 0,t,a)}function Ue(e){let t;!1!==e.showIcon&&(te(e.entity)?t=e.entity:e.iconName&&(t={icon:e.iconName})),Ge(z.elements.icon,t,e.type,e.dataEnv)}function Ge(e,t,a,n){WH2.ee(e),p[a]?.embeddedIcons&&(t=void 0),te(t)?(WH2.ae(e,WH2.Icon.createByEntity(t,a,null,{dataEnv:n,size:WH2.Icon.MEDIUM})),e.style.visibility="visible",z.showIcon=!0):(e.style.visibility="hidden",z.showIcon=!1)}function qe(e,t){t?(e.setAttribute("data-visible","yes"),e.style.visibility="visible"):(e.setAttribute("data-visible","no"),e.style.visibility="hidden")}function $e(e,t,a,n){if(null==t||!z.enabled)return;(!(n=n||{}).padX||n.padX<1)&&(n.padX=1),(!n.padY||n.padY<1)&&(n.padY=1),a&&(t=Je(t,a));let i=e.getBoundingClientRect();De(n.dataEnv,n.type,WH2.isElementPositionFixedOrSticky(e),void 0,n.status),Ue(n),Be(t,n.finalContent2,n.image,n.imageClass),ye(i.left+window.scrollX,i.top+window.scrollY,i.width,i.height,n.padX,n.padY)}function ze(e,t,a,n){null!=t&&z.enabled&&((!(n=n||{}).padX||n.padX<10)&&(n.padX=10),(!n.padY||n.padY<10)&&(n.padY=10),a&&(t=Je(t,a),n.finalContent2&&(n.finalContent2=Je(n.finalContent2,a))),De(n.dataEnv,n.type,e.target&&WH2.isElementPositionFixedOrSticky(e.target),void 0,n.status),Ue(n),Be(t,n.finalContent2,n.image,n.imageClass),ye(e.pageX,e.pageY,0,0,n.padX||0,n.padY||0))}function je(e,t,a,n){null!=e&&z.enabled&&(De((n=n||{}).dataEnv,n.type,n.fixedPosition,void 0,n.status),Ue(n),Be(e,n.finalContent2,n.image,n.imageClass),ye(t,a,0,0,n.padX||0,n.padY||0))}function Ye(e,t,a){if(WH2.Tooltips.clearTouchTooltip(!0),null==t||!z.enabled)return;a=a||{},Oe(),WH2.ee(z.elements.screenCaption);let n=WH2.ce("a",{innerHTML:WH2.isRemote()?"Tap Link":WH2.TERMS.taplink,onclick:function(e,t){if(e.setAttribute("data-disable-wowhead-tooltip","true"),e.fireEvent)e.fireEvent("on"+t);else if("function"==typeof MouseEvent)e.dispatchEvent(new MouseEvent(t,{bubbles:!0,cancelable:!0}));else{let a=document.createEvent("Events");a.initEvent(t,!0,!0),e.dispatchEvent(a)}e&&e.removeAttribute("data-disable-wowhead-tooltip"),WH2.Tooltips.clearTouchTooltip()}.bind(null,e,"click")}),i=WH2.ce("i",{className:"fa fa-hand-o-up"});WH2.aef(n,i),WH2.ae(z.elements.screenCaption,n),De(a.dataEnv,a.type,!1,z.elements.screenInnerBox,a.status),Ue(a),Be(t,a.finalContent2,a.image,a.imageClass),ye()}function Ke(t,a,n,i){if(z.show.type===t&&z.show.fullId===a&&z.show.dataEnv===n&&z.show.locale===i){Ve(P,i,pe(i,"loading")),e.getEntity(t,a,n,i).timer=setTimeout(Ie.bind(this,t,a,n,i),3850)}}function Ve(t,i,s,o,d,p,u,h,g,f){if(ve(),!z.initiatedByUser)return;if(z.element&&(z.element._fixTooltip&&(s=z.element._fixTooltip(s,z.show.type,z.show.fullId,z.element)),z.element._fixTooltip2&&(h=z.element._fixTooltip2(h,z.show.type,z.show.fullId,z.element))),s){if(z.show.params){let e=z.show.params;if(e.forg&&(s=Y(s,e.forg)),e.spec&&(s=WH2.Tooltips.parseItemEffectTooltipForSpec(s,e.spec)),e.pcs&&e.pcs.length){for(var W=0,H=0,y=e.pcs.length;H<y;++H){var _,b=new RegExp("<span>\x3c!--si([0-9]+:)*"+e.pcs[H]+'(:[0-9]+)*--\x3e<a href="[^"]*?/item=(\\d+)[^"]*">(.+?)</a></span>');if(_=s.match(b)){let t=isNaN(parseInt(z.show.locale))?"enus":m[z.show.locale];var w=WH2.isSet("g_items")&&g_items[e.pcs[H]]?g_items[e.pcs[H]]["name_"+t]:_[4];var A='<a href="'+(WH2.REMOTE?"javascript:":WH2.Entity.getUrl(WH2.Types.ITEM,_[3]))+'">'+w+"</a>",L='<span class="q13">\x3c!--si'+e.pcs[H]+"--\x3e"+A+"</span>";s=s.replace(_[0],L),++W}}W>0&&(s=(s=s.replace("(0/","("+W+"/")).replace(new RegExp("<span>\\(([0-"+W+"])\\)","g"),'<span class="q2">($1)'))}e.lvl&&!e.ilvl&&(s=WH2.setTooltipLevel(s,e.lvl?e.lvl:WH2.getWowMaxLevel(),e.buff));let t=[];if(e.know&&(t=t.concat(e.know)),e.spellModifier&&(t=t.concat(e.spellModifier)),e.covenant&&t.push(r[e.covenant]),s=WH2.setTooltipSpells(s,t,u),e.WH2o&&e.WH2en&&(s=(s=s.replace("<table><tr><td><br />",'<table><tr><td><br /><span class="q2">'+WH2.sprintf(pe(i,"achievementComplete"),e.WH2o,e.WH2en.getMonth()+1,e.WH2en.getDate(),e.WH2en.getFullYear())+"</span><br /><br />")).replace(/class="q0"/g,'class="r3"')),e.notip&&g&&(s="",d=void 0),z.show.type===n.BATTLE_PET_ABILITY&&e.pwr&&(s=s.replace(/<!--sca-->(\d+)<!--sca-->/g,(function(t,a){return Math.floor(parseInt(a)*(1+.05*e.pwr))}))),z.show.type===n.ACHIEVEMENT&&e.cri)for(H=0;H<e.cri.length;H++)s=s.replace(new RegExp("\x3c!--cr"+parseInt(e.cri[H])+":[^<]+","g"),'<span class="q2">$&</span>')}}else s=pe(i,"notFound").replace("%s",re(z.show.type)),t=k,d=a.UNKNOWN;if(z.showCharacterCompletion&&window.g_user&&(WH2.isRetailTree(z.show.dataEnv)&&g_user.lists||!WH2.isRetailTree(z.show.dataEnv)&&g_user.characterProfiles&&g_user.characterProfiles.length)){var C="";let a=!!WH2.isRetailTree(z.show.dataEnv)&&WH2.User.Completion.getByType(z.show.type),i=e.getEntity(z.show.type,z.show.fullId,z.show.dataEnv,z.show.locale);a&&z.show.type===n.QUEST&&(t!==B||i.worldquesttype||i.daily||i.weekly)&&(a=!1);let o=!(a&&z.show.type in g_completion_categories&&-1===WH2.inArray(g_completion_categories[z.show.type],i.completion_category)),r=/^-?\d+(?:\.\d+)?/.exec(z.show.fullId);if(r=r&&r.length?r[0]:z.show.fullId,a)for(var R in g_user.lists){var M=g_user.lists[R];if(!(M.id in a))continue;let e=-1!==WH2.inArray(a[M.id],r);(e||o)&&(C+='<br><span class="progress-icon '+(e?"progress-8":"progress-0")+'"></span> ',C+=M.character+" - "+M.realm+" "+M.region)}if(z.show.type===n.ACHIEVEMENT&&(s=Ee(s,z.show)),!WH2.isRetailTree(z.show.dataEnv)&&z.show.type===n.QUEST){var N;for(H=0;N=g_user.characterProfiles[H];H++){let e=-1!==WH2.inArray(N.quests,r);(e||o)&&(C+='<br><span class="progress-icon '+(e?"progress-8":"progress-0"),C+='"></span> '+N.name+" - "+N.realm)}}WH2.isRetailTree(z.show.dataEnv)&&z.show.type===n.TRANSMOG_SET&&(g_user.lists||[]).forEach((function(e){let t=WH2.Wow.TransmogSet.getCompletionAmount(i.data.completionData||{},e.id);t>0&&(C+='<br><span class="progress-icon progress-'+Math.max(1,Math.floor(8*t))+'"></span> ',C+=e.character+" - "+e.realm+" "+e.region)})),""!==C&&(s+='<br><span class="q">'+WH2.TERMS.completion+":</span>"+C)}if(!WH2.REMOTE&&[n.TRANSMOG_SET,n.ITEM_SET].includes(z.show.type)&&void 0!==WH2.getPreferredTransmogRace){let e=WH2.getPreferredTransmogRace(),t=e.race,a=e.gender-1,i=WH2.ce("div",{innerHTML:s}),o=WH2.qs("picture",i);if(o){o.dataset.requiredRace&&!z.element.dataset.tooltipIgnoreRequiredRace&&(t=o.dataset.requiredRace);let e=z.show.type===n.ITEM_SET?WH2.Wow.ItemSet:WH2.Wow.TransmogSet;o.parentNode.replaceChild(WH2.ce("img",{src:e.getThumbUrl(z.show.fullId,t,a,z.show.dataEnv),width:260,height:440,style:{display:"block",margin:"0 auto"}}),o),s=i.innerHTML}}!WH2.REMOTE&&s&&(z.show.params.diff||z.show.params.diffnew||z.show.params.noimage)&&(g="",f=""),s=s.replace("http://","https://"),z.show.params.map&&p&&p.getMap&&(h=p.getMap());let D={type:z.show.type,fullId:z.show.fullId,dataEnv:z.show.dataEnv,locale:z.show.locale,params:z.show.params};Ne(s,u,function(e,t,a){if(z.show.type===t.type&&z.show.fullId===t.fullId&&z.show.dataEnv===t.dataEnv&&z.show.locale===t.locale&&z.show.params===t.params){switch(z.show.mode){case I:Ye(z.element,a,{dataEnv:t.dataEnv,entity:o,iconName:d,image:g,imageClass:f,showIcon:!1,status:e,finalContent2:h,type:t.type});break;case S:$e(z.element,a,void 0,{dataEnv:t.dataEnv,entity:o,image:g,imageClass:f,showIcon:!1,status:e,finalContent2:h,type:t.type});break;case T:$e(z.element,a,void 0,{dataEnv:t.dataEnv,entity:o,iconName:d,image:g,imageClass:f,showIcon:!1,status:e,finalContent2:h,type:t.type});break;case v:$e(z.element,a,void 0,{dataEnv:t.dataEnv,entity:o,iconName:d,showIcon:!1,finalContent2:h,type:t.type});break;case E:je(a,z.cursorX,z.cursorY,{dataEnv:t.dataEnv,entity:o,fixedPosition:WH2.isElementPositionFixedOrSticky(z.element),image:g,imageClass:f,padX:l,padY:c,showIcon:!1,status:e,finalContent2:h,type:t.type});break;default:je(a,z.cursorX,z.cursorY,{dataEnv:t.dataEnv,entity:o,fixedPosition:WH2.isElementPositionFixedOrSticky(z.element),iconName:d,image:g,imageClass:f,padX:l,padY:c,showIcon:!1,status:e,finalContent2:h,type:t.type})}WH2.REMOTE&&z.elements.logo&&(z.elements.logo.style.display=z.show.hasLogo?"block":"none")}}.bind(this,t,D),D)}function Qe(){let t=e.getEntity(z.show.type,z.show.fullId,z.show.dataEnv,z.show.locale);if(G.includes(z.show.type)&&!t.data[me()])return void Le();let a=t.data[function(e){return void 0===e?"image_NONE":"image"+e}(z.show.params.image)],n=t.data["image"+z.show.params.image+"_class"],i=de(z.show.type,z.show.fullId,z.show.dataEnv);i&&(a=i[0],n=i[1]),Ve(t.status,z.show.locale,t.data[me()],t.data,t.data[z.show.params&&z.show.params.text?"text_icon":"icon"],t.data.map,t.data[fe()],t.data[me(2)],a,n)}function Je(e,t){let a=WH2.ce("div",{className:t});return"string"==typeof e?a.innerHTML=e:WH2.ae(a,e),a}function Xe(e){z.cursorX=e.pageX,z.cursorY=e.pageY}this.attachTouchTooltips=function(e){$&&e&&1===e.nodeType&&J(e)},this.clearTouchTooltip=function(e){z.touchElement&&(!0!==e&&z.touchElement.removeAttribute("data-showing-touch-tooltip"),z.touchElement.hasWHTouchTooltip=!1),z.touchElement=void 0,!0!==e&&WH2.qsa("[data-showing-touch-tooltip]").forEach((function(e){delete e.dataset.showingTouchTooltip})),z.elements.screen&&(z.elements.screenInnerWrapper.scrollTop=0,z.elements.screenInnerWrapper.scrollLeft=0,z.elements.screen.style.display="none",z.usingScreen=!1);let t=!0===e&&z.showingTooltip;He(),z.showingTooltip=t},this.evalFormulas=function(e,t=0){if("string"!=typeof e)return e;e=e.replace(/<span class="wh-tooltip-formula" style="display:none">(\[[\w\W]*?\])<\/span>(?:\d+(?:\.\d+)?)?/g,"$1");let a=0,n=0,i="",s=0;for(let o=0;o<e.length;o++){let r=e.substr(o,1);switch(r){case"[":a++,n=0,i="";break;case"]":a--,a<0&&(a=0),n=0,i="";break;case"(":if(a>0)break;i+=r,n++;break;case")":if(a>0)break;n>0&&(i+=r,n--);break;default:0==a&&n>0&&(i+=r)}if(0==a&&0==n&&i){if(s=o-i.length+1,/[^ ()0-9\+\*\/\.\-\%]/.test(i.replace(/<!--[\w\W]*?-->/g,"").replace(/\b(floor|ceil|abs)\b/gi,""))){i="";continue}if(/^\([0-9\.]*\)$/.test(i)){i="";continue}if(!/<!--[\w\W]*?-->/g.test(i)){i="";continue}e=e.substr(0,s)+(0===t?"[":"(")+e.substring(s,o+1)+(0===t?"]":")")+e.substr(o+1),o+=2,i=""}}return e=e.replace(/\[([^\]]+)\]/g,(function(e,t){let a;t=(t=(t=(t=t.replace(/<!--[\w\W]*?-->/g,"")).replace(/\b(floor|ceil|abs)\b/gi,"Math.$1")).replace(/&lt;/g,"<")).replace(/&gt;/g,">");try{a=Function('"use strict";return ('+t+")")()}catch(e){a=void 0}return void 0===a?e:'<span class="wh-tooltip-formula" style="display:none">'+e+"</span>"+Math.abs(a).toFixed(3).replace(/0+$/,"").replace(/\.$/,"")})),e},this.getEntity=function(e,t,a,n){void 0===n&&(n=Locale.getId()),a||(a=WH2.getDataEnv());var i=function(e){if("object"!=typeof p[e])throw new Error("Wowhead tooltips could not find config for entity type ["+e+"].");return p[e].data}(e);return i[t]=i[t]||{},i[t][a]=i[t][a]||{},i[t][a][n]=i[t][a][n]||{status:O,callbacks:[],data:{}},i[t][a][n]},this.init=function(){V(),we((function(){if(ue("renameLinks")||ue("colorLinks")||ue("iconizeLinks")||ue("iconSize")){let e=se();for(let t=0;t<e.length;t++)ke(e[t]);ve()}else if(document.querySelectorAll){let e=['a[href*="wowhead.com/talent-calc/embed/"]','a[href*="wowhead.com/soulbind-calc/embed/"]','a[href*="wowhead.com/diablo-2/skill-calc/embed/"]'].join(","),t=document.querySelectorAll(e);for(let e=0;e<t.length;e++)ke(t[e])}}))},this.onScalesAvailable=function(e,t,a){Ze.registerCallback(e,t,a)},this.parseItemEffectTooltipForSpec=(e,t)=>e.replace(/<!--itemeffectspec(\d+):0--><span(?: hidden.*?)?>(.*?)<\/span><!--itemeffectspec-->(<br>|<br \/>|<\/span>)?/g,(function(e,a,n,i){let s=`\x3c!--itemeffectspec${a=parseInt(a)}:0--\x3e<span`;return a===t?"</span>"!==i&&(i="<br>"):(s+=" hidden","</span>"!==i&&(i="")),s+=`>${n}</span>\x3c!--itemeffectspec--\x3e${i}`,s})),this.refreshLinks=function(e){if(!0===e||ue("renameLinks")||ue("colorLinks")||ue("iconizeLinks")){let e=se();for(let n,i=0;n=e[i];i++){for(var t=n.parentNode,a=!1;null!=t;){if((" "+(t.getAttribute&&t.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" wowhead-tooltip ")>-1){a=!0;break}t=t.parentNode}a||(ke(n),$&&Q(n))}}He()},this.register=function(t,a,i,s,o){let r=this.getEntity(t,a,i,s);{let a=o.additionalIds||[];delete o.additionalIds,a.forEach((a=>e.register(t,a,i,s,o)))}if(!Ze.isLoaded(t,i))return r.status=F,void Ze.registerCallback(t,i,e.register.bind(this,t,a,i,s,o));if("string"==typeof a&&(0===a.indexOf("lvl")||a.match(/[^i]lvl/))&&!Ze.isLoaded(n.SPELL,i))return r.status=F,void Ze.registerCallback(n.SPELL,i,e.register.bind(this,t,a,i,s,o));for(var l in r.timer&&(clearTimeout(r.timer),delete r.timer),!WH2.REMOTE&&o.map&&(r.data.map||(r.data.map=new Mapper({parent:WH2.ce("div"),zoom:3,zoomable:!1,buttons:!1})),r.data.map.update(o.map),delete o.map),o)o.hasOwnProperty(l)&&(r.data[l]=o[l]);switch(r.status){case P:case F:case x:case O:r.data[me()]?r.status=B:r.status=k}for(z.showingTooltip&&z.show.type===t&&z.show.fullId===a&&z.show.dataEnv===i&&z.show.locale===s&&Qe();r.callbacks.length;)r.callbacks.shift()()},this.replaceWithTooltip=function(a,n,i,s,o,r,l){if(r=r||{},void 0===o&&(o=Locale.getId()),s||(s=WH2.getDataEnv()),"string"==typeof a&&(a=document.getElementById(a)),!a)return!1;var c=ce(n,i,r),d=this.getEntity(n,c,s,o);switch(d.status){case B:if(!a.parentNode)return!0;for(;a.hasChildNodes();)a.removeChild(a.firstChild);var u=["wowhead-tooltip-inline"];!p[n].embeddedIcons&&te(d.data)&&u.push("wowhead-tooltip-inline-icon"),j(a,u);let h=t.getByEnv(s);h!==t.get()&&WH2.Fonts.load(h);let g=function(i){"function"==typeof l&&(i=l(i,d)),h===t.WOW&&(r.forg&&(i=Y(i,r.forg)),i=e.evalFormulas(i)),i&&function(e,t,a,n,i){let s=Z(a),o=s.tooltip;K(o,n,i),Ge(s.icon,t,i,n),WH2.ae(e,o),ne(o)}(a,d.data,i,s,n)};return Ne(d.data[me()],d.data[fe()],g,{type:n,fullId:c,dataEnv:s,locale:o,params:r}),!0;case P:case O:return d.callbacks.push(this.replaceWithTooltip.bind(this,a,n,i,s,o,r,l)),this.request(n,i,s,o,r),!0}return!1},this.request=function(e,t,a,n,i){i=i||{},void 0===n&&(n=Locale.getId()),a||(a=WH2.getDataEnv());var s=ce(e,t,i);this.getEntity(e,s,a,n),xe(e,t,a,n,!0,i)},this.setScales=function(e,t,a){Ze.setData(e,t,a)},this.triggerTooltip=function(e,t){ke(e,t||{target:e},!0)},WH2.REMOTE||(this.addText=function(e,t,a){e?e._fixTooltip=function(e,t,a,n){let i=/<\/table>\s*$/,s="function"==typeof a?a():a,o=a?' class="'+s+'"':"",r="function"==typeof t?t():t;return i.test(n)?n.replace(i,'<tr><td colspan="2"><div'+o+' style="margin-top: 10px">'+r+"</div></td></tr></table>"):n+"<div"+o+' style="margin-top: 10px">'+r+"</div>"}.bind(null,e,t,a):WH2.error("Tooltip text addition element not found!",e,t,a)},this.attach=function(t,a,n,i){if(i=i||{},t instanceof jQuery){for(let s,o=0;s=t[o];o++)e.attach(s,a,n,i);return}let s={dataEnv:i.dataEnv,type:i.type,iconName:i.iconName},o=i.stopPropagation?e=>e.stopPropagation():()=>{};i.byCursor?(t.onmouseover=e=>{ze(e,Pe(a,i.noWrap,i.maxWidth,e),n,s),o(e)},t.onmousemove=e.cursorUpdate):t.onmouseover=e=>{let r=Pe(a,i.noWrap,i.maxWidth,e);$e(t,r,n,s),o(e)},t.onmouseout=He},this.attachNonTouch=function(t,a,n,i){WH2.Device.isTouch()||e.attach(t,a,n,i)},this.cursorUpdate=function(e,t,a){z.enabled&&z.elements.tooltip&&((!t||t<10)&&(t=10),(!a||a<10)&&(a=10),ye(e.pageX,e.pageY,0,0,t,a))},this.disableCompletion=function(){z.showCharacterCompletion=!1},this.getScalingData=(e,t)=>Ze.getDataByKey(e,t),this.getScreenshotsEnabled=()=>z.showScreenshots,this.getTd=()=>z.elements.tooltipTd,this.isTypeSupported=e=>p.hasOwnProperty(e),this.isVisible=function(){return z.showingTooltip||z.elements.tooltip&&WH2.DOM.isVisible(z.elements.tooltip)},this.on=(e,t)=>{z.elements.tooltip||De(),WH2.aE(z.elements.tooltip,e,t)},this.relToParams=e=>{let t={};return e.forEach((e=>e.replace(_,((e,a,n)=>Me(t,a,n)||"")))),t},this.setEnabled=e=>z.enabled=e,this.setScreenshotsEnabled=e=>z.showScreenshots=e,this.showFadingTooltipAtCursor=function(e,t,a,n,i){ze(t,e=Pe(e,n,i,t),a),requestAnimationFrame((function(){z.elements.tooltip.classList.add("fade-out")}))},this.titlesToTooltips=function(t,a){"string"==typeof t&&(t=WH2.qsa(t)),t.forEach((t=>{e.attach(t,t.title,"q",{noWrap:!0}),t.removeAttribute("title"),a||t.classList.add("tip")}))},this.finalizeSizeAndReveal=ne,this.hide=He,this.prepare=De,this.prepareContent=Pe,this.setIcon=Fe,this.show=$e,this.showAtCursor=ze,this.showAtPoint=je,this.showInScreen=Ye),window.Locale=window.Locale||{getId:function(){return 0},getName:function(){return"enus"}};let Ze=new function(){const e=this;let t={loadedData:{}};var a={},s={},o={},r={};function l(){let e=z.show.dataEnv||WH2.getDataEnv(),a=o[n.ITEM][e];a&&(t.loadedData[n.ITEM]=a,WH2.staminaFactor=a.staminaByIlvl,WH2.convertRatingToPercent.RM=a.ratingsToPercentRM,WH2.convertRatingToPercent.LT=a.ratingsToPercentLT,WH2.convertScalingFactor.SV=a.itemScalingValue,WH2.convertScalingFactor.SD=a.scalingFactors,WH2.curvePoints=a.curvePoints,WH2.applyStatModifications.ScalingData=a.scalingData,WH2.contentTuningLevels=a.contentTuningLevels,WH2.reforgeStats=a.reforgeStats??{},Object.values(WH2.reforgeStats).forEach((e=>{e.s1=WH2.statToJson[e.i1],e.s2=WH2.statToJson[e.i2]})));let i=o[n.SPELL][e];i&&(t.loadedData[n.SPELL]=i,WH2.convertScalingSpell.SV=i.scalingValue,WH2.convertScalingSpell.SpellInformation=i.spellInformation,WH2.convertScalingSpell.RandPropPoints=i.randPropPoints)}this.fetch=function(e,t){if(!r.hasOwnProperty(e)||r[e].hasOwnProperty(t))return;let n;r[e][t]=P,a[e][t]=[],n=WH2.REMOTE?We(i)+s[e]+`&dataEnv=${t}`:WH2.Url.getDataPageUrl(s[e].replace("/data/",""),t),n+="&json",WH2.xhrJsonRequest(n,function(e,t,a){a?Ze.setData(e,t,a):WH2.error("Wowhead tooltips failed to load entity scaling data.",re(e))}.bind(null,e,t))},this.getDataByKey=(e,a)=>(t.loadedData[e]||{})[a],this.getSpellsBySpec=function(e,t){let a=z.show.dataEnv||WH2.getDataEnv();this.registerCallback(n.PLAYER_CLASS,a,(function(){var i=o[n.PLAYER_CLASS][a],s=[];i.specMap.hasOwnProperty(e)&&(s=i.class[i.specMap[e]].concat(i.spec[e]||[])),t(s)}))},this.isLoaded=function(e,t){return!r.hasOwnProperty(e)||r[e][t]===B&&(l(),!0)},this.registerCallback=function(t,n,i){e.isLoaded(t,n)?window.requestAnimationFrame(i):(a[t].hasOwnProperty(n)||e.fetch(t,n),a[t][n].push(i))},this.setData=function(e,t,n){r[e][t]=B,a[e][t]=a[e][t]||[],o[e][t]=n,l();let i=a[e][t];for(;i.length;)i.shift()()},function(){for(var e in s[n.ITEM]="/data/item-scaling",s[n.SPELL]="/data/spell-scaling",s[n.PLAYER_CLASS]="/data/spec-spells",s)s.hasOwnProperty(e)&&(r[e]={},a[e]={},o[e]={})}()};WH2.REMOTE?(WH2.ae(document.head,WH2.ce("link",{type:"text/css",href:WH2.STATIC_URL+"/css/universal.css?19",rel:"stylesheet"})),e.init()):(V(),we((function(){Ze.fetch(n.ITEM,WH2.getDataEnv()),Ze.fetch(n.SPELL,WH2.getDataEnv())})))},window.$WowheadPower=new function(){WH2.REMOTE||(this.attachTouchTooltips=WH2.Tooltips.attachTouchTooltips,this.disableCompletion=WH2.Tooltips.disableCompletion,this.onScalesAvailable=WH2.Tooltips.onScalesAvailable,this.replaceWithTooltip=WH2.Tooltips.replaceWithTooltip,this.request=WH2.Tooltips.request,this.triggerTooltip=WH2.Tooltips.triggerTooltip,this.getEntity=WH2.Tooltips.getEntity,this.register=WH2.Tooltips.register),this.refreshLinks=WH2.Tooltips.refreshLinks,this.setScales=WH2.Tooltips.setScales},WH2.Tooltip=new function(){WH2.REMOTE||(this.addTooltipText=WH2.Tooltips.addText,this.cursorUpdate=WH2.Tooltips.cursorUpdate,this.isVisible=WH2.Tooltips.isVisible,this.showFadingTooltipAtCursor=WH2.Tooltips.showFadingTooltipAtCursor,this.simple=WH2.Tooltips.attach,this.simpleNonTouch=WH2.Tooltips.attachNonTouch,this.finalizeSizeAndReveal=WH2.Tooltips.finalizeSizeAndReveal,this.hide=WH2.Tooltips.hide,this.prepare=WH2.Tooltips.prepare,this.setIcon=WH2.Tooltips.setIcon,this.show=WH2.Tooltips.show,this.showAtCursor=WH2.Tooltips.showAtCursor,this.showAtPoint=WH2.Tooltips.showAtPoint,this.showInScreen=WH2.Tooltips.showInScreen)},WH2.WebP=new function(){const e=this;var t=10,a={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};this.feature=Object.freeze({lossy:"lossy",lossless:"lossless",alpha:"alpha",animation:"animation"});const n={bodyFrameWaitCount:0,supports:{lossy:void 0,lossless:void 0,alpha:void 0,animation:void 0}};function i(e){if(!document.body)return n.bodyFrameWaitCount>t?void window.addEventListener("DOMContentLoaded",i.bind(this,e)):(n.bodyFrameWaitCount++,void requestAnimationFrame(i.bind(this,e)));document.body.classList.add(e?"webp":"no-webp"),document.body.dataset.WH2Webp=JSON.stringify(e)}this.getImageExtension=function(){return n.supports.alpha?".webp":".png"},this.supportsFeature=function(e,t){if("boolean"!=typeof n.supports[e]){var i=new Image;i.onload=function(){var a=i.width>0&&i.height>0;n.supports[e]=a,t(e,a)},i.onerror=function(){n.supports[e]=!1,t(e,!1)},i.src="data:image/webp;base64,"+a[e]}else requestAnimationFrame((function(){t(e,n.supports[e])}))},e.supportsFeature(e.feature.alpha,(function(e,t){i(t)}))},WH2.DI.GeneralItem=new function(){this.GRID_TYPE_1x1=1,this.GRID_TYPE_2x1=2},WH2.DI.UiImage=function(e){const t=this,a=WH2.WebP,n="/di/ui/",i={baseName:""};this.getBaseName=function(){return i.baseName},this.getSubDirectory=function(){let e="",t=i.baseName.split("_");for(;t.length>1;){let a=t.shift();if(/\d/.test(a))break;e+=a+"/"}return e},this.getUrl=e=>{let i=[n,t.getSubDirectory(),t.getBaseName(),a.getImageExtension()].join("");return e?WH2.Url.generatePrivate(i):`${WH2.STATIC_URL}${i}`},function(e){i.baseName=e}.apply(this,arguments)};