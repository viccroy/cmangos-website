(()=>{var t={287:()=>{var t,e;window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)},jQuery.support.cors=!0,$.ajaxTransport?($.ajaxSetup({flatOptions:{renderer:!0}}),$.ajaxTransport("+binary",(function(t,e,i){if(window.FormData&&(t.dataType&&"binary"==t.dataType||t.data&&(window.ArrayBuffer&&t.data instanceof ArrayBuffer||window.Blob&&t.data instanceof Blob)))return{send:function(e,i){var r=new XMLHttpRequest,s=t.url,n=t.type,a=t.responseType||"blob",o=t.data||null;t.renderer&&r.addEventListener("progress",(function(e){e.lengthComputable&&(t.renderer.downloads[this.responseURL]?t.renderer.downloads[this.responseURL].loaded=e.loaded:t.renderer.downloads[this.responseURL]={loaded:e.loaded,total:e.total},t.renderer.updateProgress())})),r.addEventListener("load",(function(){t.renderer&&(delete t.renderer.downloads[this.responseURL],t.renderer.updateProgress());var e={};e[t.dataType]=r.response,i(r.status,r.statusText,e,r.getAllResponseHeaders())})),r.open(n,s,!0),r.responseType=a,r.send(o)},abort:function(){i.abort()}}}))):(t=$.httpData,$.httpData=function(e,i,r){return"binary"==i?e.response:t(e,i,r)},$.ajaxSetup({beforeSend:function(t,e){"binary"==e.dataType&&(t.responseType=e.responseType||"arraybuffer",t.addEventListener("progress",(function(t){e.renderer&&t.lengthComputable&&(e.renderer.downloads[this.responseURL]?e.renderer.downloads[this.responseURL].loaded=t.loaded:e.renderer.downloads[this.responseURL]={loaded:t.loaded,total:t.total},e.renderer.updateProgress())}),!1),t.addEventListener("load",(function(){e.renderer&&(delete e.renderer.downloads[this.responseURL],e.renderer.updateProgress())}),!1))}})),Math.randomInt=Math.randomInt||function(t,e){return Math.floor(Math.random()*(e-t))+t},"function"!=typeof Object.create&&(Object.create=(e=function(){},function(t){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof t)throw TypeError("Argument must be an object");e.prototype=t;var i=new e;return e.prototype=null,i})),window.console=window.console||{log:function(){},error:function(){},warn:function(){}}}},e={};function i(r){var s=e[r];if(void 0!==s)return s.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,i),n.exports}(()=>{"use strict";i(287);let t=Float32Array;function e(e,i,r){const s=new t(3);return e&&(s[0]=e),i&&(s[1]=i),r&&(s[2]=r),s}function r(e,i,r){return(r=r||new t(3))[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r}function s(e,i,r){return(r=r||new t(3))[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r}let n=Float32Array;function a(t){return(t=t||new n(16))[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,i,r){r=r||e();const s=i[0],n=i[1],a=i[2],o=s*t[3]+n*t[7]+a*t[11]+t[15];return r[0]=(s*t[0]+n*t[4]+a*t[8]+t[12])/o,r[1]=(s*t[1]+n*t[5]+a*t[9]+t[13])/o,r[2]=(s*t[2]+n*t[6]+a*t[10]+t[14])/o,r}function h(t,i,r){r=r||e();const s=i[0],n=i[1],a=i[2];return r[0]=s*t[0]+n*t[4]+a*t[8],r[1]=s*t[1]+n*t[5]+a*t[9],r[2]=s*t[2]+n*t[6]+a*t[10],r}const l=5120,u=5121,c=5122,f=5123,d=5124,b=5125,_=5126,g={};{const t=g;t[l]=Int8Array,t[u]=Uint8Array,t[c]=Int16Array,t[f]=Uint16Array,t[d]=Int32Array,t[b]=Uint32Array,t[_]=Float32Array,t[32819]=Uint16Array,t[32820]=Uint16Array,t[33635]=Uint16Array,t[5131]=Uint16Array,t[33640]=Uint32Array,t[35899]=Uint32Array,t[35902]=Uint32Array,t[36269]=Uint32Array,t[34042]=Uint32Array}function p(t){if(t instanceof Int8Array)return l;if(t instanceof Uint8Array)return u;if(t instanceof Uint8ClampedArray)return u;if(t instanceof Int16Array)return c;if(t instanceof Uint16Array)return f;if(t instanceof Int32Array)return d;if(t instanceof Uint32Array)return b;if(t instanceof Float32Array)return _;throw new Error("unsupported typed array type")}function m(t){if(t===Int8Array)return l;if(t===Uint8Array)return u;if(t===Uint8ClampedArray)return u;if(t===Int16Array)return c;if(t===Uint16Array)return f;if(t===Int32Array)return d;if(t===Uint32Array)return b;if(t===Float32Array)return _;throw new Error("unsupported typed array type")}const v="undefined"!=typeof SharedArrayBuffer?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};const x=new Map;function T(t,e){if(!t||"object"!=typeof t)return!1;let i=x.get(e);i||(i=new WeakMap,x.set(e,i));let r=i.get(t);if(void 0===r){const s=Object.prototype.toString.call(t);r=s.substring(8,s.length-1)===e,i.set(t,r)}return r}function w(t,e){return"undefined"!=typeof WebGLTexture&&T(e,"WebGLTexture")}const y=35044,A=34962,E=34963,C=34660,M=5120,S=5121,k=5122,D=5123,F=5124,R=5125,U=5126,I={attribPrefix:""};function O(t,e,i,r){if("undefined"!=typeof WebGLBuffer&&T(e,"WebGLBuffer"))return e;i=i||A;const s=t.createBuffer();return function(t,e,i,r,s){t.bindBuffer(e,i),t.bufferData(e,r,s||y)}(t,i,s,e,r),s}function P(t){return"indices"===t}function z(t){return t.length?t:t.data}const B=/coord|texture/i,L=/color|colour/i;function N(t,e,i){return t.numComponents||t.size||function(t,e){let i;if(i=B.test(t)?2:L.test(t)?4:3,e%i>0)throw new Error(`Can not guess numComponents for attribute '${t}'. Tried ${i} but ${e} values is not evenly divisible by ${i}. You should specify it.`);return i}(e,i||z(t).length)}function H(t,e){if(v(t))return t;if(v(t.data))return t.data;Array.isArray(t)&&(t={data:t});let i=t.type?G(t.type):void 0;return i||(i=P(e)?Uint16Array:Float32Array),new i(t.data)}function G(t){return"number"==typeof t?function(t){const e=g[t];if(!e)throw new Error("unknown gl type");return e}(t):t||Float32Array}function j(t,e){return{buffer:e.buffer,numValues:24,type:(i=e.type,"number"==typeof i?i:i?m(i):U),arrayType:G(e.type)};var i}function W(t,e){const i=e.data||e,r=G(e.type),s=i*r.BYTES_PER_ELEMENT,n=t.createBuffer();return t.bindBuffer(A,n),t.bufferData(A,s,e.drawType||y),{buffer:n,numValues:i,type:m(r),arrayType:r}}function V(t,e,i){const r=H(e,i);return{arrayType:r.constructor,buffer:O(t,r,void 0,e.drawType),type:p(r),numValues:0}}const q=["position","positions","a_position"];function Y(t,e,i){const r=function(t,e){const i={};return Object.keys(e).forEach((function(r){if(!P(r)){const n=e[r],a=n.attrib||n.name||n.attribName||I.attribPrefix+r;if(n.value){if(!Array.isArray(n.value)&&!v(n.value))throw new Error("array.value is not array or typedarray");i[a]={value:n.value}}else{let e;e=n.buffer&&n.buffer instanceof WebGLBuffer?j:"number"==typeof n||"number"==typeof n.data?W:V;const{buffer:o,type:h,numValues:l,arrayType:u}=e(t,n,r),c=void 0!==n.normalize?n.normalize:(s=u)===Int8Array||s===Uint8Array,f=N(n,r,l);i[a]={buffer:o,numComponents:f,type:h,normalize:c,stride:n.stride||0,offset:n.offset||0,divisor:void 0===n.divisor?void 0:n.divisor,drawType:n.drawType}}}var s})),t.bindBuffer(A,null),i}(t,e),s=Object.assign({},i||{});s.attribs=Object.assign({},i?i.attribs:{},r);const n=e.indices;if(n){const e=H(n,"indices");s.indices=O(t,e,E),s.numElements=e.length,s.elementType=p(e)}else s.numElements||(s.numElements=function(t,e){let i,r;for(r=0;r<q.length&&(i=q[r],!(i in e))&&(i=I.attribPrefix+i,!(i in e));++r);r===q.length&&(i=Object.keys(e)[0]);const s=e[i];if(!s.buffer)return 1;t.bindBuffer(A,s.buffer);const n=t.getBufferParameter(A,C);var a;t.bindBuffer(A,null);const o=n/((a=s.type)===M||a===S?1:a===k||a===D?2:a===F||a===R||a===U?4:0),h=s.numComponents||s.size,l=o/h;if(l%1!=0)throw new Error(`numComponents ${h} not correct for length ${length}`);return l}(t,s.attribs));return s}function X(t,e){const i={};return Object.keys(e).forEach((function(r){i[r]=function(t,e,i){const r="indices"===i?E:A;return O(t,H(e,i),r)}(t,e[r],r)})),e.indices?(i.numElements=e.indices.length,i.elementType=p(H(e.indices))):i.numElements=function(t){let e,i;for(i=0;i<q.length&&(e=q[i],!(e in t));++i);i===q.length&&(e=Object.keys(t)[0]);const r=t[e],s=z(r).length;if(void 0===s)return 1;const n=N(r,e),a=s/n;if(s%n>0)throw new Error(`numComponents ${n} not correct for length ${s}`);return a}(e),i}function Z(t,e,i){return function(t,e){let i=0;return t.push=function(){for(let e=0;e<arguments.length;++e){const r=arguments[e];if(r instanceof Array||v(r))for(let e=0;e<r.length;++e)t[i++]=r[e];else t[i++]=r}},t.reset=function(t){i=t||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}(new(i||Float32Array)(t*e),t)}function J(t,e,i){const r=t.length,s=new Float32Array(3);for(let n=0;n<r;n+=3)i(e,[t[n],t[n+1],t[n+2]],s),t[n]=s[0],t[n+1]=s[1],t[n+2]=s[2]}function K(t,i,r){r=r||e();const s=i[0],n=i[1],a=i[2];return r[0]=s*t[0]+n*t[1]+a*t[2],r[1]=s*t[4]+n*t[5]+a*t[6],r[2]=s*t[8]+n*t[9]+a*t[10],r}function Q(t,e){return J(t,function(t,e){e=e||new n(16);const i=t[0],r=t[1],s=t[2],a=t[3],o=t[4],h=t[5],l=t[6],u=t[7],c=t[8],f=t[9],d=t[10],b=t[11],_=t[12],g=t[13],p=t[14],m=t[15],v=d*m,x=p*b,T=l*m,w=p*u,y=l*b,A=d*u,E=s*m,C=p*a,M=s*b,S=d*a,k=s*u,D=l*a,F=c*g,R=_*f,U=o*g,I=_*h,O=o*f,P=c*h,z=i*g,B=_*r,L=i*f,N=c*r,H=i*h,G=o*r,j=v*h+w*f+y*g-(x*h+T*f+A*g),W=x*r+E*f+S*g-(v*r+C*f+M*g),V=T*r+C*h+k*g-(w*r+E*h+D*g),q=A*r+M*h+D*f-(y*r+S*h+k*f),Y=1/(i*j+o*W+c*V+_*q);return e[0]=Y*j,e[1]=Y*W,e[2]=Y*V,e[3]=Y*q,e[4]=Y*(x*o+T*c+A*_-(v*o+w*c+y*_)),e[5]=Y*(v*i+C*c+M*_-(x*i+E*c+S*_)),e[6]=Y*(w*i+E*o+D*_-(T*i+C*o+k*_)),e[7]=Y*(y*i+S*o+k*c-(A*i+M*o+D*c)),e[8]=Y*(F*u+I*b+O*m-(R*u+U*b+P*m)),e[9]=Y*(R*a+z*b+N*m-(F*a+B*b+L*m)),e[10]=Y*(U*a+B*u+H*m-(I*a+z*u+G*m)),e[11]=Y*(P*a+L*u+G*b-(O*a+N*u+H*b)),e[12]=Y*(U*d+P*p+R*l-(O*p+F*l+I*d)),e[13]=Y*(L*p+F*s+B*d-(z*d+N*p+R*s)),e[14]=Y*(z*l+G*p+I*s-(H*p+U*s+B*l)),e[15]=Y*(H*d+O*s+N*l-(L*l+G*d+P*s)),e}(e),K),t}function tt(t,e){return Object.keys(t).forEach((function(i){const r=t[i];i.indexOf("pos")>=0?function(t,e){J(t,e,o)}(r,e):i.indexOf("tan")>=0||i.indexOf("binorm")>=0?function(t,e){J(t,e,h)}(r,e):i.indexOf("norm")>=0&&Q(r,e)})),t}function et(t,e,i){return t=t||2,{position:{numComponents:2,data:[(e=e||0)+-1*(t*=.5),(i=i||0)+-1*t,e+1*t,i+-1*t,e+-1*t,i+1*t,e+1*t,i+1*t]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function it(t,e,i,r,s){t=t||1,e=e||1,i=i||1,r=r||1,s=s||a();const n=(i+1)*(r+1),o=Z(3,n),h=Z(3,n),l=Z(2,n);for(let s=0;s<=r;s++)for(let n=0;n<=i;n++){const a=n/i,u=s/r;o.push(t*a-.5*t,0,e*u-.5*e),h.push(0,1,0),l.push(a,u)}const u=i+1,c=Z(3,i*r*2,Uint16Array);for(let t=0;t<r;t++)for(let e=0;e<i;e++)c.push((t+0)*u+e,(t+1)*u+e,(t+0)*u+e+1),c.push((t+1)*u+e,(t+1)*u+e+1,(t+0)*u+e+1);return tt({position:o,normal:h,texcoord:l,indices:c},s)}function rt(t,e,i,r,s,n,a){if(e<=0||i<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");r=r||0,n=n||0;const o=(s=s||Math.PI)-r,h=(a=a||2*Math.PI)-n,l=(e+1)*(i+1),u=Z(3,l),c=Z(3,l),f=Z(2,l);for(let s=0;s<=i;s++)for(let a=0;a<=e;a++){const l=a/e,d=s/i,b=h*l+n,_=o*d+r,g=Math.sin(b),p=Math.cos(b),m=Math.sin(_),v=p*m,x=Math.cos(_),T=g*m;u.push(t*v,t*x,t*T),c.push(v,x,T),f.push(1-l,d)}const d=e+1,b=Z(3,e*i*2,Uint16Array);for(let t=0;t<e;t++)for(let e=0;e<i;e++)b.push((e+0)*d+t,(e+0)*d+t+1,(e+1)*d+t),b.push((e+1)*d+t,(e+0)*d+t+1,(e+1)*d+t+1);return{position:u,normal:c,texcoord:f,indices:b}}const st=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function nt(t){const e=(t=t||1)/2,i=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],r=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],s=[[1,0],[0,0],[0,1],[1,1]],n=Z(3,24),a=Z(3,24),o=Z(2,24),h=Z(3,12,Uint16Array);for(let t=0;t<6;++t){const e=st[t];for(let h=0;h<4;++h){const l=i[e[h]],u=r[t],c=s[h];n.push(l),a.push(u),o.push(c)}const l=4*t;h.push(l+0,l+1,l+2),h.push(l+0,l+2,l+3)}return{position:n,normal:a,texcoord:o,indices:h}}function at(t,e,i,r,s,n,a){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(s<1)throw new Error("verticalSubdivisions must be 1 or greater");const o=void 0===n||n,h=void 0===a||a,l=(o?2:0)+(h?2:0),u=(r+1)*(s+1+l),c=Z(3,u),f=Z(3,u),d=Z(2,u),b=Z(3,r*(s+l/2)*2,Uint16Array),_=r+1,g=Math.atan2(t-e,i),p=Math.cos(g),m=Math.sin(g),v=s+(h?2:0);for(let n=o?-2:0;n<=v;++n){let a,o=n/s,h=i*o;n<0?(h=0,o=1,a=t):n>s?(h=i,o=1,a=e):a=t+n/s*(e-t),-2!==n&&n!==s+2||(a=0,o=0),h-=i/2;for(let t=0;t<_;++t){const e=Math.sin(t*Math.PI*2/r),i=Math.cos(t*Math.PI*2/r);c.push(e*a,h,i*a),n<0?f.push(0,-1,0):n>s?f.push(0,1,0):0===a?f.push(0,0,0):f.push(e*p,m,i*p),d.push(t/r,1-o)}}for(let t=0;t<s+l;++t)if(!(1===t&&o||t===s+l-2&&h))for(let e=0;e<r;++e)b.push(_*(t+0)+0+e,_*(t+0)+1+e,_*(t+1)+1+e),b.push(_*(t+0)+0+e,_*(t+1)+1+e,_*(t+1)+0+e);return{position:c,normal:f,texcoord:d,indices:b}}function ot(t,e){e=e||[];const i=[];for(let r=0;r<t.length;r+=4){const s=t[r],n=t.slice(r+1,r+4);n.push.apply(n,e);for(let t=0;t<s;++t)i.push.apply(i,n)}return i}function ht(){const t=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=ot([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),i=ot([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),r=t.length/3,s={position:Z(3,r),texcoord:Z(2,r),normal:Z(3,r),color:Z(4,r,Uint8Array),indices:Z(3,r/3,Uint16Array)};s.position.push(t),s.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),s.normal.push(e),s.color.push(i);for(let t=0;t<r;++t)s.indices.push(t);return s}function lt(t,e,i,n,a,o,h){if(a<=0)throw new Error("subdivisionDown must be > 0");const l=(h=h||1)-(o=o||0),u=2*(a+1)*4,c=Z(3,u),f=Z(3,u),d=Z(2,u);function b(t,e,i){return t+(e-t)*i}function _(e,i,h,u,_,g){for(let p=0;p<=a;p++){const m=i/1,v=p/a,x=2*(m-.5),T=(o+v*l)*Math.PI,w=Math.sin(T),y=Math.cos(T),A=b(t,e,w),E=x*n,C=y*t,M=w*A;c.push(E,C,M);const S=r(s([0,w,y],h),u);f.push(S),d.push(m*_+g,v)}}for(let t=0;t<2;t++){const r=2*(t/1-.5);_(e,t,[1,1,1],[0,0,0],1,0),_(e,t,[0,0,0],[r,0,0],0,0),_(i,t,[1,1,1],[0,0,0],1,0),_(i,t,[0,0,0],[r,0,0],0,1)}const g=Z(3,2*a*4,Uint16Array);function p(t,e){for(let i=0;i<a;++i)g.push(t+i+0,t+i+1,e+i+0),g.push(t+i+1,e+i+1,e+i+0)}const m=a+1;return p(0*m,4*m),p(5*m,7*m),p(6*m,2*m),p(3*m,1*m),{position:c,normal:f,texcoord:d,indices:g}}function ut(t,e,i,r,s,n){return at(t,t,e,i,r,s,n)}function ct(t,e,i,r,s,n){if(i<3)throw new Error("radialSubdivisions must be 3 or greater");if(r<3)throw new Error("verticalSubdivisions must be 3 or greater");s=s||0;const a=(n=n||2*Math.PI)-s,o=i+1,h=r+1,l=o*h,u=Z(3,l),c=Z(3,l),f=Z(2,l),d=Z(3,i*r*2,Uint16Array);for(let n=0;n<h;++n){const h=n/r,l=h*Math.PI*2,d=Math.sin(l),b=t+d*e,_=Math.cos(l),g=_*e;for(let t=0;t<o;++t){const e=t/i,r=s+e*a,n=Math.sin(r),o=Math.cos(r),l=n*b,p=o*b,m=n*d,v=o*d;u.push(l,g,p),c.push(m,_,v),f.push(e,1-h)}}for(let t=0;t<r;++t)for(let e=0;e<i;++e){const i=1+e,r=1+t;d.push(o*t+e,o*r+e,o*t+i),d.push(o*r+e,o*r+i,o*t+i)}return{position:u,normal:c,texcoord:f,indices:d}}function ft(t,e,i,r,s){if(e<3)throw new Error("divisions must be at least 3");s=s||1,r=r||0;const n=(e+1)*((i=i||1)+1),a=Z(3,n),o=Z(3,n),h=Z(2,n),l=Z(3,i*e*2,Uint16Array);let u=0;const c=t-r,f=e+1;for(let t=0;t<=i;++t){const n=r+c*Math.pow(t/i,s);for(let r=0;r<=e;++r){const s=2*Math.PI*r/e,c=n*Math.cos(s),d=n*Math.sin(s);if(a.push(c,0,d),o.push(0,1,0),h.push(1-r/e,t/i),t>0&&r!==e){const t=u+(r+1),e=u+r,i=u+r-f,s=u+(r+1)-f;l.push(t,e,i),l.push(t,i,s)}}u+=e+1}return{position:a,normal:o,texcoord:h,indices:l}}function dt(t){return function(e){return X(e,t.apply(this,Array.prototype.slice.call(arguments,1)))}}function bt(t){return function(e){return Y(e,t.apply(null,Array.prototype.slice.call(arguments,1)))}}function _t(t){return!!t.texStorage2D}bt(ht),dt(ht),bt(nt),dt(nt),bt(it),dt(it),bt(rt),dt(rt),bt(at),dt(at),bt(et),dt(et),bt(lt),dt(lt),bt(ut),dt(ut),bt(ct),dt(ct),bt(ft),dt(ft);const gt=function(){const t={},e={};return function(i,r){return function(i){const r=i.constructor.name;if(!t[r]){for(const t in i)if("number"==typeof i[t]){const r=e[i[t]];e[i[t]]=r?`${r} | ${t}`:t}t[r]=!0}}(i),e[r]||("number"==typeof r?`0x${r.toString(16)}`:r)}}();new Uint8Array([128,192,255,255]);{const t={};t[6406]={numColorComponents:1},t[6409]={numColorComponents:1},t[6410]={numColorComponents:2},t[6407]={numColorComponents:3},t[6408]={numColorComponents:4},t[6403]={numColorComponents:1},t[36244]={numColorComponents:1},t[33319]={numColorComponents:2},t[33320]={numColorComponents:2},t[6407]={numColorComponents:3},t[36248]={numColorComponents:3},t[6408]={numColorComponents:4},t[36249]={numColorComponents:4},t[6402]={numColorComponents:1},t[34041]={numColorComponents:2}}const pt=function(...t){WH.debug(...t)};function mt(t){return"undefined"!=typeof document&&document.getElementById?document.getElementById(t):null}const vt=33984,xt=34962,Tt=35713,wt=35714,yt=35632,At=35633,Et=35981,Ct=35718,Mt=35721,St=35971,kt=35382,Dt=35396,Ft=35398,Rt=35392,Ut=35395,It=5124,Ot=3553,Pt=34067,zt=32879,Bt=35866,Lt={};function Nt(t,e){return Lt[e].bindPoint}function Ht(t,e){return function(i){t.uniform1i(e,i)}}function Gt(t,e){return function(i){t.uniform1iv(e,i)}}function jt(t,e){return function(i){t.uniform2iv(e,i)}}function Wt(t,e){return function(i){t.uniform3iv(e,i)}}function Vt(t,e){return function(i){t.uniform4iv(e,i)}}function qt(t,e,i,r){const s=Nt(0,e);return _t(t)?function(e){let n,a;!e||w(0,e)?(n=e,a=null):(n=e.texture,a=e.sampler),t.uniform1i(r,i),t.activeTexture(vt+i),t.bindTexture(s,n),t.bindSampler(i,a)}:function(e){t.uniform1i(r,i),t.activeTexture(vt+i),t.bindTexture(s,e)}}function Yt(t,e,i,r,s){const n=Nt(0,e),a=new Int32Array(s);for(let t=0;t<s;++t)a[t]=i+t;return _t(t)?function(e){t.uniform1iv(r,a),e.forEach((function(e,r){let s,o;t.activeTexture(vt+a[r]),!e||w(0,e)?(s=e,o=null):(s=e.texture,o=e.sampler),t.bindSampler(i,o),t.bindTexture(n,s)}))}:function(e){t.uniform1iv(r,a),e.forEach((function(e,i){t.activeTexture(vt+a[i]),t.bindTexture(n,e)}))}}function Xt(t,e){return function(i){if(i.value)switch(t.disableVertexAttribArray(e),i.value.length){case 4:t.vertexAttrib4fv(e,i.value);break;case 3:t.vertexAttrib3fv(e,i.value);break;case 2:t.vertexAttrib2fv(e,i.value);break;case 1:t.vertexAttrib1fv(e,i.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else t.bindBuffer(xt,i.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,i.numComponents||i.size,i.type||5126,i.normalize||!1,i.stride||0,i.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,i.divisor||0)}}function Zt(t,e){return function(i){if(i.value){if(t.disableVertexAttribArray(e),4!==i.value.length)throw new Error("The length of an integer constant value must be 4!");t.vertexAttrib4iv(e,i.value)}else t.bindBuffer(xt,i.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,i.numComponents||i.size,i.type||It,i.stride||0,i.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,i.divisor||0)}}function Jt(t,e){return function(i){if(i.value){if(t.disableVertexAttribArray(e),4!==i.value.length)throw new Error("The length of an unsigned integer constant value must be 4!");t.vertexAttrib4uiv(e,i.value)}else t.bindBuffer(xt,i.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,i.numComponents||i.size,i.type||5125,i.stride||0,i.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,i.divisor||0)}}function Kt(t,e,i){const r=i.size,s=i.count;return function(i){t.bindBuffer(xt,i.buffer);const n=i.size||i.numComponents||r,a=n/s,o=i.type||5126,h=Lt[o].size*n,l=i.normalize||!1,u=i.offset||0,c=h/s;for(let r=0;r<s;++r)t.enableVertexAttribArray(e+r),t.vertexAttribPointer(e+r,a,o,l,h,u+c*r),t.vertexAttribDivisor&&t.vertexAttribDivisor(e+r,i.divisor||0)}}Lt[5126]={Type:Float32Array,size:4,setter:function(t,e){return function(i){t.uniform1f(e,i)}},arraySetter:function(t,e){return function(i){t.uniform1fv(e,i)}}},Lt[35664]={Type:Float32Array,size:8,setter:function(t,e){return function(i){t.uniform2fv(e,i)}},cols:2},Lt[35665]={Type:Float32Array,size:12,setter:function(t,e){return function(i){t.uniform3fv(e,i)}},cols:3},Lt[35666]={Type:Float32Array,size:16,setter:function(t,e){return function(i){t.uniform4fv(e,i)}},cols:4},Lt[It]={Type:Int32Array,size:4,setter:Ht,arraySetter:Gt},Lt[35667]={Type:Int32Array,size:8,setter:jt,cols:2},Lt[35668]={Type:Int32Array,size:12,setter:Wt,cols:3},Lt[35669]={Type:Int32Array,size:16,setter:Vt,cols:4},Lt[5125]={Type:Uint32Array,size:4,setter:function(t,e){return function(i){t.uniform1ui(e,i)}},arraySetter:function(t,e){return function(i){t.uniform1uiv(e,i)}}},Lt[36294]={Type:Uint32Array,size:8,setter:function(t,e){return function(i){t.uniform2uiv(e,i)}},cols:2},Lt[36295]={Type:Uint32Array,size:12,setter:function(t,e){return function(i){t.uniform3uiv(e,i)}},cols:3},Lt[36296]={Type:Uint32Array,size:16,setter:function(t,e){return function(i){t.uniform4uiv(e,i)}},cols:4},Lt[35670]={Type:Uint32Array,size:4,setter:Ht,arraySetter:Gt},Lt[35671]={Type:Uint32Array,size:8,setter:jt,cols:2},Lt[35672]={Type:Uint32Array,size:12,setter:Wt,cols:3},Lt[35673]={Type:Uint32Array,size:16,setter:Vt,cols:4},Lt[35674]={Type:Float32Array,size:32,setter:function(t,e){return function(i){t.uniformMatrix2fv(e,!1,i)}},rows:2,cols:2},Lt[35675]={Type:Float32Array,size:48,setter:function(t,e){return function(i){t.uniformMatrix3fv(e,!1,i)}},rows:3,cols:3},Lt[35676]={Type:Float32Array,size:64,setter:function(t,e){return function(i){t.uniformMatrix4fv(e,!1,i)}},rows:4,cols:4},Lt[35685]={Type:Float32Array,size:32,setter:function(t,e){return function(i){t.uniformMatrix2x3fv(e,!1,i)}},rows:2,cols:3},Lt[35686]={Type:Float32Array,size:32,setter:function(t,e){return function(i){t.uniformMatrix2x4fv(e,!1,i)}},rows:2,cols:4},Lt[35687]={Type:Float32Array,size:48,setter:function(t,e){return function(i){t.uniformMatrix3x2fv(e,!1,i)}},rows:3,cols:2},Lt[35688]={Type:Float32Array,size:48,setter:function(t,e){return function(i){t.uniformMatrix3x4fv(e,!1,i)}},rows:3,cols:4},Lt[35689]={Type:Float32Array,size:64,setter:function(t,e){return function(i){t.uniformMatrix4x2fv(e,!1,i)}},rows:4,cols:2},Lt[35690]={Type:Float32Array,size:64,setter:function(t,e){return function(i){t.uniformMatrix4x3fv(e,!1,i)}},rows:4,cols:3},Lt[35678]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Ot},Lt[35680]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Pt},Lt[35679]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:zt},Lt[35682]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Ot},Lt[36289]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Bt},Lt[36292]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Bt},Lt[36293]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Pt},Lt[36298]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Ot},Lt[36299]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:zt},Lt[36300]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Pt},Lt[36303]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Bt},Lt[36306]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Ot},Lt[36307]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:zt},Lt[36308]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Pt},Lt[36311]={Type:null,size:0,setter:qt,arraySetter:Yt,bindPoint:Bt};const $t={};$t[5126]={size:4,setter:Xt},$t[35664]={size:8,setter:Xt},$t[35665]={size:12,setter:Xt},$t[35666]={size:16,setter:Xt},$t[It]={size:4,setter:Zt},$t[35667]={size:8,setter:Zt},$t[35668]={size:12,setter:Zt},$t[35669]={size:16,setter:Zt},$t[5125]={size:4,setter:Jt},$t[36294]={size:8,setter:Jt},$t[36295]={size:12,setter:Jt},$t[36296]={size:16,setter:Jt},$t[35670]={size:4,setter:Zt},$t[35671]={size:8,setter:Zt},$t[35672]={size:12,setter:Zt},$t[35673]={size:16,setter:Zt},$t[35674]={size:4,setter:Kt,count:2},$t[35675]={size:9,setter:Kt,count:3},$t[35676]={size:16,setter:Kt,count:4};const Qt=/ERROR:\s*\d+:(\d+)/gi,te=/^[ \t]*\n/;function ee(t){let e=0;return te.test(t)&&(e=1,t=t.replace(te,"")),{lineOffset:e,shaderSource:t}}function ie(t,e,i){let r,s,n;if("function"==typeof e&&(i=e,e=void 0),"function"==typeof t)i=t,t=void 0;else if(t&&!Array.isArray(t)){const e=t;i=e.errorCallback,t=e.attribLocations,r=e.transformFeedbackVaryings,s=e.transformFeedbackMode,n=e.callback}const a=i||pt,o=[],h={errorCallback(t,...e){o.push(t),a(t,...e)},transformFeedbackVaryings:r,transformFeedbackMode:s,callback:n,errors:o};{let i={};Array.isArray(t)?t.forEach((function(t,r){i[t]=e?e[r]:r})):i=t||{},h.attribLocations=i}return h}const re=["VERTEX_SHADER","FRAGMENT_SHADER"],se=(t=0)=>new Promise((e=>setTimeout(e,t)));function ne(t,e,i){const r=t.createProgram(),{attribLocations:s,transformFeedbackVaryings:n,transformFeedbackMode:a}=ie(i);for(let i=0;i<e.length;++i){let s=e[i];if("string"==typeof s){const e=mt(s),n=e?e.text:s;let a=t[re[i]];e&&e.type&&(a=((o=e.type).indexOf("frag")>=0?yt:o.indexOf("vert")>=0?At:void 0)||a),s=t.createShader(a),t.shaderSource(s,ee(n).shaderSource),t.compileShader(s),t.attachShader(r,s)}}var o;Object.entries(s).forEach((([e,i])=>t.bindAttribLocation(r,i,e)));{let e=n;e&&(e.attribs&&(e=e.attribs),Array.isArray(e)||(e=Object.keys(e)),t.transformFeedbackVaryings(r,e,a||Et))}return t.linkProgram(r),r}function ae(t,e,i,r,s){const n=ie(i,r,s),a=new Set(e),o=ne(t,e,n);function h(t,e){const i=le(t,e,n.errorCallback);return i&&function(t,e,i){const r=t.getAttachedShaders(e);for(const e of r)i.has(e)&&t.deleteShader(e);t.deleteProgram(e)}(t,e,a),i}if(!n.callback)return h(t,o)?void 0:o;he(t,o).then((()=>{const e=h(t,o);n.callback(e,e?void 0:o)}))}function oe(t){return function(e,i,...r){return new Promise(((s,n)=>{const a=ie(...r);a.callback=(t,e)=>{t?n(t):s(e)},t(e,i,a)}))}}async function he(t,e){const i=t.getExtension("KHR_parallel_shader_compile"),r=i?(t,e)=>t.getProgramParameter(e,i.COMPLETION_STATUS_KHR):()=>!0;let s=0;do{await se(s),s=1e3/60}while(!r(t,e))}function le(t,e,i){if(i=i||pt,!t.getProgramParameter(e,wt)){const r=t.getProgramInfoLog(e);return i(`Error in program linking: ${r}`),`${r}\n${t.getAttachedShaders(e).map((e=>function(t,e,i,r){if(r=r||pt,!t.getShaderParameter(i,Tt)){const s=t.getShaderInfoLog(i),{lineOffset:n,shaderSource:a}=ee(t.getShaderSource(i)),o=`${function(t,e="",i=0){const r=[...e.matchAll(Qt)],s=new Map(r.map(((t,i)=>{const s=parseInt(t[1]),n=r[i+1],a=n?n.index:e.length;return[s-1,e.substring(t.index,a)]})));return t.split("\n").map(((t,e)=>{const r=s.get(e);return`${e+1+i}: ${t}${r?`\n\n^^^ ${r}`:""}`})).join("\n")}(a,s,n)}\nError compiling ${gt(t,e)}: ${s}`;return r(o),o}return""}(t,t.getShaderParameter(e,t.SHADER_TYPE),e,i))).filter((t=>t)).join("\n")}`}}function ue(t){const e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}oe(ae),oe(xe);const ce=/(\.|\[|]|\w+)/g,fe=t=>t>="0"&&t<="9";function de(t,e,i,r){const s=t.split(ce).filter((t=>""!==t));let n=0,a="";for(;;){const t=s[n++];a+=t;const o=fe(t[0]),h=o?parseInt(t):t;if(o&&(a+=s[n++]),n===s.length){i[h]=e;break}{const t=s[n++],e="["===t,o=i[h]||(e?[]:{});i[h]=o,i=o,r[a]=r[a]||function(t){return function(e){_e(t,e)}}(o),a+=t}}}function be(t,e){let i=0;function r(e,r,s){const n=r.name.endsWith("[0]"),a=r.type,o=Lt[a];if(!o)throw new Error(`unknown type: 0x${a.toString(16)}`);let h;if(o.bindPoint){const e=i;i+=r.size,h=n?o.arraySetter(t,a,e,s,r.size):o.setter(t,a,e,s,r.size)}else h=o.arraySetter&&n?o.arraySetter(t,s):o.setter(t,s);return h.location=s,h}const s={},n={},a=t.getProgramParameter(e,Ct);for(let i=0;i<a;++i){const a=t.getActiveUniform(e,i);if(ue(a))continue;let o=a.name;o.endsWith("[0]")&&(o=o.substr(0,o.length-3));const h=t.getUniformLocation(e,a.name);if(h){const t=r(0,a,h);s[o]=t,de(o,t,n,s)}}return s}function _e(t,e){for(const i in e){const r=t[i];"function"==typeof r?r(e[i]):_e(t[i],e[i])}}function ge(t,...e){const i=t.uniformSetters||t,r=e.length;for(let t=0;t<r;++t){const r=e[t];if(Array.isArray(r)){const t=r.length;for(let e=0;e<t;++e)ge(i,r[e])}else for(const t in r){const e=i[t];e&&e(r[t])}}}function pe(t,e){const i={},r=t.getProgramParameter(e,Mt);for(let s=0;s<r;++s){const r=t.getActiveAttrib(e,s);if(ue(r))continue;const n=t.getAttribLocation(e,r.name),a=$t[r.type],o=a.setter(t,n,a);o.location=n,i[r.name]=o}return i}function me(t,e){const i={program:e,uniformSetters:be(t,e),attribSetters:pe(t,e)};return _t(t)&&(i.uniformBlockSpec=function(t,e){const i=t.getProgramParameter(e,Ct),r=[],s=[];for(let n=0;n<i;++n){s.push(n),r.push({});const i=t.getActiveUniform(e,n);r[n].name=i.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach((function(i){const n=i[0],a=i[1];t.getActiveUniforms(e,s,t[n]).forEach((function(t,e){r[e][a]=t}))}));const n={},a=t.getProgramParameter(e,kt);for(let i=0;i<a;++i){const r=t.getActiveUniformBlockName(e,i),s={index:t.getUniformBlockIndex(e,r),usedByVertexShader:t.getActiveUniformBlockParameter(e,i,Dt),usedByFragmentShader:t.getActiveUniformBlockParameter(e,i,Ft),size:t.getActiveUniformBlockParameter(e,i,Rt),uniformIndices:t.getActiveUniformBlockParameter(e,i,Ut)};s.used=s.usedByVertexShader||s.usedByFragmentShader,n[r]=s}return{blockSpecs:n,uniformData:r}}(t,e),i.transformFeedbackInfo=function(t,e){const i={},r=t.getProgramParameter(e,St);for(let s=0;s<r;++s){const r=t.getTransformFeedbackVarying(e,s);i[r.name]={index:s,type:r.type,size:r.size}}return i}(t,e)),i}const ve=/\s|{|}|;/;function xe(t,e,i,r,s){const n=ie(i,r,s),a=[];if(e=e.map((function(t){if(!ve.test(t)){const e=mt(t);if(e)t=e.text;else{const e=`no element with id: ${t}`;n.errorCallback(e),a.push(e)}}return t})),a.length)return function(t,e){return t.errorCallback(e),t.callback&&setTimeout((()=>{t.callback(`${e}\n${t.errors.join("\n")}`)})),null}(n,"");const o=n.callback;o&&(n.callback=(e,i)=>{o(e,e?void 0:me(t,i))});const h=function(t,e,i,r,s){return ae(t,e,i,r,s)}(t,e,n);return h?me(t,h):null}function Te(t,e,i,r,s){for(const[n,a]of Object.entries(e)){const o={...s},h=i[n];Array.isArray(h)||Object.assign(o,h);const l=le(t,a,o.errorCallback);if(l){for(const i of Object.values(e)){const e=t.getAttachedShaders(i);t.deleteProgram(i);for(const i of e)r.has(i)||t.deleteShader(i)}return l}}}function we(t,e,i={}){const r=new Set,s=Object.fromEntries(Object.entries(e).map((([e,s])=>{const n={...i},a=Array.isArray(s)?s:s.shaders;return Array.isArray(s)||Object.assign(n,s),a.forEach(r.add,r),[e,ne(t,a,n)]})));if(!i.callback)return Te(t,s,e,r,i)?void 0:s;(async function(t,e){for(const i of Object.values(e))await he(t,i)})(t,s).then((()=>{const n=Te(t,s,e,r,i);i.callback(n,n?void 0:s)}))}oe(we),oe((function(t,e,i){function r(t,e){return Object.fromEntries(Object.entries(e).map((([e,i])=>[e,me(t,i)])))}const s=(i=ie(i)).callback;s&&(i.callback=(e,i)=>{s(e,e?void 0:r(t,i))});const n=we(t,e,i);if(!s&&n)return r(t,n)}));const ye=36096,Ae=33306,Ee={};Ee[34041]=Ae,Ee[6401]=36128,Ee[36168]=36128,Ee[6402]=ye,Ee[33189]=ye,Ee[33190]=ye,Ee[36012]=ye,Ee[35056]=Ae,Ee[36013]=Ae;var Ce={};const Me={position:3,normal:3,tangent:3,texcoord:2,texcoord0:2,texcoord1:2,texcoord2:2};var Se={};class ke{constructor(){this.attribs={}}disableAll(){for(let t in this.attribs)this.gl.disableVertexAttribArray(this.attribs[t]);this.attribs={}}enable(t,e){this.gl=t;var i={};for(let s in e){var r=e[s];void 0!==r.loc&&(void 0===this.attribs[r.loc]&&t.enableVertexAttribArray(r.loc),t.vertexAttribPointer(r.loc,r.size,r.type,!1,r.stride,r.offset),i[r.loc]=r.loc,this.attribs[s]=null)}for(let t in this.attribs);this.attribs=i}}class De{static CreateProgramAttributes(t,e){var i={},r=0;for(let a in e){var s=e[a],n=Me[a];i[s]={type:t.FLOAT,size:n,offset:4*r},r+=n}for(let t in i)i[t].stride=4*r;return i}CleanUpPrograms(){Se={}}ReleaseProgram(t){}static _GetProgram(t){return Se[t]}static RegisterProgram(t,e){if(!Se[t]){var i=e.shaders;Se[t]={shaders:[i[0],i[1]],attributes:e.attributes}}return Se[t]}static GetProgram(t,e,i,r){var s=Se[e],n="";for(var a in i)n+=a+":"+i[a]+"-";if(!s){var o=e.split("."),h=Ce[o[0]][o[1]];h&&(s=De.RegisterProgram(e,h))}if(!s)throw"Program not registered: "+o;s.programInfo||(s.programInfo={}),s.programInfo[n]=De.CompileProgram(t,s.shaders,i),r=r||s.attributes&&De.CreateProgramAttributes(t,s.attributes);var l=s.programInfo[n];if(r)for(var a in r){var u=l.attribSetters[a];u&&(r[a]=r[a]||{},r[a].loc=u.location)}return l.attributes=r,l}static CompileProgram(t,e,i,r){var s="";for(var n in i){var a=i[n];s="#define "+n+" "+(null===a?"":a)+"\n"}var o={};const h=xe(t,[s+e[0],s+e[1]],null,null);if(r)for(var n in r){var l=h.attribSetters[n];l&&(r[n]=r[n]||{},r[n].loc=l.location)}for(var n in h.uniformSetters)o[n]=h.uniformSetters[n].location;return h.uniforms=o,h}}var Fe=new De,Re=1e-6,Ue="undefined"!=typeof Float32Array?Float32Array:Array;function Ie(){var t=new Ue(3);return Ue!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Oe(t){var e=new Ue(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Pe(t){var e=t[0],i=t[1],r=t[2];return Math.hypot(e,i,r)}function ze(t,e,i){var r=new Ue(3);return r[0]=t,r[1]=e,r[2]=i,r}function Be(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Le(t,e,i,r){return t[0]=e,t[1]=i,t[2]=r,t}function Ne(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function He(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function Ge(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function je(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function We(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function Ve(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function qe(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t}function Ye(t){var e=t[0],i=t[1],r=t[2];return e*e+i*i+r*r}function Xe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ze(t,e){var i=e[0],r=e[1],s=e[2],n=i*i+r*r+s*s;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Je(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ke(t,e,i){var r=e[0],s=e[1],n=e[2],a=i[0],o=i[1],h=i[2];return t[0]=s*h-n*o,t[1]=n*a-r*h,t[2]=r*o-s*a,t}function $e(t,e,i,r){var s=e[0],n=e[1],a=e[2];return t[0]=s+r*(i[0]-s),t[1]=n+r*(i[1]-n),t[2]=a+r*(i[2]-a),t}function Qe(t,e,i){var r=e[0],s=e[1],n=e[2],a=i[3]*r+i[7]*s+i[11]*n+i[15];return a=a||1,t[0]=(i[0]*r+i[4]*s+i[8]*n+i[12])/a,t[1]=(i[1]*r+i[5]*s+i[9]*n+i[13])/a,t[2]=(i[2]*r+i[6]*s+i[10]*n+i[14])/a,t}function ti(t,e,i){var r=e[0],s=e[1],n=e[2];return t[0]=r*i[0]+s*i[3]+n*i[6],t[1]=r*i[1]+s*i[4]+n*i[7],t[2]=r*i[2]+s*i[5]+n*i[8],t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ei=He;function ii(){var t=new Ue(16);return Ue!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function ri(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function si(t,e,i,r,s,n,a,o,h,l,u,c,f,d,b,_){var g=new Ue(16);return g[0]=t,g[1]=e,g[2]=i,g[3]=r,g[4]=s,g[5]=n,g[6]=a,g[7]=o,g[8]=h,g[9]=l,g[10]=u,g[11]=c,g[12]=f,g[13]=d,g[14]=b,g[15]=_,g}function ni(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ai(t,e){if(t===e){var i=e[1],r=e[2],s=e[3],n=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=n,t[11]=e[14],t[12]=s,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function oi(t,e){var i=e[0],r=e[1],s=e[2],n=e[3],a=e[4],o=e[5],h=e[6],l=e[7],u=e[8],c=e[9],f=e[10],d=e[11],b=e[12],_=e[13],g=e[14],p=e[15],m=i*o-r*a,v=i*h-s*a,x=i*l-n*a,T=r*h-s*o,w=r*l-n*o,y=s*l-n*h,A=u*_-c*b,E=u*g-f*b,C=u*p-d*b,M=c*g-f*_,S=c*p-d*_,k=f*p-d*g,D=m*k-v*S+x*M+T*C-w*E+y*A;return D?(D=1/D,t[0]=(o*k-h*S+l*M)*D,t[1]=(s*S-r*k-n*M)*D,t[2]=(_*y-g*w+p*T)*D,t[3]=(f*w-c*y-d*T)*D,t[4]=(h*C-a*k-l*E)*D,t[5]=(i*k-s*C+n*E)*D,t[6]=(g*x-b*y-p*v)*D,t[7]=(u*y-f*x+d*v)*D,t[8]=(a*S-o*C+l*A)*D,t[9]=(r*C-i*S-n*A)*D,t[10]=(b*w-_*x+p*m)*D,t[11]=(c*x-u*w-d*m)*D,t[12]=(o*E-a*M-h*A)*D,t[13]=(i*M-r*E+s*A)*D,t[14]=(_*v-b*T-g*m)*D,t[15]=(u*T-c*v+f*m)*D,t):null}function hi(t,e,i){var r=e[0],s=e[1],n=e[2],a=e[3],o=e[4],h=e[5],l=e[6],u=e[7],c=e[8],f=e[9],d=e[10],b=e[11],_=e[12],g=e[13],p=e[14],m=e[15],v=i[0],x=i[1],T=i[2],w=i[3];return t[0]=v*r+x*o+T*c+w*_,t[1]=v*s+x*h+T*f+w*g,t[2]=v*n+x*l+T*d+w*p,t[3]=v*a+x*u+T*b+w*m,v=i[4],x=i[5],T=i[6],w=i[7],t[4]=v*r+x*o+T*c+w*_,t[5]=v*s+x*h+T*f+w*g,t[6]=v*n+x*l+T*d+w*p,t[7]=v*a+x*u+T*b+w*m,v=i[8],x=i[9],T=i[10],w=i[11],t[8]=v*r+x*o+T*c+w*_,t[9]=v*s+x*h+T*f+w*g,t[10]=v*n+x*l+T*d+w*p,t[11]=v*a+x*u+T*b+w*m,v=i[12],x=i[13],T=i[14],w=i[15],t[12]=v*r+x*o+T*c+w*_,t[13]=v*s+x*h+T*f+w*g,t[14]=v*n+x*l+T*d+w*p,t[15]=v*a+x*u+T*b+w*m,t}function li(t,e,i){var r,s,n,a,o,h,l,u,c,f,d,b,_=i[0],g=i[1],p=i[2];return e===t?(t[12]=e[0]*_+e[4]*g+e[8]*p+e[12],t[13]=e[1]*_+e[5]*g+e[9]*p+e[13],t[14]=e[2]*_+e[6]*g+e[10]*p+e[14],t[15]=e[3]*_+e[7]*g+e[11]*p+e[15]):(r=e[0],s=e[1],n=e[2],a=e[3],o=e[4],h=e[5],l=e[6],u=e[7],c=e[8],f=e[9],d=e[10],b=e[11],t[0]=r,t[1]=s,t[2]=n,t[3]=a,t[4]=o,t[5]=h,t[6]=l,t[7]=u,t[8]=c,t[9]=f,t[10]=d,t[11]=b,t[12]=r*_+o*g+c*p+e[12],t[13]=s*_+h*g+f*p+e[13],t[14]=n*_+l*g+d*p+e[14],t[15]=a*_+u*g+b*p+e[15]),t}function ui(t,e,i){var r=i[0],s=i[1],n=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ci(t,e,i){var r=Math.sin(i),s=Math.cos(i),n=e[4],a=e[5],o=e[6],h=e[7],l=e[8],u=e[9],c=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*s+l*r,t[5]=a*s+u*r,t[6]=o*s+c*r,t[7]=h*s+f*r,t[8]=l*s-n*r,t[9]=u*s-a*r,t[10]=c*s-o*r,t[11]=f*s-h*r,t}function fi(t,e,i){var r=Math.sin(i),s=Math.cos(i),n=e[0],a=e[1],o=e[2],h=e[3],l=e[8],u=e[9],c=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s-l*r,t[1]=a*s-u*r,t[2]=o*s-c*r,t[3]=h*s-f*r,t[8]=n*r+l*s,t[9]=a*r+u*s,t[10]=o*r+c*s,t[11]=h*r+f*s,t}function di(t,e,i){var r=Math.sin(i),s=Math.cos(i),n=e[0],a=e[1],o=e[2],h=e[3],l=e[4],u=e[5],c=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*s+l*r,t[1]=a*s+u*r,t[2]=o*s+c*r,t[3]=h*s+f*r,t[4]=l*s-n*r,t[5]=u*s-a*r,t[6]=c*s-o*r,t[7]=f*s-h*r,t}function bi(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function _i(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function gi(t,e){var i=e[0],r=e[1],s=e[2],n=e[4],a=e[5],o=e[6],h=e[8],l=e[9],u=e[10];return t[0]=Math.hypot(i,r,s),t[1]=Math.hypot(n,a,o),t[2]=Math.hypot(h,l,u),t}Ie();var pi=function(t,e,i,r,s){var n,a=1/Math.tan(e/2);return t[0]=a/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=s&&s!==1/0?(n=1/(r-s),t[10]=(s+r)*n,t[14]=2*s*r*n):(t[10]=-1,t[14]=-2*r),t},mi=hi;const vi={147259:!0},xi={28060:!0,28063:!0,28082:!0,41903:!0,42147:!0,44808:!0,45271:!0},Ti={2:{GeosetType:15,Original:2,Override:11},3:{GeosetType:15,Original:3,Override:12},4:{GeosetType:15,Original:4,Override:13},5:{GeosetType:15,Original:5,Override:14},6:{GeosetType:15,Original:6,Override:15},7:{GeosetType:15,Original:7,Override:16},8:{GeosetType:15,Original:8,Override:17},9:{GeosetType:15,Original:9,Override:18},10:{GeosetType:15,Original:10,Override:19},11:{GeosetType:12,Original:2,Override:0},12:{GeosetType:12,Original:3,Override:0},13:{GeosetType:12,Original:1,Override:5},14:{GeosetType:12,Original:2,Override:3},15:{GeosetType:12,Original:2,Override:2},16:{GeosetType:22,Original:2,Override:1},17:{GeosetType:22,Original:1,Override:2},18:{GeosetType:22,Original:1,Override:3},19:{GeosetType:22,Original:2,Override:3},20:{GeosetType:12,Original:1,Override:1},21:{GeosetType:12,Original:1,Override:9},22:{GeosetType:12,Original:2,Override:10},23:{GeosetType:12,Original:2,Override:6},24:{GeosetType:12,Original:1,Override:5},25:{GeosetType:27,Original:0,Override:1},26:{GeosetType:27,Original:0,Override:1},27:{GeosetType:27,Original:0,Override:1},28:{GeosetType:13,Original:1,Override:0},31:{GeosetType:12,Original:1,Override:13},32:{GeosetType:12,Original:2,Override:14},33:{GeosetType:42,Original:11,Override:1}},wi={ITEM:1,HELM:2,SHOULDER:4,NPC:8,CHARACTER:16,HUMANOIDNPC:32,OBJECT:64,ARMOR:128,PATH:256,ITEMVISUAL:512,COLLECTION:1024},yi=[0,1,0,3,4,5,6,7,8,9,10,0,0,21,22,22,16,21,0,19,5,21,22,22,0,21,21,27],Ai=[0,16,0,15,1,8,10,5,6,6,7,0,0,17,18,19,14,20,0,9,8,21,22,23,0,24,25,0],Ei=[0,0,0,0,0,0,0,0,0,0,0,0,0,22,0,0,0,22,0,0,0,0,0,0,0,0,0,0],Ci=[0,2,0,4,128,128,128,128,128,128,128,0,0,1,1,1,128,1,0,128,128,1,1,1,0,1,1,2],Mi=[13,14,15,16,17,88,89],Si=[8,9,10,11,12,86,87],ki={77:[5,1,0,-1,5,0,0,-1],76:[10,0,1,1,10,0,1,1],75:[10,0,1,1,10,0,1,1],74:[5,1,0,-1,5,0,0,-1],73:[5,1,0,-1,5,0,0,-1],72:[5,1,0,-1,5,0,0,-1],71:[5,1,0,-1,5,0,0,-1],37:[7,0,7,1,7,0,7,1],36:[2,0,2,1,2,0,2,1],34:[3,0,3,1,3,0,3,1],33:[5,1,0,-1,5,0,0,-1],31:[0,-1,8,1,0,-1,8,1],30:[11,0,11,1,11,0,11,1],29:[10,0,10,1,10,0,10,1],28:[6,0,6,1,6,0,6,1],27:[4,0,4,1,4,0,4,1],26:[24,0,24,1,24,0,24,1],25:[24,0,24,1,24,0,24,1],23:[1,0,1,1,1,0,1,1],15:[5,0,5,1,5,0,5,1]},Di={21:26,22:27,15:28,17:26,25:32,13:32,23:33,14:28,26:26},Fi={0:{21:26,22:27},1:{21:26,22:27},2:{21:30,22:31},3:{21:32,22:33},4:{21:26,22:27,15:28},5:{21:26},6:{21:26,22:27},7:{21:26,22:27},8:{21:26,22:27},9:{21:33,22:28}};function Ri(){var t=new Ue(4);return Ue!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ui(t,e,i,r){var s=new Ue(4);return s[0]=t,s[1]=e,s[2]=i,s[3]=r,s}function Ii(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Oi(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Pi(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function zi(t){var e=t[0],i=t[1],r=t[2],s=t[3];return Math.hypot(e,i,r,s)}function Bi(t,e){var i=e[0],r=e[1],s=e[2],n=e[3],a=i*i+r*r+s*s+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=i*a,t[1]=r*a,t[2]=s*a,t[3]=n*a,t}function Li(t,e,i){var r=e[0],s=e[1],n=e[2],a=e[3];return t[0]=i[0]*r+i[4]*s+i[8]*n+i[12]*a,t[1]=i[1]*r+i[5]*s+i[9]*n+i[13]*a,t[2]=i[2]*r+i[6]*s+i[10]*n+i[14]*a,t[3]=i[3]*r+i[7]*s+i[11]*n+i[15]*a,t}var Ni=zi;Ri();const Hi=class{constructor(t){var e=this;e.a=ze(t.getFloat(),t.getFloat(),t.getFloat()),e.b=Ui(t.getFloat(),t.getFloat(),t.getFloat(),0),e.c=t.getFloat(),e.d=t.getFloat(),e.e=t.getFloat(),e.f=t.getFloat(),e.g=[t.getUint8(),t.getUint8(),t.getUint8(),t.getUint8()],e.h=[t.getUint8(),t.getUint8(),t.getUint8(),t.getUint8()],e.i=Oe(e.a),e.j=function(t){var e=new Ue(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}(e.b)}l(){var t=this;t.a=null,t.b=null,t.g=null,t.h=null,t.i=null,t.j=null}},Gi=class{constructor(t){var e=this;e.a=t.getUint16(),e.b=t.getUint16(),e.g=t.getUint32(),e.c=t.getUint32(),e.d=t.getUint16(),e.e=t.getUint16(),e.f=t.getUint16(),e.h=t.getInt16(),e.i=t.getUint16(),t.getBool()&&(e.j=t.getString())}k(){}};function ji(){var t=new Ue(2);return Ue!=Float32Array&&(t[0]=0,t[1]=0),t}function Wi(t,e){var i=new Ue(2);return i[0]=t,i[1]=e,i}function Vi(t,e,i){return t[0]=e,t[1]=i,t}function qi(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function Yi(){var t=new Ue(9);return Ue!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Xi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Zi(){var t=new Ue(4);return Ue!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}ji();var Ji=Ii,Ki=function(t,e,i,r,s){return t[0]=e,t[1]=i,t[2]=r,t[3]=s,t};Ie(),ze(1,0,0),ze(0,1,0),Zi(),Zi(),Yi();class $i{constructor(){this.a=-1,this.b=null,this.c=0}}class Qi{constructor(){this.a=new $i,this.b=new $i,this.c=0,this.d=!1}}class tr{f(){var t=this;if(t.b)for(var e=0;e<t.b.length;++e)t.b[e]=null;return t.a=null,t.b=null,null}k(t,e,i,r){let s=this;if(null==r&&(r=this.g()),this.d>=0&&(t=this.d<e.length?e[this.d]:e[0]),0!=s.c||s.b.length>1){if(s.a.length>1){var n=s.a[s.a.length-1];n>0&&t>n&&this.d<0&&(t%=n);for(var a=0,o=s.a.length,h=0;h<o;++h)if(t>=s.a[h]&&t<s.a[h+1]){a=h;break}var l=s.a[a],u=s.a[a+1],c=0;return l!=u&&(c=(t-l)/(u-l)),1==s.c?s.h(s.b[a],s.b[a+1],c,r):r=s.i(r,s.b[a])}return s.b.length>0?r=s.i(r,s.b[0]):i}return 0==s.b.length?r:r=s.i(r,s.b[0])}l(t){var e,i=this;i.c=t.getInt16(),i.d=t.getInt16(),i.e=t.getBool();var r=t.getInt32();for(i.a=new Array(r),e=0;e<r;++e)i.a[e]=t.getInt32();var s=t.getInt32();for(i.b=new Array(s),e=0;e<s;++e)i.b[e]=i.j(t)}}class er extends tr{constructor(t){super(),this.ba=Ie(),this.l(t)}g(){return Ie()}h(t,e,i,r){return $e(r,t,e,i)}i(t,e){return Be(t,e),t}j(t){return Le(Ie(),t.getFloat(),t.getFloat(),t.getFloat())}}class ir extends tr{constructor(t){super(),this.l(t),this.ba=Zi()}g(){return Zi()}h(t,e,i,r){return function(t,e,i,r){var s,n,a,o,h,l=e[0],u=e[1],c=e[2],f=e[3],d=i[0],b=i[1],_=i[2],g=i[3];return(n=l*d+u*b+c*_+f*g)<0&&(n=-n,d=-d,b=-b,_=-_,g=-g),1-n>Re?(s=Math.acos(n),a=Math.sin(s),o=Math.sin((1-r)*s)/a,h=Math.sin(r*s)/a):(o=1-r,h=r),t[0]=o*l+h*d,t[1]=o*u+h*b,t[2]=o*c+h*_,t[3]=o*f+h*g,t}(r,t,e,i)}i(t,e){return Ji(t,e),t}j(t){return Ki(Zi(),-t.getFloat(),-t.getFloat(),-t.getFloat(),t.getFloat())}}class rr extends tr{constructor(t){super(),this.l(t)}j(t){return t.getUint16()}g(){return 0}h(t,e,i,r){return t+(e-t)*i}i(t,e){return e}}class sr extends rr{j(t){return t.getFloat()}}class nr extends rr{j(t){return t.getUint8()}}class ar{d(){for(var t=this,e=0;e<t.b.length;++e)t.b[e]=null;return t.a=null,t.b=null,t.c=null,null}i(t,e,i,r){let s=this;i||(i=this.e());let n=r||s.b;if(s.b.length>1&&s.a.length>1){var a=s.a[s.a.length-1];a>0&&t>a&&(t%=a);for(var o=0,h=s.a.length,l=0;l<h-1;++l)if(t>s.a[l]&&t<=s.a[l+1]){o=l;break}var u=s.a[o],c=s.a[o+1],f=0;return u!=c&&(f=(t-u)/(c-u)),s.f(n[o],n[o+1],f,i)}return n.length>0?i=s.g(i,n[0]):e}j(t){var e,i=this,r=t.getInt32();for(i.a=new Array(r),e=0;e<r;++e)i.a[e]=t.getInt16()/32767;var s=t.getInt32();for(i.b=new Array(s),e=0;e<s;++e)i.b[e]=i.h(t)}}class or extends ar{constructor(t){super(),this.ba=ji(),this.j(t)}e(){return ji()}f(t,e,i,r){return s=r,a=e,o=i,h=(n=t)[0],l=n[1],s[0]=h+o*(a[0]-h),s[1]=l+o*(a[1]-l),s;var s,n,a,o,h,l}g(t,e){var i,r;return r=e,(i=t)[0]=r[0],i[1]=r[1],t}h(t){return Vi(ji(),t.getFloat(),t.getFloat())}}class hr extends ar{constructor(t){super(),this.j(t)}e(){return Ie()}f(t,e,i,r){return $e(r,t,e,i)}g(t,e){return Be(t,e),t}h(t){return Le(Ie(),t.getFloat(),t.getFloat(),t.getFloat())}}class lr extends ar{constructor(t){super(),this.j(t)}e(){return 0}f(t,e,i,r){return t+(e-t)*i}g(t,e){return t}h(t){return t.getUint16()}}class ur{constructor(t,e){this.b(t,e)}b(t,e){var i=t.getInt32();this.a=new Array(i);for(let r=0;r<i;++r)this.a[r]=new e(t)}c(t){return!(!this.a||0==this.a.length)&&(t>=this.a.length&&(t=0),this.a[t].e)}d(t,e,i,r){if(!this.a||0==this.a.length)return i;let s=t.a.a;s>=this.a.length&&(s=0);let n=this.a[s].k(t.a.c,e,i,r);if(t.c>0&&t.c<1){let s=this.a[0].g(),a=t.b.a;a>=this.a.length&&(a=0);let o=this.a[a].k(t.b.c,e,i,s);o||(o=s),s=this.a[0].g(),n=this.a[0].h(o,n,t.c,s),r&&this.a[0].i(r,s)}return n}e(){if(this.a&&0!=this.a.length){for(var t=0;t<this.a.length;++t)this.a[t].f(),this.a[t]=null;return null}}}function cr(t,e){return Ui(t[4*e+0],t[4*e+1],t[4*e+2],0)}function fr(t,e,i){for(let r=0;r<4;r++)t[4*e+r]=i[r]}const dr=class{constructor(t,e,i){this.v=null,this.w=null,this.x=null;var r=this;r.a=t,r.b=e,r.c=i.getInt32(),r.d=i.getUint32(),r.e=i.getInt16(),r.f=i.getUint16(),r.g=i.getUint32(),r.h=ze(i.getFloat(),i.getFloat(),i.getFloat()),r.i=new ur(i,er),r.j=new ur(i,ir),r.k=new ur(i,er),r.l=Ie(),r.m=ii(),r.n=ii(),r.o=ii(),r.p=Ie(),r.q=Zi(),r.r=ii(),r.s=!1,r.t=!1,r.u=!1}A(){var t=this;t.a=null,t.h=null,t.l=null,t.m=null,t.p=null,t.q=null,t.r=null,t.i.e(),t.j.e(),t.k.e(),t.i=null,t.j=null,t.k=null}B(){this.s=!0;for(var t=0;t<16;++t)this.m[t]=0}C(t){t?(null==this.v&&(this.v=new Qi),this.a.bv(t,this.v)):this.v=null;let e=this.a.ak[this.b];for(let i=0;i<e.length;i++)this.a.ar[e[i]].C(t)}D(t){t?(null==this.w&&(this.w=new Qi),this.a.bv(t,this.w)):this.w=null;let e=this.a.ak[this.b];for(let i=0;i<e.length;i++)this.a.ar[e[i]].D(t)}E(t){var e=this;if(e.s)return void e.B();if(null!=this.v&&this.a.cd(this.v,t),e.t||e.u)return;if(e.t=!0,!e.a)return;ni(e.m);var i=e.a.T;if(!i)return;let r=ii();if(hi(r,r,this.a.aT.viewMatrix),hi(r,r,this.a.W),hi(e.m,e.m,r),e.e>-1){e.a.ar[e.e].E(t);let i=ii();if(ri(i,e.a.ar[e.e].m),hi(i,r,i),1&e.d||2&e.d||4&e.d){if(4&e.d&&2&e.d)fr(i,0,cr(r,0)),fr(i,1,cr(r,1)),fr(i,2,cr(r,2));else if(4&e.d){{let t=cr(r,0),e=zi(t);Pi(t,t,zi(cr(i,0))/e),fr(i,0,t)}{let t=cr(r,1),e=zi(t);Pi(t,t,zi(cr(i,1))/e),fr(i,1,t)}{let t=cr(r,2),e=zi(t);Pi(t,t,zi(cr(i,2))/e),fr(i,2,t)}}else if(2&e.d){{let t=cr(r,0);Pi(t,t,1/zi(cr(i,0))),Pi(t,t,zi(cr(r,0))),fr(i,0,t)}{let t=cr(r,1);Pi(t,t,1/zi(cr(i,1))),Pi(t,t,zi(cr(r,1))),fr(i,1,t)}{let t=cr(r,2);Pi(t,t,1/zi(cr(i,2))),Pi(t,t,zi(cr(r,2))),fr(i,2,t)}}if(1&e.d)fr(i,3,cr(r,3));else{let t=Ui(e.h[0],e.h[1],e.h[2],1),s=Ri();Ii(s,t),s[3]=0;let n=Ri(),a=Ri();Li(n,t,e.a.ar[e.e].m),Li(n,n,r),Li(a,s,i),Oi(n,n,a),n[3]=1,fr(i,3,n)}}let s=ii();oi(s,r),hi(i,s,i),hi(e.m,e.m,i)}let s=null;if(null!=this.v){let t=this.F(this.v);this.a.U||(this.y=t),s=this.a.U?this.y:t}else{let t=this.F(i);this.a.U||(this.y=t),s=this.a.U?this.y:t}let n=null;if(null!=this.w){let t=this.F(this.w);this.a.U||(this.z=t),n=this.a.U?this.z:t}let a=null!=s||null!=n,o=ii();a&&(null!=s&&hi(o,o,s),null!=n&&hi(o,o,n)),null!=this.x&&(li(o,o,this.h),hi(o,o,this.x),li(o,o,Xe(this.p,this.h))),hi(e.m,e.m,o);let h=120&e.d;if(h){let t=ii();ri(t,e.m);let i=e.m,r=Ie();gi(r,e.m);let s=Ri();if(16==h){let t=cr(e.m,0);Pi(t,t,1/Pe(t)),fr(e.m,0,t);let r=Ui(i[4],-i[0],0,0);fr(i,1,Bi(r,r)),Ke(s,r,t),s[3]=0,fr(i,2,s)}else if(h>16){if(32==h){let t=cr(i,1);Pi(t,t,1/zi(t)),fr(e.m,1,t);let r=Ui(-i[5],i[1],0,0);fr(i,0,Bi(r,r)),s[3]=0,fr(i,2,s)}else if(64==h){let t=cr(i,2);Bi(t,t),fr(i,2,t);let e=Ui(t[1],-t[0],0,0);Bi(e,e),fr(i,1,e),Ke(s,t,e),s[3]=0,fr(i,0,s)}}else if(8==h){let t=this.a.i;if(a){let e=cr(o,0);e=Ui(e[1],e[2],-e[0],0),Bi(e,e),fr(i,0,e);let r=cr(o,1);r=Ui(t?-r[1]:r[1],t?-r[2]:r[2],t?r[0]:-r[0],0),Bi(r,r),fr(i,1,r);let s=cr(o,2);s=Ui(s[1],s[2],-s[0],0),Bi(s,s),fr(i,2,s)}else fr(i,0,Ui(0,0,-1,0)),fr(i,1,Ui(t?-1:1,0,0,0)),fr(i,2,Ui(0,1,0,0))}let n=Ui(this.h[0],this.h[1],this.h[2],1),l=Ui(this.h[0],this.h[1],this.h[2],0),u=cr(i,0),c=cr(i,1),f=cr(i,2);Pi(u,u,r[0]),Pi(c,c,r[1]),Pi(f,f,r[2]),fr(i,0,u),fr(i,1,c),fr(i,2,f),Li(n,n,t),Li(l,l,i);let d=Ri();Oi(d,n,l),d[3]=1,fr(i,3,d)}oi(r,r),hi(e.m,r,e.m),oi(e.n,e.m),ai(e.o,e.n),Qe(e.l,e.h,e.m)}F(t){var e,i,r,s,n,a,o,h,l,u,c,f,d,b,_,g,p,m,v=this.i.c(t.a.a),x=this.j.c(t.a.a),T=this.k.c(t.a.a);if(0!=(640&this.d)){let w=ii();return ni(w),li(w,w,this.h),v&&(this.p=this.i.d(t,this.a.aY),li(w,w,this.p)),x&&(this.q=this.j.d(t,this.a.aY,Zi()),e=this.r,u=(r=(i=this.q)[0])*(o=r+r),c=(s=i[1])*o,f=s*(h=s+s),d=(n=i[2])*o,b=n*h,_=n*(l=n+n),g=(a=i[3])*o,p=a*h,m=a*l,e[0]=1-f-_,e[1]=c+m,e[2]=d-p,e[3]=0,e[4]=c-m,e[5]=1-u-_,e[6]=b+g,e[7]=0,e[8]=d+p,e[9]=b-g,e[10]=1-u-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,hi(w,w,this.r)),T&&(this.p=this.k.d(t,this.a.aY),ui(w,w,this.p)),li(w,w,Xe(this.p,this.h)),w}return null}},br=class{constructor(t){var e=this;e.a=t.getUint16(),e.b=t.getUint16(),e.c=t.getUint16(),e.d=t.getUint16(),e.e=t.getUint16()+65536*e.b,e.f=t.getUint16(),e.g=t.getUint16(),e.h=ze(t.getFloat(),t.getFloat(),t.getFloat()),e.i=ze(t.getFloat(),t.getFloat(),t.getFloat()),e.j=t.getFloat()}k(){this.h=null,this.i=null}};function _r(t){let e=t.length;for(;--e>=0;)t[e]=0}const gr=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),pr=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),mr=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),vr=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xr=new Array(576);_r(xr);const Tr=new Array(60);_r(Tr);const wr=new Array(512);_r(wr);const yr=new Array(256);_r(yr);const Ar=new Array(29);_r(Ar);const Er=new Array(30);function Cr(t,e,i,r,s){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=r,this.max_length=s,this.has_stree=t&&t.length}let Mr,Sr,kr;function Dr(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}_r(Er);const Fr=t=>t<256?wr[t]:wr[256+(t>>>7)],Rr=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Ur=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,Rr(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},Ir=(t,e,i)=>{Ur(t,i[2*e],i[2*e+1])},Or=(t,e)=>{let i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1},Pr=(t,e,i)=>{const r=new Array(16);let s,n,a=0;for(s=1;s<=15;s++)a=a+i[s-1]<<1,r[s]=a;for(n=0;n<=e;n++){let e=t[2*n+1];0!==e&&(t[2*n]=Or(r[e]++,e))}},zr=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Br=t=>{t.bi_valid>8?Rr(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Lr=(t,e,i,r)=>{const s=2*e,n=2*i;return t[s]<t[n]||t[s]===t[n]&&r[e]<=r[i]},Nr=(t,e,i)=>{const r=t.heap[i];let s=i<<1;for(;s<=t.heap_len&&(s<t.heap_len&&Lr(e,t.heap[s+1],t.heap[s],t.depth)&&s++,!Lr(e,r,t.heap[s],t.depth));)t.heap[i]=t.heap[s],i=s,s<<=1;t.heap[i]=r},Hr=(t,e,i)=>{let r,s,n,a,o=0;if(0!==t.sym_next)do{r=255&t.pending_buf[t.sym_buf+o++],r+=(255&t.pending_buf[t.sym_buf+o++])<<8,s=t.pending_buf[t.sym_buf+o++],0===r?Ir(t,s,e):(n=yr[s],Ir(t,n+256+1,e),a=gr[n],0!==a&&(s-=Ar[n],Ur(t,s,a)),r--,n=Fr(r),Ir(t,n,i),a=pr[n],0!==a&&(r-=Er[n],Ur(t,r,a)))}while(o<t.sym_next);Ir(t,256,e)},Gr=(t,e)=>{const i=e.dyn_tree,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,n=e.stat_desc.elems;let a,o,h,l=-1;for(t.heap_len=0,t.heap_max=573,a=0;a<n;a++)0!==i[2*a]?(t.heap[++t.heap_len]=l=a,t.depth[a]=0):i[2*a+1]=0;for(;t.heap_len<2;)h=t.heap[++t.heap_len]=l<2?++l:0,i[2*h]=1,t.depth[h]=0,t.opt_len--,s&&(t.static_len-=r[2*h+1]);for(e.max_code=l,a=t.heap_len>>1;a>=1;a--)Nr(t,i,a);h=n;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Nr(t,i,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,i[2*h]=i[2*a]+i[2*o],t.depth[h]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,i[2*a+1]=i[2*o+1]=h,t.heap[1]=h++,Nr(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const i=e.dyn_tree,r=e.max_code,s=e.stat_desc.static_tree,n=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,h=e.stat_desc.max_length;let l,u,c,f,d,b,_=0;for(f=0;f<=15;f++)t.bl_count[f]=0;for(i[2*t.heap[t.heap_max]+1]=0,l=t.heap_max+1;l<573;l++)u=t.heap[l],f=i[2*i[2*u+1]+1]+1,f>h&&(f=h,_++),i[2*u+1]=f,u>r||(t.bl_count[f]++,d=0,u>=o&&(d=a[u-o]),b=i[2*u],t.opt_len+=b*(f+d),n&&(t.static_len+=b*(s[2*u+1]+d)));if(0!==_){do{for(f=h-1;0===t.bl_count[f];)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[h]--,_-=2}while(_>0);for(f=h;0!==f;f--)for(u=t.bl_count[f];0!==u;)c=t.heap[--l],c>r||(i[2*c+1]!==f&&(t.opt_len+=(f-i[2*c+1])*i[2*c],i[2*c+1]=f),u--)}})(t,e),Pr(i,l,t.bl_count)},jr=(t,e,i)=>{let r,s,n=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),e[2*(i+1)+1]=65535,r=0;r<=i;r++)s=a,a=e[2*(r+1)+1],++o<h&&s===a||(o<l?t.bl_tree[2*s]+=o:0!==s?(s!==n&&t.bl_tree[2*s]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,n=s,0===a?(h=138,l=3):s===a?(h=6,l=3):(h=7,l=4))},Wr=(t,e,i)=>{let r,s,n=-1,a=e[1],o=0,h=7,l=4;for(0===a&&(h=138,l=3),r=0;r<=i;r++)if(s=a,a=e[2*(r+1)+1],!(++o<h&&s===a)){if(o<l)do{Ir(t,s,t.bl_tree)}while(0!=--o);else 0!==s?(s!==n&&(Ir(t,s,t.bl_tree),o--),Ir(t,16,t.bl_tree),Ur(t,o-3,2)):o<=10?(Ir(t,17,t.bl_tree),Ur(t,o-3,3)):(Ir(t,18,t.bl_tree),Ur(t,o-11,7));o=0,n=s,0===a?(h=138,l=3):s===a?(h=6,l=3):(h=7,l=4)}};let Vr=!1;const qr=(t,e,i,r)=>{Ur(t,0+(r?1:0),3),Br(t),Rr(t,i),Rr(t,~i),i&&t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i};var Yr={_tr_init:t=>{Vr||((()=>{let t,e,i,r,s;const n=new Array(16);for(i=0,r=0;r<28;r++)for(Ar[r]=i,t=0;t<1<<gr[r];t++)yr[i++]=r;for(yr[i-1]=r,s=0,r=0;r<16;r++)for(Er[r]=s,t=0;t<1<<pr[r];t++)wr[s++]=r;for(s>>=7;r<30;r++)for(Er[r]=s<<7,t=0;t<1<<pr[r]-7;t++)wr[256+s++]=r;for(e=0;e<=15;e++)n[e]=0;for(t=0;t<=143;)xr[2*t+1]=8,t++,n[8]++;for(;t<=255;)xr[2*t+1]=9,t++,n[9]++;for(;t<=279;)xr[2*t+1]=7,t++,n[7]++;for(;t<=287;)xr[2*t+1]=8,t++,n[8]++;for(Pr(xr,287,n),t=0;t<30;t++)Tr[2*t+1]=5,Tr[2*t]=Or(t,5);Mr=new Cr(xr,gr,257,286,15),Sr=new Cr(Tr,pr,0,30,15),kr=new Cr(new Array(0),mr,0,19,7)})(),Vr=!0),t.l_desc=new Dr(t.dyn_ltree,Mr),t.d_desc=new Dr(t.dyn_dtree,Sr),t.bl_desc=new Dr(t.bl_tree,kr),t.bi_buf=0,t.bi_valid=0,zr(t)},_tr_stored_block:qr,_tr_flush_block:(t,e,i,r)=>{let s,n,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),Gr(t,t.l_desc),Gr(t,t.d_desc),a=(t=>{let e;for(jr(t,t.dyn_ltree,t.l_desc.max_code),jr(t,t.dyn_dtree,t.d_desc.max_code),Gr(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*vr[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),s=t.opt_len+3+7>>>3,n=t.static_len+3+7>>>3,n<=s&&(s=n)):s=n=i+5,i+4<=s&&-1!==e?qr(t,e,i,r):4===t.strategy||n===s?(Ur(t,2+(r?1:0),3),Hr(t,xr,Tr)):(Ur(t,4+(r?1:0),3),((t,e,i,r)=>{let s;for(Ur(t,e-257,5),Ur(t,i-1,5),Ur(t,r-4,4),s=0;s<r;s++)Ur(t,t.bl_tree[2*vr[s]+1],3);Wr(t,t.dyn_ltree,e-1),Wr(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),Hr(t,t.dyn_ltree,t.dyn_dtree)),zr(t),r&&Br(t)},_tr_tally:(t,e,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(yr[i]+256+1)]++,t.dyn_dtree[2*Fr(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{Ur(t,2,3),Ir(t,256,xr),(t=>{16===t.bi_valid?(Rr(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},Xr=(t,e,i,r)=>{let s=65535&t|0,n=t>>>16&65535|0,a=0;for(;0!==i;){a=i>2e3?2e3:i,i-=a;do{s=s+e[r++]|0,n=n+s|0}while(--a);s%=65521,n%=65521}return s|n<<16|0};const Zr=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var Jr=(t,e,i,r)=>{const s=Zr,n=r+i;t^=-1;for(let i=r;i<n;i++)t=t>>>8^s[255&(t^e[i])];return-1^t},Kr={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},$r={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Qr,_tr_stored_block:ts,_tr_flush_block:es,_tr_tally:is,_tr_align:rs}=Yr,{Z_NO_FLUSH:ss,Z_PARTIAL_FLUSH:ns,Z_FULL_FLUSH:as,Z_FINISH:os,Z_BLOCK:hs,Z_OK:ls,Z_STREAM_END:us,Z_STREAM_ERROR:cs,Z_DATA_ERROR:fs,Z_BUF_ERROR:ds,Z_DEFAULT_COMPRESSION:bs,Z_FILTERED:_s,Z_HUFFMAN_ONLY:gs,Z_RLE:ps,Z_FIXED:ms,Z_DEFAULT_STRATEGY:vs,Z_UNKNOWN:xs,Z_DEFLATED:Ts}=$r,ws=258,ys=262,As=42,Es=113,Cs=666,Ms=(t,e)=>(t.msg=Kr[e],e),Ss=t=>2*t-(t>4?9:0),ks=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Ds=t=>{let e,i,r,s=t.w_size;e=t.hash_size,r=e;do{i=t.head[--r],t.head[r]=i>=s?i-s:0}while(--e);e=s,r=e;do{i=t.prev[--r],t.prev[r]=i>=s?i-s:0}while(--e)};let Fs=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const Rs=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},Us=(t,e)=>{es(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Rs(t.strm)},Is=(t,e)=>{t.pending_buf[t.pending++]=e},Os=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Ps=(t,e,i,r)=>{let s=t.avail_in;return s>r&&(s=r),0===s?0:(t.avail_in-=s,e.set(t.input.subarray(t.next_in,t.next_in+s),i),1===t.state.wrap?t.adler=Xr(t.adler,e,s,i):2===t.state.wrap&&(t.adler=Jr(t.adler,e,s,i)),t.next_in+=s,t.total_in+=s,s)},zs=(t,e)=>{let i,r,s=t.max_chain_length,n=t.strstart,a=t.prev_length,o=t.nice_match;const h=t.strstart>t.w_size-ys?t.strstart-(t.w_size-ys):0,l=t.window,u=t.w_mask,c=t.prev,f=t.strstart+ws;let d=l[n+a-1],b=l[n+a];t.prev_length>=t.good_match&&(s>>=2),o>t.lookahead&&(o=t.lookahead);do{if(i=e,l[i+a]===b&&l[i+a-1]===d&&l[i]===l[n]&&l[++i]===l[n+1]){n+=2,i++;do{}while(l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&n<f);if(r=ws-(f-n),n=f-ws,r>a){if(t.match_start=e,a=r,r>=o)break;d=l[n+a-1],b=l[n+a]}}}while((e=c[e&u])>h&&0!=--s);return a<=t.lookahead?a:t.lookahead},Bs=t=>{const e=t.w_size;let i,r,s;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-ys)&&(t.window.set(t.window.subarray(e,e+e-r),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Ds(t),r+=e),0===t.strm.avail_in)break;if(i=Ps(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=i,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=Fs(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=Fs(t,t.ins_h,t.window[s+3-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<ys&&0!==t.strm.avail_in)},Ls=(t,e)=>{let i,r,s,n=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,a=0,o=t.strm.avail_in;do{if(i=65535,s=t.bi_valid+42>>3,t.strm.avail_out<s)break;if(s=t.strm.avail_out-s,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>s&&(i=s),i<n&&(0===i&&e!==os||e===ss||i!==r+t.strm.avail_in))break;a=e===os&&i===r+t.strm.avail_in?1:0,ts(t,0,0,a),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,Rs(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(Ps(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===a);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?4:e!==ss&&e!==os&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),s>t.strm.avail_in&&(s=t.strm.avail_in),s&&(Ps(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,s=t.pending_buf_size-s>65535?65535:t.pending_buf_size-s,n=s>t.w_size?t.w_size:s,r=t.strstart-t.block_start,(r>=n||(r||e===os)&&e!==ss&&0===t.strm.avail_in&&r<=s)&&(i=r>s?s:r,a=e===os&&0===t.strm.avail_in&&i===r?1:0,ts(t,t.block_start,i,a),t.block_start+=i,Rs(t.strm)),a?3:1)},Ns=(t,e)=>{let i,r;for(;;){if(t.lookahead<ys){if(Bs(t),t.lookahead<ys&&e===ss)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=Fs(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-ys&&(t.match_length=zs(t,i)),t.match_length>=3)if(r=is(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Fs(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Fs(t,t.ins_h,t.window[t.strstart+1]);else r=is(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(Us(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===os?(Us(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Us(t,!1),0===t.strm.avail_out)?1:2},Hs=(t,e)=>{let i,r,s;for(;;){if(t.lookahead<ys){if(Bs(t),t.lookahead<ys&&e===ss)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=Fs(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-ys&&(t.match_length=zs(t,i),t.match_length<=5&&(t.strategy===_s||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-3,r=is(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=s&&(t.ins_h=Fs(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(Us(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(r=is(t,0,t.window[t.strstart-1]),r&&Us(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=is(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===os?(Us(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Us(t,!1),0===t.strm.avail_out)?1:2};function Gs(t,e,i,r,s){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=r,this.func=s}const js=[new Gs(0,0,0,0,Ls),new Gs(4,4,8,4,Ns),new Gs(4,5,16,8,Ns),new Gs(4,6,32,32,Ns),new Gs(4,4,16,16,Hs),new Gs(8,16,32,32,Hs),new Gs(8,16,128,128,Hs),new Gs(8,32,128,256,Hs),new Gs(32,128,258,1024,Hs),new Gs(32,258,258,4096,Hs)];function Ws(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ts,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ks(this.dyn_ltree),ks(this.dyn_dtree),ks(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ks(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ks(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Vs=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==As&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==Es&&e.status!==Cs?1:0},qs=t=>{if(Vs(t))return Ms(t,cs);t.total_in=t.total_out=0,t.data_type=xs;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?As:Es,t.adler=2===e.wrap?0:1,e.last_flush=-2,Qr(e),ls},Ys=t=>{const e=qs(t);var i;return e===ls&&((i=t.state).window_size=2*i.w_size,ks(i.head),i.max_lazy_match=js[i.level].max_lazy,i.good_match=js[i.level].good_length,i.nice_match=js[i.level].nice_length,i.max_chain_length=js[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),e},Xs=(t,e,i,r,s,n)=>{if(!t)return cs;let a=1;if(e===bs&&(e=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),s<1||s>9||i!==Ts||r<8||r>15||e<0||e>9||n<0||n>ms||8===r&&1!==a)return Ms(t,cs);8===r&&(r=9);const o=new Ws;return t.state=o,o.strm=t,o.status=As,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=s+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<s+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=n,o.method=i,Ys(t)};var Zs={deflateInit:(t,e)=>Xs(t,e,Ts,15,8,vs),deflateInit2:Xs,deflateReset:Ys,deflateResetKeep:qs,deflateSetHeader:(t,e)=>Vs(t)||2!==t.state.wrap?cs:(t.state.gzhead=e,ls),deflate:(t,e)=>{if(Vs(t)||e>hs||e<0)return t?Ms(t,cs):cs;const i=t.state;if(!t.output||0!==t.avail_in&&!t.input||i.status===Cs&&e!==os)return Ms(t,0===t.avail_out?ds:cs);const r=i.last_flush;if(i.last_flush=e,0!==i.pending){if(Rs(t),0===t.avail_out)return i.last_flush=-1,ls}else if(0===t.avail_in&&Ss(e)<=Ss(r)&&e!==os)return Ms(t,ds);if(i.status===Cs&&0!==t.avail_in)return Ms(t,ds);if(i.status===As&&0===i.wrap&&(i.status=Es),i.status===As){let e=Ts+(i.w_bits-8<<4)<<8,r=-1;if(r=i.strategy>=gs||i.level<2?0:i.level<6?1:6===i.level?2:3,e|=r<<6,0!==i.strstart&&(e|=32),e+=31-e%31,Os(i,e),0!==i.strstart&&(Os(i,t.adler>>>16),Os(i,65535&t.adler)),t.adler=1,i.status=Es,Rs(t),0!==i.pending)return i.last_flush=-1,ls}if(57===i.status)if(t.adler=0,Is(i,31),Is(i,139),Is(i,8),i.gzhead)Is(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Is(i,255&i.gzhead.time),Is(i,i.gzhead.time>>8&255),Is(i,i.gzhead.time>>16&255),Is(i,i.gzhead.time>>24&255),Is(i,9===i.level?2:i.strategy>=gs||i.level<2?4:0),Is(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(Is(i,255&i.gzhead.extra.length),Is(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=Jr(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(Is(i,0),Is(i,0),Is(i,0),Is(i,0),Is(i,0),Is(i,9===i.level?2:i.strategy>=gs||i.level<2?4:0),Is(i,3),i.status=Es,Rs(t),0!==i.pending)return i.last_flush=-1,ls;if(69===i.status){if(i.gzhead.extra){let e=i.pending,r=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+r>i.pending_buf_size;){let s=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+s),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>e&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex+=s,Rs(t),0!==i.pending)return i.last_flush=-1,ls;e=0,r-=s}let s=new Uint8Array(i.gzhead.extra);i.pending_buf.set(s.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending+=r,i.gzhead.hcrc&&i.pending>e&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let e,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),Rs(t),0!==i.pending)return i.last_flush=-1,ls;r=0}e=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,Is(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let e,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),Rs(t),0!==i.pending)return i.last_flush=-1,ls;r=0}e=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,Is(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Rs(t),0!==i.pending))return i.last_flush=-1,ls;Is(i,255&t.adler),Is(i,t.adler>>8&255),t.adler=0}if(i.status=Es,Rs(t),0!==i.pending)return i.last_flush=-1,ls}if(0!==t.avail_in||0!==i.lookahead||e!==ss&&i.status!==Cs){let r=0===i.level?Ls(i,e):i.strategy===gs?((t,e)=>{let i;for(;;){if(0===t.lookahead&&(Bs(t),0===t.lookahead)){if(e===ss)return 1;break}if(t.match_length=0,i=is(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(Us(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===os?(Us(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Us(t,!1),0===t.strm.avail_out)?1:2})(i,e):i.strategy===ps?((t,e)=>{let i,r,s,n;const a=t.window;for(;;){if(t.lookahead<=ws){if(Bs(t),t.lookahead<=ws&&e===ss)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(s=t.strstart-1,r=a[s],r===a[++s]&&r===a[++s]&&r===a[++s])){n=t.strstart+ws;do{}while(r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&s<n);t.match_length=ws-(n-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=is(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=is(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(Us(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===os?(Us(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Us(t,!1),0===t.strm.avail_out)?1:2})(i,e):js[i.level].func(i,e);if(3!==r&&4!==r||(i.status=Cs),1===r||3===r)return 0===t.avail_out&&(i.last_flush=-1),ls;if(2===r&&(e===ns?rs(i):e!==hs&&(ts(i,0,0,!1),e===as&&(ks(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),Rs(t),0===t.avail_out))return i.last_flush=-1,ls}return e!==os?ls:i.wrap<=0?us:(2===i.wrap?(Is(i,255&t.adler),Is(i,t.adler>>8&255),Is(i,t.adler>>16&255),Is(i,t.adler>>24&255),Is(i,255&t.total_in),Is(i,t.total_in>>8&255),Is(i,t.total_in>>16&255),Is(i,t.total_in>>24&255)):(Os(i,t.adler>>>16),Os(i,65535&t.adler)),Rs(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?ls:us)},deflateEnd:t=>{if(Vs(t))return cs;const e=t.state.status;return t.state=null,e===Es?Ms(t,fs):ls},deflateSetDictionary:(t,e)=>{let i=e.length;if(Vs(t))return cs;const r=t.state,s=r.wrap;if(2===s||1===s&&r.status!==As||r.lookahead)return cs;if(1===s&&(t.adler=Xr(t.adler,e,i,0)),r.wrap=0,i>=r.w_size){0===s&&(ks(r.head),r.strstart=0,r.block_start=0,r.insert=0);let t=new Uint8Array(r.w_size);t.set(e.subarray(i-r.w_size,i),0),e=t,i=r.w_size}const n=t.avail_in,a=t.next_in,o=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Bs(r);r.lookahead>=3;){let t=r.strstart,e=r.lookahead-2;do{r.ins_h=Fs(r,r.ins_h,r.window[t+3-1]),r.prev[t&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=t,t++}while(--e);r.strstart=t,r.lookahead=2,Bs(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=a,t.input=o,t.avail_in=n,r.wrap=s,ls},deflateInfo:"pako deflate (from Nodeca project)"};const Js=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Ks={assign:function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const e in i)Js(i,e)&&(t[e]=i[e])}}return t},flattenChunks:t=>{let e=0;for(let i=0,r=t.length;i<r;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,r=0,s=t.length;e<s;e++){let s=t[e];i.set(s,r),r+=s.length}return i}};let $s=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){$s=!1}const Qs=new Uint8Array(256);for(let t=0;t<256;t++)Qs[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Qs[254]=Qs[254]=1;var tn={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,i,r,s,n,a=t.length,o=0;for(s=0;s<a;s++)i=t.charCodeAt(s),55296==(64512&i)&&s+1<a&&(r=t.charCodeAt(s+1),56320==(64512&r)&&(i=65536+(i-55296<<10)+(r-56320),s++)),o+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(o),n=0,s=0;n<o;s++)i=t.charCodeAt(s),55296==(64512&i)&&s+1<a&&(r=t.charCodeAt(s+1),56320==(64512&r)&&(i=65536+(i-55296<<10)+(r-56320),s++)),i<128?e[n++]=i:i<2048?(e[n++]=192|i>>>6,e[n++]=128|63&i):i<65536?(e[n++]=224|i>>>12,e[n++]=128|i>>>6&63,e[n++]=128|63&i):(e[n++]=240|i>>>18,e[n++]=128|i>>>12&63,e[n++]=128|i>>>6&63,e[n++]=128|63&i);return e},buf2string:(t,e)=>{const i=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let r,s;const n=new Array(2*i);for(s=0,r=0;r<i;){let e=t[r++];if(e<128){n[s++]=e;continue}let a=Qs[e];if(a>4)n[s++]=65533,r+=a-1;else{for(e&=2===a?31:3===a?15:7;a>1&&r<i;)e=e<<6|63&t[r++],a--;a>1?n[s++]=65533:e<65536?n[s++]=e:(e-=65536,n[s++]=55296|e>>10&1023,n[s++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&$s)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let r=0;r<e;r++)i+=String.fromCharCode(t[r]);return i})(n,s)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+Qs[t[i]]>e?i:e}},en=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const rn=Object.prototype.toString,{Z_NO_FLUSH:sn,Z_SYNC_FLUSH:nn,Z_FULL_FLUSH:an,Z_FINISH:on,Z_OK:hn,Z_STREAM_END:ln,Z_DEFAULT_COMPRESSION:un,Z_DEFAULT_STRATEGY:cn,Z_DEFLATED:fn}=$r;function dn(t){this.options=Ks.assign({level:un,method:fn,chunkSize:16384,windowBits:15,memLevel:8,strategy:cn},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new en,this.strm.avail_out=0;let i=Zs.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==hn)throw new Error(Kr[i]);if(e.header&&Zs.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?tn.string2buf(e.dictionary):"[object ArrayBuffer]"===rn.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=Zs.deflateSetDictionary(this.strm,t),i!==hn)throw new Error(Kr[i]);this._dict_set=!0}}function bn(t,e){const i=new dn(e);if(i.push(t,!0),i.err)throw i.msg||Kr[i.err];return i.result}dn.prototype.push=function(t,e){const i=this.strm,r=this.options.chunkSize;let s,n;if(this.ended)return!1;for(n=e===~~e?e:!0===e?on:sn,"string"==typeof t?i.input=tn.string2buf(t):"[object ArrayBuffer]"===rn.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),(n===nn||n===an)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(s=Zs.deflate(i,n),s===ln)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),s=Zs.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===hn;if(0!==i.avail_out){if(n>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},dn.prototype.onData=function(t){this.chunks.push(t)},dn.prototype.onEnd=function(t){t===hn&&(this.result=Ks.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var _n={Deflate:dn,deflate:bn,deflateRaw:function(t,e){return(e=e||{}).raw=!0,bn(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,bn(t,e)},constants:$r};const gn=16209;var pn=function(t,e){let i,r,s,n,a,o,h,l,u,c,f,d,b,_,g,p,m,v,x,T,w,y,A,E;const C=t.state;i=t.next_in,A=t.input,r=i+(t.avail_in-5),s=t.next_out,E=t.output,n=s-(e-t.avail_out),a=s+(t.avail_out-257),o=C.dmax,h=C.wsize,l=C.whave,u=C.wnext,c=C.window,f=C.hold,d=C.bits,b=C.lencode,_=C.distcode,g=(1<<C.lenbits)-1,p=(1<<C.distbits)-1;t:do{d<15&&(f+=A[i++]<<d,d+=8,f+=A[i++]<<d,d+=8),m=b[f&g];e:for(;;){if(v=m>>>24,f>>>=v,d-=v,v=m>>>16&255,0===v)E[s++]=65535&m;else{if(!(16&v)){if(0==(64&v)){m=b[(65535&m)+(f&(1<<v)-1)];continue e}if(32&v){C.mode=16191;break t}t.msg="invalid literal/length code",C.mode=gn;break t}x=65535&m,v&=15,v&&(d<v&&(f+=A[i++]<<d,d+=8),x+=f&(1<<v)-1,f>>>=v,d-=v),d<15&&(f+=A[i++]<<d,d+=8,f+=A[i++]<<d,d+=8),m=_[f&p];i:for(;;){if(v=m>>>24,f>>>=v,d-=v,v=m>>>16&255,!(16&v)){if(0==(64&v)){m=_[(65535&m)+(f&(1<<v)-1)];continue i}t.msg="invalid distance code",C.mode=gn;break t}if(T=65535&m,v&=15,d<v&&(f+=A[i++]<<d,d+=8,d<v&&(f+=A[i++]<<d,d+=8)),T+=f&(1<<v)-1,T>o){t.msg="invalid distance too far back",C.mode=gn;break t}if(f>>>=v,d-=v,v=s-n,T>v){if(v=T-v,v>l&&C.sane){t.msg="invalid distance too far back",C.mode=gn;break t}if(w=0,y=c,0===u){if(w+=h-v,v<x){x-=v;do{E[s++]=c[w++]}while(--v);w=s-T,y=E}}else if(u<v){if(w+=h+u-v,v-=u,v<x){x-=v;do{E[s++]=c[w++]}while(--v);if(w=0,u<x){v=u,x-=v;do{E[s++]=c[w++]}while(--v);w=s-T,y=E}}}else if(w+=u-v,v<x){x-=v;do{E[s++]=c[w++]}while(--v);w=s-T,y=E}for(;x>2;)E[s++]=y[w++],E[s++]=y[w++],E[s++]=y[w++],x-=3;x&&(E[s++]=y[w++],x>1&&(E[s++]=y[w++]))}else{w=s-T;do{E[s++]=E[w++],E[s++]=E[w++],E[s++]=E[w++],x-=3}while(x>2);x&&(E[s++]=E[w++],x>1&&(E[s++]=E[w++]))}break}}break}}while(i<r&&s<a);x=d>>3,i-=x,d-=x<<3,f&=(1<<d)-1,t.next_in=i,t.next_out=s,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=s<a?a-s+257:257-(s-a),C.hold=f,C.bits=d};const mn=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),vn=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),xn=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Tn=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var wn=(t,e,i,r,s,n,a,o)=>{const h=o.bits;let l,u,c,f,d,b,_=0,g=0,p=0,m=0,v=0,x=0,T=0,w=0,y=0,A=0,E=null;const C=new Uint16Array(16),M=new Uint16Array(16);let S,k,D,F=null;for(_=0;_<=15;_++)C[_]=0;for(g=0;g<r;g++)C[e[i+g]]++;for(v=h,m=15;m>=1&&0===C[m];m--);if(v>m&&(v=m),0===m)return s[n++]=20971520,s[n++]=20971520,o.bits=1,0;for(p=1;p<m&&0===C[p];p++);for(v<p&&(v=p),w=1,_=1;_<=15;_++)if(w<<=1,w-=C[_],w<0)return-1;if(w>0&&(0===t||1!==m))return-1;for(M[1]=0,_=1;_<15;_++)M[_+1]=M[_]+C[_];for(g=0;g<r;g++)0!==e[i+g]&&(a[M[e[i+g]]++]=g);if(0===t?(E=F=a,b=20):1===t?(E=mn,F=vn,b=257):(E=xn,F=Tn,b=0),A=0,g=0,_=p,d=n,x=v,T=0,c=-1,y=1<<v,f=y-1,1===t&&y>852||2===t&&y>592)return 1;for(;;){S=_-T,a[g]+1<b?(k=0,D=a[g]):a[g]>=b?(k=F[a[g]-b],D=E[a[g]-b]):(k=96,D=0),l=1<<_-T,u=1<<x,p=u;do{u-=l,s[d+(A>>T)+u]=S<<24|k<<16|D|0}while(0!==u);for(l=1<<_-1;A&l;)l>>=1;if(0!==l?(A&=l-1,A+=l):A=0,g++,0==--C[_]){if(_===m)break;_=e[i+a[g]]}if(_>v&&(A&f)!==c){for(0===T&&(T=v),d+=p,x=_-T,w=1<<x;x+T<m&&(w-=C[x+T],!(w<=0));)x++,w<<=1;if(y+=1<<x,1===t&&y>852||2===t&&y>592)return 1;c=A&f,s[c]=v<<24|x<<16|d-n|0}}return 0!==A&&(s[d+A]=_-T<<24|64<<16|0),o.bits=v,0};const{Z_FINISH:yn,Z_BLOCK:An,Z_TREES:En,Z_OK:Cn,Z_STREAM_END:Mn,Z_NEED_DICT:Sn,Z_STREAM_ERROR:kn,Z_DATA_ERROR:Dn,Z_MEM_ERROR:Fn,Z_BUF_ERROR:Rn,Z_DEFLATED:Un}=$r,In=16180,On=16190,Pn=16191,zn=16192,Bn=16194,Ln=16199,Nn=16200,Hn=16206,Gn=16209,jn=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Wn(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Vn=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<In||e.mode>16211?1:0},qn=t=>{if(Vn(t))return kn;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=In,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,Cn},Yn=t=>{if(Vn(t))return kn;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,qn(t)},Xn=(t,e)=>{let i;if(Vn(t))return kn;const r=t.state;return e<0?(i=0,e=-e):(i=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?kn:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=i,r.wbits=e,Yn(t))},Zn=(t,e)=>{if(!t)return kn;const i=new Wn;t.state=i,i.strm=t,i.window=null,i.mode=In;const r=Xn(t,e);return r!==Cn&&(t.state=null),r};let Jn,Kn,$n=!0;const Qn=t=>{if($n){Jn=new Int32Array(512),Kn=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(wn(1,t.lens,0,288,Jn,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;wn(2,t.lens,0,32,Kn,0,t.work,{bits:5}),$n=!1}t.lencode=Jn,t.lenbits=9,t.distcode=Kn,t.distbits=5},ta=(t,e,i,r)=>{let s;const n=t.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),r>=n.wsize?(n.window.set(e.subarray(i-n.wsize,i),0),n.wnext=0,n.whave=n.wsize):(s=n.wsize-n.wnext,s>r&&(s=r),n.window.set(e.subarray(i-r,i-r+s),n.wnext),(r-=s)?(n.window.set(e.subarray(i-r,i),0),n.wnext=r,n.whave=n.wsize):(n.wnext+=s,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=s))),0};var ea={inflateReset:Yn,inflateReset2:Xn,inflateResetKeep:qn,inflateInit:t=>Zn(t,15),inflateInit2:Zn,inflate:(t,e)=>{let i,r,s,n,a,o,h,l,u,c,f,d,b,_,g,p,m,v,x,T,w,y,A=0;const E=new Uint8Array(4);let C,M;const S=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Vn(t)||!t.output||!t.input&&0!==t.avail_in)return kn;i=t.state,i.mode===Pn&&(i.mode=zn),a=t.next_out,s=t.output,h=t.avail_out,n=t.next_in,r=t.input,o=t.avail_in,l=i.hold,u=i.bits,c=o,f=h,y=Cn;t:for(;;)switch(i.mode){case In:if(0===i.wrap){i.mode=zn;break}for(;u<16;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(2&i.wrap&&35615===l){0===i.wbits&&(i.wbits=15),i.check=0,E[0]=255&l,E[1]=l>>>8&255,i.check=Jr(i.check,E,2,0),l=0,u=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",i.mode=Gn;break}if((15&l)!==Un){t.msg="unknown compression method",i.mode=Gn;break}if(l>>>=4,u-=4,w=8+(15&l),0===i.wbits&&(i.wbits=w),w>15||w>i.wbits){t.msg="invalid window size",i.mode=Gn;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=512&l?16189:Pn,l=0,u=0;break;case 16181:for(;u<16;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(i.flags=l,(255&i.flags)!==Un){t.msg="unknown compression method",i.mode=Gn;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=Gn;break}i.head&&(i.head.text=l>>8&1),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=Jr(i.check,E,2,0)),l=0,u=0,i.mode=16182;case 16182:for(;u<32;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}i.head&&(i.head.time=l),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,E[2]=l>>>16&255,E[3]=l>>>24&255,i.check=Jr(i.check,E,4,0)),l=0,u=0,i.mode=16183;case 16183:for(;u<16;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}i.head&&(i.head.xflags=255&l,i.head.os=l>>8),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=Jr(i.check,E,2,0)),l=0,u=0,i.mode=16184;case 16184:if(1024&i.flags){for(;u<16;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}i.length=l,i.head&&(i.head.extra_len=l),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=Jr(i.check,E,2,0)),l=0,u=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(d=i.length,d>o&&(d=o),d&&(i.head&&(w=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(r.subarray(n,n+d),w)),512&i.flags&&4&i.wrap&&(i.check=Jr(i.check,r,d,n)),o-=d,n+=d,i.length-=d),i.length))break t;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===o)break t;d=0;do{w=r[n+d++],i.head&&w&&i.length<65536&&(i.head.name+=String.fromCharCode(w))}while(w&&d<o);if(512&i.flags&&4&i.wrap&&(i.check=Jr(i.check,r,d,n)),o-=d,n+=d,w)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===o)break t;d=0;do{w=r[n+d++],i.head&&w&&i.length<65536&&(i.head.comment+=String.fromCharCode(w))}while(w&&d<o);if(512&i.flags&&4&i.wrap&&(i.check=Jr(i.check,r,d,n)),o-=d,n+=d,w)break t}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;u<16;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(4&i.wrap&&l!==(65535&i.check)){t.msg="header crc mismatch",i.mode=Gn;break}l=0,u=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Pn;break;case 16189:for(;u<32;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}t.adler=i.check=jn(l),l=0,u=0,i.mode=On;case On:if(0===i.havedict)return t.next_out=a,t.avail_out=h,t.next_in=n,t.avail_in=o,i.hold=l,i.bits=u,Sn;t.adler=i.check=1,i.mode=Pn;case Pn:if(e===An||e===En)break t;case zn:if(i.last){l>>>=7&u,u-=7&u,i.mode=Hn;break}for(;u<3;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}switch(i.last=1&l,l>>>=1,u-=1,3&l){case 0:i.mode=16193;break;case 1:if(Qn(i),i.mode=Ln,e===En){l>>>=2,u-=2;break t}break;case 2:i.mode=16196;break;case 3:t.msg="invalid block type",i.mode=Gn}l>>>=2,u-=2;break;case 16193:for(l>>>=7&u,u-=7&u;u<32;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){t.msg="invalid stored block lengths",i.mode=Gn;break}if(i.length=65535&l,l=0,u=0,i.mode=Bn,e===En)break t;case Bn:i.mode=16195;case 16195:if(d=i.length,d){if(d>o&&(d=o),d>h&&(d=h),0===d)break t;s.set(r.subarray(n,n+d),a),o-=d,n+=d,h-=d,a+=d,i.length-=d;break}i.mode=Pn;break;case 16196:for(;u<14;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(i.nlen=257+(31&l),l>>>=5,u-=5,i.ndist=1+(31&l),l>>>=5,u-=5,i.ncode=4+(15&l),l>>>=4,u-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=Gn;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;u<3;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}i.lens[S[i.have++]]=7&l,l>>>=3,u-=3}for(;i.have<19;)i.lens[S[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,C={bits:i.lenbits},y=wn(0,i.lens,0,19,i.lencode,0,i.work,C),i.lenbits=C.bits,y){t.msg="invalid code lengths set",i.mode=Gn;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;A=i.lencode[l&(1<<i.lenbits)-1],g=A>>>24,p=A>>>16&255,m=65535&A,!(g<=u);){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(m<16)l>>>=g,u-=g,i.lens[i.have++]=m;else{if(16===m){for(M=g+2;u<M;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(l>>>=g,u-=g,0===i.have){t.msg="invalid bit length repeat",i.mode=Gn;break}w=i.lens[i.have-1],d=3+(3&l),l>>>=2,u-=2}else if(17===m){for(M=g+3;u<M;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}l>>>=g,u-=g,w=0,d=3+(7&l),l>>>=3,u-=3}else{for(M=g+7;u<M;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}l>>>=g,u-=g,w=0,d=11+(127&l),l>>>=7,u-=7}if(i.have+d>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=Gn;break}for(;d--;)i.lens[i.have++]=w}}if(i.mode===Gn)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=Gn;break}if(i.lenbits=9,C={bits:i.lenbits},y=wn(1,i.lens,0,i.nlen,i.lencode,0,i.work,C),i.lenbits=C.bits,y){t.msg="invalid literal/lengths set",i.mode=Gn;break}if(i.distbits=6,i.distcode=i.distdyn,C={bits:i.distbits},y=wn(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,C),i.distbits=C.bits,y){t.msg="invalid distances set",i.mode=Gn;break}if(i.mode=Ln,e===En)break t;case Ln:i.mode=Nn;case Nn:if(o>=6&&h>=258){t.next_out=a,t.avail_out=h,t.next_in=n,t.avail_in=o,i.hold=l,i.bits=u,pn(t,f),a=t.next_out,s=t.output,h=t.avail_out,n=t.next_in,r=t.input,o=t.avail_in,l=i.hold,u=i.bits,i.mode===Pn&&(i.back=-1);break}for(i.back=0;A=i.lencode[l&(1<<i.lenbits)-1],g=A>>>24,p=A>>>16&255,m=65535&A,!(g<=u);){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(p&&0==(240&p)){for(v=g,x=p,T=m;A=i.lencode[T+((l&(1<<v+x)-1)>>v)],g=A>>>24,p=A>>>16&255,m=65535&A,!(v+g<=u);){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}l>>>=v,u-=v,i.back+=v}if(l>>>=g,u-=g,i.back+=g,i.length=m,0===p){i.mode=16205;break}if(32&p){i.back=-1,i.mode=Pn;break}if(64&p){t.msg="invalid literal/length code",i.mode=Gn;break}i.extra=15&p,i.mode=16201;case 16201:if(i.extra){for(M=i.extra;u<M;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}i.length+=l&(1<<i.extra)-1,l>>>=i.extra,u-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;A=i.distcode[l&(1<<i.distbits)-1],g=A>>>24,p=A>>>16&255,m=65535&A,!(g<=u);){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(0==(240&p)){for(v=g,x=p,T=m;A=i.distcode[T+((l&(1<<v+x)-1)>>v)],g=A>>>24,p=A>>>16&255,m=65535&A,!(v+g<=u);){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}l>>>=v,u-=v,i.back+=v}if(l>>>=g,u-=g,i.back+=g,64&p){t.msg="invalid distance code",i.mode=Gn;break}i.offset=m,i.extra=15&p,i.mode=16203;case 16203:if(i.extra){for(M=i.extra;u<M;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}i.offset+=l&(1<<i.extra)-1,l>>>=i.extra,u-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=Gn;break}i.mode=16204;case 16204:if(0===h)break t;if(d=f-h,i.offset>d){if(d=i.offset-d,d>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=Gn;break}d>i.wnext?(d-=i.wnext,b=i.wsize-d):b=i.wnext-d,d>i.length&&(d=i.length),_=i.window}else _=s,b=a-i.offset,d=i.length;d>h&&(d=h),h-=d,i.length-=d;do{s[a++]=_[b++]}while(--d);0===i.length&&(i.mode=Nn);break;case 16205:if(0===h)break t;s[a++]=i.length,h--,i.mode=Nn;break;case Hn:if(i.wrap){for(;u<32;){if(0===o)break t;o--,l|=r[n++]<<u,u+=8}if(f-=h,t.total_out+=f,i.total+=f,4&i.wrap&&f&&(t.adler=i.check=i.flags?Jr(i.check,s,f,a-f):Xr(i.check,s,f,a-f)),f=h,4&i.wrap&&(i.flags?l:jn(l))!==i.check){t.msg="incorrect data check",i.mode=Gn;break}l=0,u=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;u<32;){if(0===o)break t;o--,l+=r[n++]<<u,u+=8}if(4&i.wrap&&l!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=Gn;break}l=0,u=0}i.mode=16208;case 16208:y=Mn;break t;case Gn:y=Dn;break t;case 16210:return Fn;default:return kn}return t.next_out=a,t.avail_out=h,t.next_in=n,t.avail_in=o,i.hold=l,i.bits=u,(i.wsize||f!==t.avail_out&&i.mode<Gn&&(i.mode<Hn||e!==yn))&&ta(t,t.output,t.next_out,f-t.avail_out),c-=t.avail_in,f-=t.avail_out,t.total_in+=c,t.total_out+=f,i.total+=f,4&i.wrap&&f&&(t.adler=i.check=i.flags?Jr(i.check,s,f,t.next_out-f):Xr(i.check,s,f,t.next_out-f)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Pn?128:0)+(i.mode===Ln||i.mode===Bn?256:0),(0===c&&0===f||e===yn)&&y===Cn&&(y=Rn),y},inflateEnd:t=>{if(Vn(t))return kn;let e=t.state;return e.window&&(e.window=null),t.state=null,Cn},inflateGetHeader:(t,e)=>{if(Vn(t))return kn;const i=t.state;return 0==(2&i.wrap)?kn:(i.head=e,e.done=!1,Cn)},inflateSetDictionary:(t,e)=>{const i=e.length;let r,s,n;return Vn(t)?kn:(r=t.state,0!==r.wrap&&r.mode!==On?kn:r.mode===On&&(s=1,s=Xr(s,e,i,0),s!==r.check)?Dn:(n=ta(t,e,i,i),n?(r.mode=16210,Fn):(r.havedict=1,Cn)))},inflateInfo:"pako inflate (from Nodeca project)"},ia=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ra=Object.prototype.toString,{Z_NO_FLUSH:sa,Z_FINISH:na,Z_OK:aa,Z_STREAM_END:oa,Z_NEED_DICT:ha,Z_STREAM_ERROR:la,Z_DATA_ERROR:ua,Z_MEM_ERROR:ca}=$r;function fa(t){this.options=Ks.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new en,this.strm.avail_out=0;let i=ea.inflateInit2(this.strm,e.windowBits);if(i!==aa)throw new Error(Kr[i]);if(this.header=new ia,ea.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=tn.string2buf(e.dictionary):"[object ArrayBuffer]"===ra.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=ea.inflateSetDictionary(this.strm,e.dictionary),i!==aa)))throw new Error(Kr[i])}function da(t,e){const i=new fa(e);if(i.push(t),i.err)throw i.msg||Kr[i.err];return i.result}fa.prototype.push=function(t,e){const i=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let n,a,o;if(this.ended)return!1;for(a=e===~~e?e:!0===e?na:sa,"[object ArrayBuffer]"===ra.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),n=ea.inflate(i,a),n===ha&&s&&(n=ea.inflateSetDictionary(i,s),n===aa?n=ea.inflate(i,a):n===ua&&(n=ha));i.avail_in>0&&n===oa&&i.state.wrap>0&&0!==t[i.next_in];)ea.inflateReset(i),n=ea.inflate(i,a);switch(n){case la:case ua:case ha:case ca:return this.onEnd(n),this.ended=!0,!1}if(o=i.avail_out,i.next_out&&(0===i.avail_out||n===oa))if("string"===this.options.to){let t=tn.utf8border(i.output,i.next_out),e=i.next_out-t,s=tn.buf2string(i.output,t);i.next_out=e,i.avail_out=r-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(s)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(n!==aa||0!==o){if(n===oa)return n=ea.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},fa.prototype.onData=function(t){this.chunks.push(t)},fa.prototype.onEnd=function(t){t===aa&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ks.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var ba={Inflate:fa,inflate:da,inflateRaw:function(t,e){return(e=e||{}).raw=!0,da(t,e)},ungzip:da,constants:$r};const{Deflate:_a,deflate:ga,deflateRaw:pa,gzip:ma}=_n,{Inflate:va,inflate:xa,inflateRaw:Ta,ungzip:wa}=ba;var ya=xa;const Aa=class{constructor(t){this.a=t.getUint16(),this.b=t.getUint16()}static c(t){t.E=!1,t.o.ax&&t.g<t.o.ax.length?t.r=t.o.ax[t.g]:t.r={a:0,b:0},t.x=0!=(1&t.r.a),t.y=0==(4&t.r.a),t.z=0!=(16&t.r.a)}};class Ea{static a(t){const e=32767&t;return e<Ca.length?Ca[e]:["PS_Combiners_Opaque","VS_Diffuse_T1"]}static b(t,e){return-1e3==t&&3==e?"Skin":32768&t?Ea.a(t)[0]:1==e?112&t?"PS_Combiners_Mod":"PS_Combiners_Opaque":(112&t?"PS_Combiners_Mod":"PS_Combiners_Opaque")+"_"+(112&t?["Opaque","Mod","Mod","Add","Mod2x","Mod","Mod2xNA","AddNA"]:["Opaque","Mod","Mod","AddAlpha","Mod2x","Mod","Mod2xNA","AddAlpha"])[7&t]}static c(t,e){var i="";if(-1e3==t&&3==e)i="T1_T1_T1";else{if(32768&t)return Ea.a(t)[1];i=1==e?128&t?"Env":16384&t?"T2":"T1":128&t?8&t?"Env_Env":"Env_T1":8&t?"T1_Env":16384&t?"T1_T2":"T1_T1"}return"VS_Diffuse_"+i}static d(t,e,i){var r=Ea.b(t,e),s=Ea.c(t,e),n="Wow."+s+"_"+r;if(De._GetProgram(n))return{name:n};var a={shaders:[Ea.g(s),Ea.h(s,r,i)],attributes:{position:"aPosition",normal:"aNormal",texcoord0:"aTexCoord0",texcoord1:"aTexCoord1"}};return De.RegisterProgram(n,a),{name:n}}static e(t){var e={},i={texcoord1:function(t,e){t.INPUT_TEXCOORD1="aTexCoord"+e}};for(var r in t.options){var s=t.options[r];i[r](e,s)}return{name:"Wow."+t.name,config:e}}static f(t){var e="";if(e+="lTexCoord1 = (uTextureMatrix1 * vec4(vTexCoord1, 0, 1)).st;\n",e+="lTexCoord2 = (uTextureMatrix2 * vec4(vTexCoord2, 0, 1)).st;\n","VS"===t.slice(0,2)){var i=(t=t.slice(3)).split("_"),r=i[0];if("Diffuse"===r||"Color"===r){e="",i.splice(0,1);var s={T1:["uTextureMatrix1","vTexCoord1"],T2:["uTextureMatrix2","vTexCoord2"],T3:["","aTexCoord2"],Env:["","texEnv"]},n=1;for(var a in i)s[i[a]]&&(s[i[a]][0]&&"texEnv"!=s[i[a]][1]?e+="lTexCoord"+n+" = ("+s[i[a]][0]+" * vec4("+s[i[a]][1]+", 0, 1)).st;\n":"texEnv"==s[i[a]][1]?e+="lTexCoord"+n+" = texEnv;\n":e+="lTexCoord"+n+" = (uTextureMatrix"+n+" * vec4("+s[i[a]][1]+", 0, 1)).st;\n",n++)}}return e}static g(t){return"            attribute vec3 aPosition;\n            attribute vec3 aNormal;\n            attribute vec2 aTexCoord0;\n            attribute vec2 aTexCoord1;\n            attribute vec3 aColor;\n            \n            varying vec3 vPosition;\n            varying vec3 vNormal;\n            varying vec2 vTexCoord1;\n            varying vec2 vTexCoord2;\n            \n            uniform mat4 uModelMatrix;\n            uniform mat4 uPanningMatrix;\n            uniform mat4 uViewMatrix;\n            uniform mat4 uInvTranspViewModelMat;\n            uniform mat4 uProjMatrix;\n            uniform vec3 uCameraPos;\n            \n            void main(void) {\n              vec4 pos = uViewMatrix * uModelMatrix * vec4(aPosition, 1);\n              vPosition = pos.rgb;\n              gl_Position = uProjMatrix * uViewMatrix * uModelMatrix * vec4(aPosition, 1);\n              vTexCoord1 = aTexCoord0;\n              vTexCoord2 = aTexCoord1;\n              vNormal = normalize((uInvTranspViewModelMat * vec4(aNormal, 0.0)).xyz);            }"}static h(t,e,i){var r=Ma[e];r||(r=Ma[e="PS_Combiners_Opaque_Mod"]);for(var s="\t\t"+r.slice(1,r.length).join("\n\t\t"),n=0;n<r[0];n++){var a=n+1;s="vec4 tex"+n+" = texture2D(uTexture"+a+", lTexCoord"+a+".st);\n"+s}return"            precision mediump float;            \n            varying vec3 vPosition;\n            varying vec3 vNormal;\n            varying vec2 vTexCoord1;\n            varying vec2 vTexCoord2;\n            varying vec2 vTexCoord3;\n            varying vec2 vTexCoord4;\n            \n            uniform bool uHasAlpha;\n            uniform bool uHasSpecEmiss;\n            uniform bool uHasEmissiveGlowing;\n            uniform int uBlendMode;\n            uniform bool uUnlit;\n            uniform vec4 uColor;\n            uniform vec4 uAmbientColor;\n            uniform vec4 uDiffuseColor;\n            uniform vec4 uPrimaryColor;\n            uniform vec4 uSecondaryColor;\n            uniform vec3 uLightDir1;\n            uniform vec3 uLightDir2;\n            uniform vec3 uLightDir3;\n            uniform mat4 uTextureMatrix1;\n            uniform mat4 uTextureMatrix2;\n            uniform mat4 uTextureMatrix3;\n            uniform mat4 uTextureMatrix4;\n            uniform sampler2D uTexture1;\n            uniform sampler2D uTexture2;\n            uniform sampler2D uTexture3;\n            uniform sampler2D uTexture4;\n            uniform sampler2D uAlpha;\n            uniform vec4 uTexSampleAlpha;\n            \n            vec2 sphereMap(vec3 vertex, vec3 normal)\n            {\n               vec3 normPos = (normalize(vertex.xyz));\n               vec3 reflection = reflect(normPos, normalize(normal));\n               reflection = vec3(reflection.x, reflection.y, reflection.z + 1.0);\n               vec2 texCoord = ((normalize(reflection).xy * 0.5) + vec2(0.5));\n               return texCoord;\n            }\n            void main(void) {\n            vec2 lTexCoord1 = vec2(0.0);            vec2 lTexCoord2 = vec2(0.0);            vec2 lTexCoord3 = vec2(0.0);            vec4 _output = vec4(1.0);\n            vec4 _input = uColor;\n            vec3 _specular = vec3(0.0);            vec2 texEnv = sphereMap(vPosition.xyz,normalize(vNormal.xyz));\n            "+this.f(t)+"\n            "+s+"\n            \n            if (uBlendMode == 13) {\n                _output.a = _output.a * _input.a;\n            } else if (uBlendMode == 1) {\n                if (_output.a < (128.0/255.0))\n                    discard;\n                _output.a = _input.a;\n            } else if (uBlendMode == 0) {\n                _output.a = _input.a;\n            } else {\n                _output.a = _output.a * _input.a;\n            }\n            // if (uBlendMode > 1) {\n            //     if (_output.a < (1.0/255.0)) {\n            //         discard;\n            //     }\n            // }\n            if (!uUnlit) {                vec4 litColor = uAmbientColor;                vec3 normal = normalize(vNormal);                                float dp = max(0.0, dot(normal, uLightDir1));                litColor += uPrimaryColor * dp;                                dp = max(0.0, dot(normal, uLightDir2));                litColor += uSecondaryColor * dp;                                dp = max(0.0, dot(normal, uLightDir3));                litColor += uSecondaryColor * dp;                                litColor = clamp(litColor, vec4(0,0,0,0), vec4(1,1,1,1));                _output *= (litColor * uDiffuseColor);            }            _output += vec4(_specular, 0.0);\n            gl_FragColor = _output;\n            }"}}const Ca=[["PS_Combiners_Opaque_Mod2xNA_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_AddAlpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_AddAlpha_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod2xNA_Alpha_Add","VS_Diffuse_T1_Env_T1","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_AddAlpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_AddAlpha","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_AddAlpha","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_AddAlpha_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Alpha_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod2xNA_Alpha_3s","VS_Diffuse_T1_Env_T1","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Opaque_AddAlpha_Wgt","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_Add_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_ModNA_Alpha","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_AddAlpha_Wgt","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_AddAlpha_Wgt","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_AddAlpha_Wgt","VS_Diffuse_T1_T2","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod_Add_Wgt","VS_Diffuse_T1_Env","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod2xNA_Alpha_UnshAlpha","VS_Diffuse_T1_Env_T1","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_Dual_Crossfade","VS_Diffuse_T1","HS_T1","DS_T1"],["PS_Combiners_Mod_Depth","VS_Diffuse_EdgeFade_T1","HS_T1","DS_T1"],["PS_Combiners_Opaque_Mod2xNA_Alpha_Alpha","VS_Diffuse_T1_Env_T2","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_Mod","VS_Diffuse_EdgeFade_T1_T2","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_Masked_Dual_Crossfade","VS_Diffuse_T1_T2","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Alpha","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Opaque_Mod2xNA_Alpha_UnshAlpha","VS_Diffuse_T1_Env_T2","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_Depth","VS_Diffuse_EdgeFade_Env","HS_T1","DS_T1"],["PS_Guild","VS_Diffuse_T1_T2_T1","HS_T1_T2_T3","DS_T1_T2"],["PS_Guild_NoBorder","VS_Diffuse_T1_T2","HS_T1_T2","DS_T1_T2_T3"],["PS_Guild_Opaque","VS_Diffuse_T1_T2_T1","HS_T1_T2_T3","DS_T1_T2"],["PS_Illum","VS_Diffuse_T1_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_Mod_Mod_Const","VS_Diffuse_T1_T2_T3","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Mod_Mod_Mod_Const","VS_Color_T1_T2_T3","HS_T1_T2_T3","DS_T1_T2_T3"],["PS_Combiners_Opaque","VS_Diffuse_T1","HS_T1","DS_T1"],["PS_Combiners_Mod_Mod2x","VS_Diffuse_EdgeFade_T1_T2","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod","VS_Diffuse_EdgeFade_T1","HS_T1_T2","DS_T1_T2"],["PS_Combiners_Mod_Mod_Depth","VS_Diffuse_EdgeFade_T1_T2","HS_T1_T2","DS_T1_T2"]],Ma={PS_Combiners_Add:[1,"_output.rgb = _input.rgb + tex0.rgb;","_output.a = _input.a + tex0.a;"],PS_Combiners_Decal:[1,"_output.rgb = mix(_input.rgb, tex0.rgb, _input.a);","_output.a = _input.a;"],PS_Combiners_Fade:[1,"_output.rgb = mix(tex0.rgb, _input.rgb, _input.a);","_output.a = _input.a;"],PS_Combiners_Mod:[1,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = tex0.a;"],PS_Combiners_Mod2x:[1,"_output.rgb = _input.rgb * tex0.rgb * 2.0;","_output.a = tex0.a * 2.0;"],PS_Combiners_Opaque:[1,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = 1.0;"],PS_Combiners_Add_Add:[2,"_output.rgb = (_input.rgb + tex0.rgb) + tex1.rgb;","_output.a = (_input.a + tex0.a) + tex1.a;"],PS_Combiners_Add_Mod:[2,"_output.rgb = (_input.rgb + tex0.rgb) * tex1.rgb;","_output.a = (_input.a + tex0.a) * tex1.a;"],PS_Combiners_Add_Mod2x:[2,"_output.rgb = (_input.rgb + tex0.rgb) * tex1.rgb * 2.0;","_output.a = (_input.a + tex0.a) * tex1.a * 2.0;"],PS_Combiners_Add_Opaque:[2,"_output.rgb = (_input.rgb + tex0.rgb) * tex1.rgb;","_output.a = _input.a + tex0.a;"],PS_Combiners_Mod_AddNA:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_output.a = tex0.a;","_specular = tex1.rgb;"],PS_Combiners_Mod_Mod:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;","_output.a = tex0.a * tex1.a;"],PS_Combiners_Mod_Mod2x:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;","_output.a = tex0.a * tex1.a * 2.0;"],PS_Combiners_Mod_Add:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_output.a = tex0.a + tex1.a;","_specular = tex1.rgb;"],PS_Combiners_Mod_Mod2xNA:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;","_output.a = tex0.a;"],PS_Combiners_Mod_Opaque:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;","_output.a = tex0.a;"],PS_Combiners_Mod2x_Add:[2,"_output.rgb = (_input.rgb * tex0.rgb) * 2.0 + tex1.rgb;","_output.a = (tex0.a) * 2.0 + tex1.a;"],PS_Combiners_Mod2x_Mod2x:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 4.0;","_output.a = (tex0.a) * tex1.a * 4.0;"],PS_Combiners_Mod2x_Opaque:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;","_output.a = tex0.a * 2.0;"],PS_Combiners_Opaque_Add:[2,"_output.rgb = (_input.rgb * tex0.rgb) + tex1.rgb;","_output.a = _input.a + tex1.a;"],PS_Combiners_Opaque_AddAlpha:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_specular = (tex1.rgb * tex1.a);"],PS_Combiners_Opaque_AddAlpha_Wgt:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_specular = (tex1.rgb * tex1.a) * uTexSampleAlpha.g;"],PS_Combiners_Opaque_AddAlpha_Alpha:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_specular = (tex1.rgb * tex1.a * (1.0 - tex0.a));"],PS_Combiners_Opaque_AddNA:[2,"_output.rgb = (_input.rgb * tex0.rgb) + tex1.rgb;","_output.a = _input.a;"],PS_Combiners_Opaque_Mod:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;","_output.a = tex1.a;"],PS_Combiners_Opaque_Mod2x:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;","_output.a = tex1.a * 2.0;"],PS_Combiners_Opaque_Mod2xNA:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb * 2.0;",""],PS_Combiners_Opaque_Mod2xNA_Alpha:[2,"_output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb * 2.0, tex0.rgb, vec3(tex0.a));",""],PS_Combiners_Opaque_Opaque:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;",""],PS_Combiners_Opaque_Mod2xNA_Alpha_Add:[3,"_output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb * 2.0, tex0.rgb, vec3(tex0.a));","_specular = tex2.rgb * tex2.a * uTexSampleAlpha.b;"],PS_Combiners_Mod_Mod_Mod_Const:[3,"_output.rgb = _input.rgb * (tex0 * tex1 * tex2).rgb;","_output.a = (tex0 * tex1 * tex2).a;"],PS_Combiners_Mod_AddAlpha:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_output.a = tex0.a;","_specular = tex1.rgb * tex1.a;"],PS_Combiners_Mod_AddAlpha_Wgt:[2,"_output.rgb = (_input.rgb * tex0.rgb);","_output.a = tex0.a;","_specular = tex1.rgb * tex1.a * uTexSampleAlpha.g;"],PS_Combiners_Mod_AddAlpha_Alpha:[2,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = (tex0.a + tex1.a * (0.3 * tex1.r + 0.59 * tex1.g + 0.11 * tex1.b));","_specular = tex1.rgb * tex1.a * (1.0 - tex0.a);"],PS_Combiners_Opaque_Mod_Add_Wgt:[2,"_output.rgb = _input.rgb * mix(tex0.rgb, tex1.rgb, vec3(tex1.a));","_specular = (tex0.rgb * tex0.a) * uTexSampleAlpha.r;"],PS_Guild:[3,"_output.rgb = _input.rgb * mix(tex0.rgb * mix(vec3(1.0, 1.0, 1.0), tex1.rgb * vec3(1.0, 1.0, 1.0), vec3(tex1.a)), tex2.rgb * vec3(1.0, 1.0, 1.0), vec3(tex2.a));","_output.a = tex0.a;"],PS_Guild_Opaque:[3,"_output.rgb = _input.rgb * mix(tex0.rgb * mix(vec3(1.0, 1.0, 1.0), tex1.rgb * vec3(1.0, 1.0, 1.0), vec3(tex1.a)), tex2.rgb * vec3(1.0, 1.0, 1.0), vec3(tex2.a));",""],PS_Guild_NoBorder:[2,"_output.rgb = _input.rgb * tex0.rgb * mix(vec3(1.0, 1.0, 1.0), tex1.rgb * vec3(1.0, 1.0, 1.0), vec3(tex1.a));","_output.a = tex0.a;"],PS_Combiners_Opaque_Alpha_Alpha:[2,"_output.rgb = _input.rgb * mix(mix(tex0.rgb, tex1.rgb, vec3(tex1.a)), tex0.rgb, vec3(tex0.a));",""],PS_Combiners_Opaque_Mod2xNA_Alpha_3s:[3,"_output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb * 2.0, tex2.rgb, vec3(tex2.a));"],PS_Combiners_Mod_Add_Alpha:[2,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = (tex0.a + tex1.a);","_specular = tex1.rgb * (1.0 - tex0.a);"],PS_Combiners_Opaque_ModNA_Alpha:[2,"_output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb, tex0.rgb, vec3(tex0.a));",""],PS_Combiners_Opaque_Mod2xNA_Alpha_UnshAlpha:[3,"float glowOpacity = clamp((tex2.a * vec4(1.0, 1.0, 1.0, 1.0).z), 0.0, 1.0); _output.rgb = _input.rgb * mix(tex0.rgb * tex1.rgb * 2.000000, tex0.rgb, vec3(tex0.a)) * (1.0 - glowOpacity);","_specular = tex2.rgb * glowOpacity;"],PS_Combiners_Opaque_Mod2xNA_Alpha_Alpha:[3,"_output.rgb = _input.rgb * mix(mix(tex0.rgb * tex1.rgb * 2.000000, tex2.rgb, vec3(tex2.a)), tex0.rgb, vec3(tex0.a));",""],PS_Combiners_Mod_Depth:[1,"_output.rgb = _input.rgb * tex0.rgb;","_output.a = tex0.a;"],PS_Combiners_Opaque_Alpha:[2,"_output.rgb = _input.rgb * mix(tex0.rgb, tex1.rgb, vec3(tex1.a));",""],Skin:[3,"//Fresnel Rim\r\nif (uHasSpecEmiss) {\r\n    vec3 emissiveColor = tex2.rgb;\r\n    vec3 emissiveTerm = tex2.rgb;\r\n    if (uHasEmissiveGlowing) {\r\n        vec3 eyeVec_120 = vPosition.xyz;\r\n        vec3 t121 = -(eyeVec_120);\r\n        vec2 term_126 = vec2(dot(t121, vNormal), dot(normalize(t121), (vNormal * vec3(0.0500000007, 0.0500000007, 1.0))));\r\n        vec2 invTerm_128 = (vec2(1.0) - clamp(term_126, 0.0, 1.0));\r\n        vec2 f_129 = (invTerm_128 * invTerm_128);\r\n        float fresnel_rim_133 = pow((f_129.x + f_129.y), 0.600000024);\r\n        vec3 t136 = (tex2.rgb /*+ ((vec3(0.0500000007, 0.0, 0.400000006) * 1.0) * fresnel_rim_133)*/);\r\n        emissiveColor = vec3(t136.r, tex2.g, t136.b);\r\n\r\n        float t267 = dot(normalize(vNormal),  normalize(-(vPosition.xyz)));\r\n        emissiveTerm = mix(vec3(0.0), 2.0*emissiveColor, vec3(pow(clamp(t267, 0.0, 1.0), (( 128.0 * (tex2.a)) + 9.99999975e-006))));\r\n    }\r\n\r\n    _output.rgb = _input.rgb * tex0.rgb + tex1.rgb + emissiveTerm.rgb;\r\n} else {\r\n    _output.rgb = _input.rgb * tex0.rgb;\r\n}\r\n_output.a = tex0.a; //"],PS_Combiners_Mod_Dual_Crossfade:[3,"_output.rgb = _input.rgb * mix(mix(tex0, texture2D(uTexture2,vTexCoord1), vec4(clamp(uTexSampleAlpha.g, 0.000000, 1.000000))), texture2D(uTexture3,vTexCoord1), vec4(clamp(uTexSampleAlpha.b, 0.000000, 1.000000))).rgb;","_output.a = mix(mix(tex0, texture2D(uTexture2,vTexCoord1), vec4(clamp(uTexSampleAlpha.g, 0.000000, 1.000000))), texture2D(uTexture3,vTexCoord1), vec4(clamp(uTexSampleAlpha.b, 0.000000, 1.000000))).a;"],PS_Combiners_Mod_Masked_Dual_Crossfade:[4,"_output.rgb = _input.rgb * mix(mix(tex0, texture2D(uTexture2,texCoord), vec4(clamp(uTexSampleAlpha.g, 0.000000, 1.000000))), texture2D(uTexture3,texCoord), vec4(clamp(uTexSampleAlpha.b, 0.000000, 1.000000))).rgb;","_output.a = mix(mix(tex0, texture2D(uTexture2,texCoord), vec4(clamp(uTexSampleAlpha.g, 0.000000, 1.000000))), texture2D(uTexture3,texCoord), vec4(clamp(uTexSampleAlpha.b, 0.000000, 1.000000))).a * texture(uTexture4,texCoord2).a;"],PS_Combiners_Mod_Mod_Depth:[2,"_output.rgb = (_input.rgb * tex0.rgb) * tex1.rgb;","_output.a = tex0.a * tex1.a;"]},Sa=Ea,ka=class{constructor(){this.h=!1,this.i=!0}},Da=[0,1,2,10,3,4,5,13],Fa=class{constructor(t){this.E=!1,this.F=!1,this.a=t.getUint8(),this.b=t.getInt8(),this.c=t.getUint16(),this.d=t.getUint16(),this.e=t.getUint16(),this.f=t.getInt16(),this.g=t.getUint16(),this.h=t.getUint16(),this.i=t.getUint16(),this.j=t.getInt16(),this.k=t.getUint16(),this.l=t.getInt16(),this.m=t.getInt16(),this.n=!0,this.o=null,this.p=null,this.q=0,this.r=null,this.s=[],this.t=[],this.u=new Array,this.v=null,this.w=[],this.x=!1,this.y=!1,this.z=!1,this.A=Ri(),this.B=Ie(),this.C=Zi()}K(t){this.o=t,this.p=t.au[this.d],this.q=this.p.a,Aa.c(this);let e=this.o.az[this.j];1==this.i&&e>-1&&1==this.o.ay[e].type&&(this.c=-1e3,this.i=3);const i=Sa.d(this.c,this.i,this.r);this.H=i;for(let e=0;e<this.i;e++){if(this.j>-1&&this.j<t.az.length){let i=t.az[this.j+e];i>-1&&i<t.ay.length&&this.s.splice(e,0,t.ay[i])}if(this.m>-1&&this.m<t.aB.length){let i=t.aB[this.m+e];i>-1&&t.aA&&i<t.aA.length?this.t.splice(e,0,t.aA[i]):this.t.splice(e,0,null)}if(this.l>-1&&this.l<t.aH.length){let i=t.aH[this.l+e];i>-1&&i<t.aG.length?this.w.splice(e,0,t.aG[i]):this.w.splice(e,0,null)}}this.u=new Array(this.t.length);for(let t=0;t<this.u.length;t++)this.u[t]=ii();this.E&&(this.s=this.s.reverse(),this.t=this.t.reverse()),t.aF&&this.f>-1&&this.f<t.aF.length&&(this.v=t.aF[this.f]),this.D=this.r.b>1}L(){const t=this.o.aT.context,e=De.GetProgram(t,this.H.name,this.H.config);this.G=e,this.H=e.program,this.I=e.uniforms}M(){let t=Ui(this.p.i[0],this.p.i[1],this.p.i[2],1),e=this.o.ar[this.p.g].m,i=ii();hi(i,i,this.o.aX.uViewMatrix),hi(i,i,this.o.W),hi(i,i,e),Li(t,t,i),t[3]=0;let r=Ni(t);if((3&this.a)>0){let e=Ri();r>0?Pi(e,t,1/r):Ii(e,t),Pi(e,e,Pe(ze(i[8],i[9],i[10]))*this.p.j),1&this.a?Oi(e,t,e):function(t,e,i){t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3]}(e,t,e),r=zi(e)}return r}N(t){const e=this.o,i=this.o.aT.context,r=this.o.T;if(this.G||this.L(),!this.G.program)return;if(this.J||(this.J=new ka,this.J.a=this.G,this.J.b=Object.assign({},e.aX)),this.J.c=e.aV,this.J.d=e.aW,this.J.b=Object.assign({},e.aX),this.A[0]=this.A[1]=this.A[2]=this.A[3]=1,this.v&&this.v.g(r,this.o.aY,this.A),this.w[0]&&(this.A[3]*=this.w[0].d(r,this.o.aY)),this.A[3]<=.001)return;let s=this.r.b;const n=[1,1,1];for(let t=0;t<this.w.length;t++){const e=this.w[t];e&&(n[t]=e.d(r,this.o.aY))}this.J.b.uColor=this.A,this.J.b.uTexSampleAlpha=Ui(n[0],n[1],n[2],1),this.J.b.uBlendMode=s,this.J.b.uHasSpecEmiss=e.aL[1]&&e.aL[1].i,this.J.b.uHasEmissiveGlowing=27==e.o||30==e.o,this.J.e=Da[s],this.J.i=!this.o.bZ,this.J.b.uUnlit=this.x?1:0,this.J.n=this.M(),this.J.m=this.b,this.J.o=this.h;const a=this.P();let o=!0;for(const t in a){const e=a[t],i=e.a&&e.a.d;o=o&&(null==e.a||null!=i),i&&(this.J.b[e.c]=i)}o&&!this.F&&(this.F=!0),this.t.forEach(((t,e)=>{if(!this.o.U&&(ni(this.u[e]),this.t[e])){let t=!1,i=!1;this.t[e].a&&this.t[e].a.c(r.a.a)?(this.B=this.t[e].a.d(r,this.o.aY),i=!0):Le(this.B,0,0,0),this.t[e].b&&this.t[e].b.c(r.a.a)?(this.C=this.t[e].b.d(r,this.o.aY),t=!0):Ki(this.C,0,0,0,1);let s,n=!1;if(this.t[e].c&&this.t[e].c.c(r.a.a)&&(s=this.t[e].c.d(r,this.o.aY),n=!0),ni(this.u[e]),li(this.u[e],this.u[e],ze(.5,.5,0)),n&&ui(this.u[e],this.u[e],s),t){let t=ii();(function(t,e,i){var r=e[0],s=e[1],n=e[2],a=e[3],o=r+r,h=s+s,l=n+n,u=r*o,c=r*h,f=r*l,d=s*h,b=s*l,_=n*l,g=a*o,p=a*h,m=a*l;t[0]=1-(d+_),t[1]=c+m,t[2]=f-p,t[3]=0,t[4]=c-m,t[5]=1-(u+_),t[6]=b+g,t[7]=0,t[8]=f+p,t[9]=b-g,t[10]=1-(u+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1})(t,this.C,[0,0,0]),hi(this.u[e],this.u[e],t)}i&&li(this.u[e],this.u[e],this.B),li(this.u[e],this.u[e],ze(-.5,-.5,0))}this.J.b["uTextureMatrix"+(e+1).toString()]=this.u[e]})),this.J.h=this.y,this.J.f=!this.z,this.J.j=i.TRIANGLES,this.J.l=2*this.p.e,this.J.k=this.p.f,t.push(this.J)}O(){return this.s}P(){let t=0;const e=[];this.s.forEach(((i,r)=>{let s=null;if(this.s[r]){if(-1e3==this.c){const t=this.o.aL[1];if(t)s={d:t.m(r)};else if(this.o.w){const t=this.o.w.aL[1];t&&(s={d:t.m(r)})}}else this.o.aM&&1==this.s[r].type?s=this.o.aM.a:this.o.aL[this.s[r].type]&&this.o.aL[this.s[r].type].a?s={d:this.o.aL[this.s[r].type].a}:this.o.w&&this.o.w.aL[this.s[r].type]&&this.o.w.aL[this.s[r].type].a?s={d:this.o.w.aL[this.s[r].type].a}:this.s[r].f?s=this.s[r].f:this.o.C[this.s[r].type]?s=this.o.C[this.s[r].type]:!this.s[r].e&&this.j+t<this.o.ay.length&&this.o.ay[this.j+t]&&this.o.ay[this.j+t].f&&(s=this.o.ay[this.j+t].f);s||(this.s[r].g||(this.s[r].g=!0),s={d:this.o.aT.greenPixelTexture})}e[r]=s,t++}));const i={};for(let r=0;r<t;r++)i["Texture"+(r+1)]={a:e[r],b:r,c:"uTexture"+(r+1),d:"TEXTURE"+r};return i}get show(){return this.n}set show(t){this.n=t}get meshId(){return this.q}Q(){this.o=null,this.p=null,this.r=null,this.s=null,this.t=null,this.v=null,this.w=null,this.A=null,this.u=null,this.B=null,this.C=null}},Ra=class{constructor(t,e){this.d=null,this.e=!1,0!=e&&(this.b=t,this.c=t.l.contentPath+"texture/"+e+".webp",function(t){t.a=new Image,t.a.crossOrigin="",t.a.onload=function(){t.h()},t.a.onerror=function(){t.a=null},t.a.src=t.c}(this))}f(){return this.e}g(){if(!this.b)return;const t=this.b.aT.context;this.d&&t.deleteTexture(this.d),this.d=null,this.b=null}h(){if(!this.b)return;const t=this.b.aT.context;function e(t){return 0==(t&t-1)}this.d=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.d),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.a),e(this.a.width)&&e(this.a.height)?t.generateMipmap(t.TEXTURE_2D):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR));const i=this.b.aT.aniFilterExt;i&&t.texParameteri(t.TEXTURE_2D,i.TEXTURE_MAX_ANISOTROPY_EXT,this.b.aT.aniFilterMax),this.e=!0}},Ua=class{constructor(t,e,i){this.a=t,this.b=e,this.c=i.getInt32(),this.d=i.getUint32(),this.e=i.getUint32(),this.f=null,this.g=!1,this.i()}h(){this.a=null,this.f&&this.f.g(),this.f=null}i(){0!=this.e&&(this.f=new Ra(this.a,this.e))}get type(){return this.c}},Ia=class{constructor(t){this.a=new ur(t,er),this.b=new ur(t,ir),this.c=new ur(t,er)}d(){var t=this;t.a&&(t.a.e(),t.a=null),t.b&&(t.b.e(),t.b=null),t.c&&(t.c.e(),t.c=null)}},Oa=class{constructor(t){var e=this;e.a=t.getInt32(),e.b=t.getInt32(),e.c=ze(t.getFloat(),t.getFloat(),t.getFloat()),e.d=-1}e(){this.c=null}},Pa=class{constructor(t){this.a=new ur(t,er),this.b=new ur(t,rr)}c(){var t=this;t.a&&t.a.e(),t.b&&t.b.e()}d(t){return!!this.a&&this.a.c(t)}e(t){return!!this.b&&this.b.c(t)}f(t){return this.d(t)||this.e(t)}g(t,e,i){var r=this;i?i[0]=i[1]=i[2]=i[3]=1:i=Ui(1,1,1,1);let s=ze(1,1,1);return r.d(t.a.a)&&r.a.d(t,e,s,s),r.e(t.a.a)&&(i[3]=r.b.d(t,e,i[3])/32767),i[0]=s[0],i[1]=s[1],i[2]=s[2],i}},za=class{constructor(t){this.a=new ur(t,rr)}b(){this.a.e(),this.a=null}c(t){return this.a.c(t)}d(t,e){var i=1;return this.c(t.a.a)&&(i=this.a.d(t,e,i)/32767),i>1?i=1:i<0&&(i=0),i}},Ba=class{constructor(){this.a=0,this.b=0,this.c=-1,this.d=null,this.e=null,this.f=null}};class La extends Ba{}const Na=class{constructor(t,e){this.d=!1,this.a=t,this.b=e,this.c=new Array(e.length)}e(t){for(let e=0;e<this.b.length;e++)this.c[e]&&this.c[e].e&&this.c[e].e.setAnimation(t)}f(t){this.d=t}g(t){for(let e=0;e<this.b.length;e++)switch(this.b[e].EffectType){case 1:if(1==this.b[e].ProcEffectType){let t=this.b[e].Value[0];this.a.X=Ui((t>>16&255)/255,(t>>8&255)/255,(255&t)/255,this.a.X[3])}else if(14==this.b[e].ProcEffectType){let t=Math.min(Math.max(this.b[e].Value[0],0),1);this.a.X[3]=t}else if(22==this.b[e].ProcEffectType){let t=this.b[e].Value[3];this.a.X=Ui((t>>16&255)/255,(t>>8&255)/255,(255&t)/255,this.a.X[3])}break;case 2:this.h(e,t)}}h(t,e){if(!this.a)return;if(!this.a.d)return;if(!this.c[t]){let e=this.b[t].AttachmentID;this.b[t].Positioner>-1&&(e=this.b[t].Positioner),e<0&&(e=19);let i=this.a.cb(e);if(this.c[t]=new La,this.c[t].d=i,this.c[t].c=i?i.b:-1,0==this.b[t].ModelType){let e={type:wi.PATH,id:this.b[t].Model,parent:this.a,shoulder:-1};this.c[t].e=new yo(this.a.aT,this.a.l,e,0,!1,!0,!1)}else if(1==this.b[t].ModelType){let e=this.a.o>0?this.a.o:1,i=-1!=this.a.p?this.a.p:0;this.a.o=e,this.a.p=i,this.c[t].ba=new ja(this.a,this.b[t].InvType,this.b[t].Model,e,i)}else if(2==this.b[t].ModelType){let e={type:wi.NPC,id:this.b[t].Model,parent:this.a,shoulder:-1};this.c[t].e=new yo(this.a.aT,this.a.l,e,0,!1,!0,!1)}}if(!(0!=this.b[t].ModelType||this.c[t].e&&this.c[t].e.d))return;if(!(1!=this.b[t].ModelType||this.c[t].ba&&this.c[t].ba.n))return;if(!(2!=this.b[t].ModelType||this.c[t].e&&this.c[t].e.d))return;let i=ii();di(i,i,-this.b[t].Yaw),fi(i,i,this.b[t].Pitch),ci(i,i,this.b[t].Roll),ui(i,i,[this.b[t].Scale1,this.b[t].Scale1,this.b[t].Scale1]),ui(i,i,[this.b[t].Scale2,this.b[t].Scale2,this.b[t].Scale2]);let r=ii();if(this.c[t].d){let e=this.c[t].d.c;hi(r,r,this.a.ar[this.c[t].c].m),li(r,r,ze(e[0],e[1],e[2]))}if(li(r,r,ze(this.b[t].Offset[0],-this.b[t].Offset[1],this.b[t].Offset[2])),hi(r,r,i),0==this.b[t].ModelType){let i=this.c[t].e;i.setAnimPaused(this.d),i.bu(this.a.W,r,null,null),i.ce(e)}else if(1==this.b[t].ModelType)for(let i=0;i<this.c[t].ba.i.length;i++){let s=this.c[t].ba.i[i].e;s.d&&(s.setAnimPaused(this.d),s.bu(this.a.W,r,null,null),s.ce(e))}else if(2==this.b[t].ModelType){let i=this.c[t].e;i.setAnimPaused(this.d),i.bu(this.a.W,r,null,null),i.ce(e)}}},Ha=class{constructor(t,e,i){var r=this;r.a=t,r.d=e,r.b=[],r.c=!1,r.f=[],i&&r.h(i)}g(){var t=this;if(t.a=null,t.b){for(var e=0;e<t.b.length;++e){var i=t.b[e];i&&(i.e&&i.e.bb(),i.e=null,i.d=null,t.b[e]=null)}t.b=null}}h(t){var e=this;e.e=t;var i=e.a.l.contentPath+"meta/itemvisual/"+e.e+".json";$.getJSON(i,(function(t){e.i(t)}))}i(t){var e=this;if(e.b=new Array(7),t.ItemEffects)for(let r=0;r<t.ItemEffects.length;++r){let s=t.ItemEffects[r];if(-1==s.SubClass||this.d==s.SubClass){if(s.Model){let t=null;s.Scale&&1!=s.Scale&&(t=ii(),ui(t,t,ze(s.Scale,s.Scale,s.Scale))),e.b[s.Slot-1]=new Ba;var i={type:wi.PATH,id:s.Model,parent:e.a,shoulder:-1};e.b[s.Slot-1].e=new yo(e.a.aT,e.a.l,i,0,!1,!0,!1),e.b[s.Slot-1].f=t}s.kit&&(this.a.F,this.a.F.push(new Na(this.a,s.kit.effects)))}}for(var r=0;r<e.b.length;++r)t.Equipment[r]&&null==e.b[r]&&(e.b[r]=new Ba,i={type:wi.PATH,id:t.Equipment[r],parent:e.a,shoulder:-1},e.b[r].e=new yo(e.a.aT,e.a.l,i,r,!1,!0,!1));e.c=!0,e.a.bM()}j(t){if(this.a.d){for(var e=0;e<this.f.length;e++)this.f[e].g(t);for(var i=0;i<this.b.length;i++){var r=this.b[i];if(r){let e=ze(0,0,0);if(i>=5||r&&r.d&&(e=r.d.c),-1!=r.c){let i=this.a.ar[r.c].m;r.e.bu(this.a.W,i,e,r.f),r.e.ce(t)}}}}}};class Ga{static a(t,e,i,r,s){let n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];if(!e)return null;for(let t=0;t<e.length;t++){let a=e[t],o=a.Gender,h=a.Class,l=a.Race,u=a.ExtraData,c=0;if(i>1||o!=i){if(o<2)continue;c=0}else c=2;let f=1;if(r>0&&h==r)f=0;else if(h>0)continue;let d=1;if(s>0&&l==s)d=0;else if(l>0)continue;n[u+3*(d+2*(c+f))]=a.FileDataId}for(let t=0;t<2;t++)for(let e=0;e<2;e++)for(let i=0;i<2;i++){let r=3*(t+2*(e+2*i));if(n[r]>0){let t;return t={a:n[r],b:n[r+1],c:n[r+2]},t}}if(t){let n=t.bX(i,s,!0);if(n&&0!=n[0])return s=n[0],i=n[1],Ga.a(t,e,i,r,s)}return null}static b(t,e,i,r,s,n){let a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(let t=0;t<e.length;t++){let o=e[t],h=o.Gender,l=o.Class,u=o.Race,c=o.ExtraData,f=0;if(r>1||h!=r){if(h<2)continue;f=0}else f=2;let d=1;if(s>0&&l==s)d=0;else if(l>0)continue;let b=1;if(n>0&&u==n)b=0;else if(u>0)continue;let _=1;if(-1==i||c!=i){if(-1!=c&&-1!=i)continue}else _=0;a[_+2*(b+2*(f+d))]=o.FileDataId}for(let t=0;t<2;t++)for(let e=0;e<2;e++)for(let i=0;i<2;i++)for(let r=0;r<2;r++){let s=r+2*(t+2*(e+2*i));if(a[s])return a[s]}if(t){var o=t.bX(r,n,!1);if(o&&0!=o[0])return n=o[0],r=o[1],Ga.b(t,e,i,r,s,n)}return 0}}const ja=class{constructor(t,e,i,r,s){this.r=null,this.s=[],this.a=t,this.b=e,this.t=i,this.u=r,this.v=s,this.e=yi[e],this.f=Ai[e],this.i=null,this.j=null,this.k=null,this.l=null,this.g=0,this.h=0,this.n=!1,this.o=!1,this.p=0,this.q=3,this.m=0,i&&this.z()}y(){var t=this;if(t.i){for(let e=0;e<t.i.length;++e)t.i[e].e&&t.i[e].e.bb(),t.i[e].e=null,t.i[e].d=null,t.i[e]=null;t.i=null}if(t.j){for(let e=0;e<t.j.length;++e)t.j[e].texture&&t.j[e].texture.g(),t.j[e].texture=null,t.j[e]=null;t.j=null}if(t.k=null,t.l=null,t.s){for(let e=0;e<t.s.length;e++)t.s[e].g();t.s=null}t.n=!1,t.r&&(t.r.bb(),t.r=null),t.a&&(t.a.bD(),t.a=null)}z(){let t=this,e="meta/item/";const i=this.b;1!=i&&3!=i&&4!=i&&5!=i&&6!=i&&7!=i&&8!=i&&9!=i&&10!=i&&16!=i&&19!=i&&20!=i||(e="meta/armor/"+i+"/");let r=t.a.l.contentPath+e+t.t+".json";$.getJSON(r).done((function(e){t.A(e)})).fail((function(e,i,r){t.o=!0}))}A(t){if(!this.a)return;if(this.h=t.Item.Flags,this.g=t.Item.InventoryType,this.c=t.Item.ItemClass,this.d=t.Item.ItemSubClass,t.ComponentTextures){this.j=[];for(let e in t.ComponentTextures){const i=parseInt(e),r=Ga.a(this.a,t.TextureFiles[t.ComponentTextures[e]],this.a.p,this.a.q,this.a.o);if(r){let t;t={region:i,gender:this.a.p,file:r.a,texture:null},12!=i?t.texture=new Ra(this.a,r.a):16==this.b&&(this.a.C[2]=new Ra(this.a,r.a)),this.j.push(t)}}}if(this.k=t.Item.GeosetGroup,this.l=t.Item.AttachGeosetGroup,this.m=t.Item.GeosetGroupOverride,1==this.b&&(0==this.a.p?this.w=t.Item.HideGeosetMale:this.x=t.Item.HideGeosetFemale),3==this.b?this.i=new Array(2):Ci[this.b]!=wi.ARMOR&&(this.i=new Array(1)),this.i)for(let e=0;e<this.i.length;++e){const i={race:this.u,gender:this.v,bone:-1,attachment:null,model:null,scaleMat:null},r={type:Ci[this.b],id:this.t,parent:this.a,shoulder:0};3==this.b&&(r.shoulder=e+1),i.e=new yo(this.a.aT,this.a.l,r,e,!1,!1,!0),i.e.o=this.u,i.e.p=this.v,i.e.bY(t,r.type),this.i[e]=i}if((6==this.b||16==this.b)&&t.ComponentModels){let e=0;if(16==this.b&&(e=1),t.ComponentModels[e]){const i={type:Ci[this.b],id:this.t,parent:this.a,shoulder:0},r=new yo(this.a.aT,this.a.l,i,0,!1,!1,!0);r.v=t;const s={race:0,gender:0,bone:-1,attachment:null,model:null,scaleMat:null};s.e=r,this.i=[s];let n=1,a=0,o=1;this.a&&(n=this.a.o,a=this.a.p,o=this.a.q);const h=t.ComponentModels[e],l=Ga.b(r,t.ModelFiles[h],-1,a,o,n);if(l){r.bW(wi.PATH,l);const i=0==e?t.Textures:t.Textures2;if(i)for(let t in i)0!=i[t]&&(r.C[+t]=new Ra(r,i[t]))}}}const e=this.b;if((4==e||5==e||20==e||6==e||7==e||10==e||8==e||1==e||9==e||19==e||16==e)&&t.ComponentModels){let i=0;if(1!=e&&6!=e||(i=1),t.ComponentModels[i]){const r=t.ComponentModels[i];if(r&&t.ModelFiles&&t.ModelFiles[r]){const s={type:Ci[e],id:this.t,parent:this.a,shoulder:0},n=new yo(this.a.aT,this.a.l,s,0,!1,!1,!0);n.v=t;let a=1,o=0,h=1;this.a&&(a=this.a.o,o=this.a.p,h=this.a.q);const l=Ga.b(n,t.ModelFiles[r],-1,o,h,a);if(l){this.r=n,n.bW(wi.PATH,l);const e=0==i?t.Textures:t.Textures2;if(e)for(let t in e)0!=e[t]&&(n.C[+t]=new Ra(n,e[t]))}}}}if(7==e&&this.k[2]>0&&(this.f+=2),0!=this.p){const t=2==this.c?this.d:-1;for(let e=0;e<this.i.length;e++)this.s.push(new Ha(this.i[e].e,t,this.p))}this.a.bM(),this.n=!0}B(t){for(let t=0;t<this.s.length;t++)this.s[t].g();this.s=[],this.p=t}C(t){this.q=t}D(t){if(!this.i)return;if(this.a.d){const t=this.a.bT(this.e,this);for(let e=0;e<this.i.length;++e)if(this.i[e]&&t.length>e){let i=this.a.aD[t[e]];if(this.i[e].c=i.b,this.i[e].d=i,this.s[e]&&this.s[e].b){const t=this.i[e].e;for(let r=0;r<this.s[e].b.length;r++)if(t.aD&&this.s[e].b[r]){if(r<5){if(!t.aD[r])continue;i=t.aD[r]}else i=t.cb(19);this.s[e].b[r].c=i.b,this.s[e].b[r].d=i}}}}let e=ii(),i=Ie();for(let r=0;r<this.i.length;++r){const s=this.i[r];if(s&&s.e){if(3==this.b){if(1==s.e.a.shoulder&&0==(1&this.q))continue;if(2==s.e.a.shoulder&&0==(2&this.q))continue}if(s.c>-1&&s.c<this.a.ar.length){this.s[r]&&s.e.d&&this.s[r].j(t);let n=!1,a=vi[s.e.a.id];if(ni(e),a&&(Le(i,1,1,-1),ui(e,e,i),n=!0),22!=this.b&&23!=this.b&&22!=this.e||0==(256&this.h)||(Le(i,1,-1,1),ui(e,e,i),n=!0,s.e.i=!0),s.e.bZ=n,5==this.a.I&&26==this.b&&2==this.c&&18==this.d&&(ni(e),ci(e,e,-Math.PI/2)),27==this.b){let t=s.e.v.Scale;Le(i,t,t,t),ui(e,e,i)}s.e.bu(this.a.W,this.a.ar[s.c].m,s.d.c,e),s.e.cc(),s.e.ce(t)}else-1==s.c&&this.a.bJ(s.e,t)}}}},Wa=class{constructor(t){this.c=t,this.b=267320826^t;let e=new ArrayBuffer(4);this.a=new DataView(e)}d(){let t=this.b;return t^=t<<13,t^=t>>17,t^=t<<5,this.b=t,t}e(){let t,e=this.d();return this.a.setInt32(0,1065353216|8388607&e),t=2147483648&e?2-this.a.getFloat32(0):this.a.getFloat32(0)-2,t}f(){let t=this.d();return this.a.setInt32(0,1065353216|8388607&t),this.a.getFloat32(0)-1}},Va=class{constructor(){this.a=0,this.b=0,this.c=0,this.d=0,this.e=Ie(),this.f=0,this.g=0,this.h=0,this.i=0,this.j=0}},qa=class{constructor(t,e){this.b=t,this.c=e,this.a=new Va}d(){return this.a.d+this.b.e()*this.c.u}e(){return this.a.d+this.c.u}f(){return this.a.c+this.c.s}g(t){return this.a.c+30518509e-12*t*this.c.s}h(){let t=this.a.a;return t*=1+this.a.b*this.b.e(),t}i(){return this.a}j(t){Be(t,this.a.e)}},Ya=class extends qa{k(t,e){let i,r=e*this.b.f(),s=this.b.e();i=s<1?s>-1?Math.trunc(32767*s+.5):-32767:32767,t.d=i;let n=this.g(i);n<.001&&(n=.001),t.b=function(t,e){let i=Math.abs(t),r=Math.abs(e);return Number((i-Math.floor(i/r)*r).toPrecision(8))*Math.sign(t)}(r,n),t.e=65535&this.b.d(),Le(t.a,this.b.e()*this.a.g*.5,this.b.e()*this.a.h*.5,0);let a=this.h(),o=this.a.f;if(o<.001){let e=this.a.i*this.b.e(),i=this.a.j*this.b.e(),r=Math.sin(e),s=Math.sin(i),n=Math.cos(e),o=Math.cos(i);Le(t.c,o*r*a,s*r*a,n*a)}else{let e=Ie();Be(e,t.a),e[2]=e[2]-o,Pe(e)>1e-4&&(Ze(e,e),Ve(t.c,e,a))}}},Xa=class extends qa{constructor(t,e,i){super(t,e),this.ba=i}k(t,e){let i,r=e*this.b.f(),s=this.b.e();i=s<1?s>-1?Math.trunc(32767*s+.5):-32767:32767,t.d=i;let n=this.g(i);n<.001&&(n=.001),t.b=function(t,e){let i=Math.abs(t),r=Math.abs(e);return Number((i-Math.floor(i/r)*r).toPrecision(8))*Math.sign(t)}(r,n),t.e=65535&this.b.d();let a=this.a.h-this.a.g,o=this.a.g+a*this.b.f(),h=this.a.i*this.b.e(),l=this.a.j*this.b.e(),u=Math.cos(h),c=ze(u*Math.cos(l),u*Math.sin(l),Math.sin(h));Ve(t.a,c,o);let f=this.h(),d=this.a.f,b=ze(.5,.5,.5);0==d?this.ba?Le(b,0,0,1):Le(b,u*Math.cos(l),u*Math.sin(l),Math.sin(h)):(Le(b,0,0,d),He(b,t.a,b),Pe(b)>1e-4&&Ze(b,b)),Ve(t.c,b,f)}},Za=class{constructor(t){this.a=t.getInt32(),this.b=t.getUint32(),this.c=ze(t.getFloat(),t.getFloat(),t.getFloat()),this.d=t.getInt16(),this.e=t.getInt16(),0!=(268435456&this.b)&&(this.f=[0,0,0],this.f[0]=31&this.e,this.f[1]=this.e>>5&31,this.f[2]=this.e>>10&31),this.g=t.getUint8(),this.h=t.getUint8(),this.i=t.getUint16(),this.j=t.getUint16(),this.k=t.getUint16(),this.l=t.getUint16(),this.m=new ur(t,sr),this.n=new ur(t,sr),this.o=new ur(t,sr),this.p=new ur(t,sr),this.q=new ur(t,er),this.r=new ur(t,sr),this.s=t.getFloat(),this.t=new ur(t,sr),this.u=t.getFloat(),this.v=new ur(t,sr),this.w=new ur(t,sr),this.x=new ur(t,sr),this.y=new hr(t),this.z=new lr(t),this.A=new or(t),this.B=[t.getFloat(),t.getFloat()],this.C=new lr(t),this.D=new lr(t),this.E=t.getFloat(),this.F=t.getFloat(),this.G=t.getFloat(),this.H=[t.getFloat(),t.getFloat()],this.I=t.getFloat(),this.J=t.getFloat(),this.K=t.getFloat(),this.L=t.getFloat(),this.M=t.getFloat(),this.N=t.getFloat(),this.O=ze(t.getFloat(),t.getFloat(),t.getFloat()),this.P=ze(t.getFloat(),t.getFloat(),t.getFloat()),this.Q=ze(t.getFloat(),t.getFloat(),t.getFloat()),this.R=t.getFloat(),this.S=t.getFloat(),this.T=t.getFloat(),this.U=t.getFloat(),this.V=t.getFloat();var e=t.getInt32();this.W=new Array(e);for(var i=0;i<e;i++)this.W[i]=ze(t.getFloat(),t.getFloat(),t.getFloat());this.X=new ur(t,nr),this.Y=Wi(t.getFloat(),t.getFloat()),this.Z=[Wi(t.getFloat(),t.getFloat()),Wi(t.getFloat(),t.getFloat())],this.aa=[Wi(t.getFloat(),t.getFloat()),Wi(t.getFloat(),t.getFloat())]}},Ja=class{constructor(){this.a=Ie(),this.b=0,this.c=Ie(),this.d=0,this.e=2147483647*Math.random()>>0,this.f=[ji(),ji()],this.g=[ji(),ji()]}};let Ka=new Array(128);for(let t=0;t<128;t++)Ka[t]=Math.random();const $a=si(0,1,0,0,-1,0,0,0,0,0,1,0,0,0,0,1);class Qa{}class to{constructor(){this.a=Ie(),this.b=0,this.c={a:ji(),b:Ie(),c:0,d:0,e:1,f:0}}}function eo(t){return Ui((t>>16&255)/255,(t>>8&255)/255,(t>>0&255)/255,(t>>24&255)/255)}const io=class{constructor(t,e){this.d=null,this.F=0,this.V=!1,this.a=(new Date).getTime(),this.b=t;let i=new Za(e);if(i.i>=11&&i.i<=13){let e;t.v.Item&&t.v.Item.ParticleColor?e=t.v.Item.ParticleColor:t.v.Creature&&t.v.Creature.ParticleColor&&(e=t.v.Creature.ParticleColor),e&&(this.I=[Ri(),Ri(),Ri()],Ii(this.I[0],eo(e.Start[i.i-11])),Ii(this.I[1],eo(e.Mid[i.i-11])),Ii(this.I[2],eo(e.End[i.i-11])))}this.c=i,this.e=ii(),this.f=ii(),this.g=ii(),this.h=ii(),this.i=Ri(),this.j=Yi(),this.k=Ie(),this.l=1,this.m=Ie(),this.n=0,this.o=Ie(),this.p=Ie(),this.q=[],this.r=Ie(),this.s=0,this.t=0,this.u=0,this.v=0,this.w=Ie(),this.x=Ie(),this.y=0,this.z=0,this.A=0,this.B=0,this.C=0,this.D=0,this.E=0,this.G=[],this.H=[];for(let t=0;t<1e3;t++)this.H.push(4*t+0),this.H.push(4*t+1),this.H.push(4*t+2),this.H.push(4*t+3),this.H.push(4*t+2),this.H.push(4*t+1);switch(this.K=new Wa(2147483647*Math.random()>>0),this.c.h){case 1:this.J=new Ya(this.K,i);break;case 2:this.J=new Xa(this.K,i,0!=(256&this.c.b));break;default:this.J=null}const r=this.c.U-this.c.S;0!=r?(this.t=(this.c.V-this.c.T)/r,this.u=this.c.T-this.c.S*this.t):(this.t=0,this.u=0);let s=this.c.l;s<=0&&(s=1);let n=this.c.k;n<=0&&(n=1),this.z=s*n-1,this.A=0;let a=s,o=-1;do{++o,a>>=1}while(a);if(this.B=o,this.C=s-1,this.A=0,(32768&this.c.b)>0){let t=(this.z+1)*this.K.d();this.A=t/4294967296|0}if(this.D=1/s,this.E=1/n,(269484032&this.c.b)>0){const t=0!=(1&this.c.b>>28);this.s=t?2:3}else this.s=0;this.L=i.g>1}X(){var t=this;t.b=null,t.c.c=null,t.c.O=null,t.c.P=null,t.c.m=t.c.m.e(),t.c.n=t.c.n.e(),t.c.o=t.c.o.e(),t.c.p=t.c.p.e(),t.c.q=t.c.q.e(),t.c.r=t.c.r.e(),t.c.t=t.c.t.e(),t.c.v=t.c.v.e(),t.c.w=t.c.w.e(),t.c.x=t.c.x.e(),t.c.X=t.c.X.e(),t.c.y=t.c.y.d(),t.c.z=t.c.z.d(),t.c.A=t.c.A.d(),t.c.C=t.c.C.d(),t.c.D=t.c.D.d(),t.q=null}Y(t){this.d=t}Z(t,e){if(!this.J)return;let i=ii(),r=this.J.i(),s=!0;this.c.X.c(t.a.a)&&(s=this.c.X.d(t,this.b.aY)>0),this.U=s;const n=ze(0,0,0);s&&(r.a=this.c.m.d(t,this.b.aY,0),r.b=this.c.n.d(t,this.b.aY,0),r.i=this.c.o.d(t,this.b.aY,0),r.j=this.c.p.d(t,this.b.aY,0),this.c.q.d(t,this.b.aY,n,r.e),r.c=this.c.r.d(t,this.b.aY,0),r.d=this.c.t.d(t,this.b.aY,0),r.h=this.c.w.d(t,this.b.aY,0),r.g=this.c.v.d(t,this.b.aY,0),this.d?r.f=this.d.a:r.f=this.c.x.d(t,this.b.aY,0)),hi(i,i,this.b.W),hi(i,i,this.b.ar[this.c.d].m);let a=ii();bi(a,ze(this.c.c[0],this.c.c[1],this.c.c[2])),hi(i,i,a),hi(i,i,$a);let o=ii(),h=Ie();oi(o,this.b.aT.viewMatrix),_i(h,o),this.ac(e,i,h,null,this.b.aT.viewMatrix),this.am(this.b.aT.viewMatrix);let l=this.b.aT.context;this.M?(l.bindBuffer(l.ARRAY_BUFFER,this.M),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.G),l.DYNAMIC_DRAW)):(this.M=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,this.M),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.G),l.DYNAMIC_DRAW)),this.N||(this.N=l.createBuffer(),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.N),l.bufferData(l.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.H),l.DYNAMIC_DRAW))}aa(t){if(this.q.length<=0)return;const e=this.b.aT.context;if(this.W||(this.W=new ka,this.W.a=xe(e,["attribute vec3 aPosition;\r\nattribute vec4 aColor;\r\nattribute vec2 aTexcoord0;\r\nattribute vec2 aTexcoord1;\r\nattribute vec2 aTexcoord2;\r\nattribute float aAlphaCutoff;\r\n\r\nvarying vec4 vColor;\r\nvarying vec2 vTexcoord0;\r\nvarying vec2 vTexcoord1;\r\nvarying vec2 vTexcoord2;\r\nvarying float vAlphaCutoff;\r\n\r\nuniform mat4 uModelMatrix;\r\nuniform mat4 uViewMatrix;\r\nuniform mat4 uProjMatrix;\r\n\r\nvoid main(void) {\r\n    vec4 pos = vec4(aPosition, 1);\r\n\r\n    gl_Position = uProjMatrix * pos;\r\n\r\n    vColor = aColor;\r\n    vTexcoord0 = aTexcoord0;\r\n    vTexcoord1 = aTexcoord1;\r\n    vTexcoord2 = aTexcoord2;\r\n    vAlphaCutoff = aAlphaCutoff;\r\n}","precision mediump float;\r\n\r\nvarying vec4 vColor;\r\nvarying vec2 vTexcoord0;\r\nvarying vec2 vTexcoord1;\r\nvarying vec2 vTexcoord2;\r\nvarying float vAlphaCutoff;\r\n\r\nuniform bool uHasTexture;\r\nuniform bool uHasTexture2;\r\nuniform bool uHasTexture3;\r\nuniform bool uHasAlpha;\r\nuniform int uBlendMode;\r\nuniform int uPixelShader;\r\nuniform sampler2D uTexture;\r\nuniform sampler2D uTexture2;\r\nuniform sampler2D uTexture3;\r\nuniform float uAlphaTreshold;\r\n\r\nuniform float alphaMult;\r\nuniform float colorMult;\r\n\r\nvoid main(void) {\r\n    float lo_thresh = 0.01;\r\n    vec4 color = vec4(1, 1, 1, 1);\r\n    vec4 tex = vec4(1, 1, 1, 1);\r\n    vec4 tex2 = vec4(1, 1, 1, 1);\r\n    vec4 tex3 = vec4(1, 1, 1, 1);\r\n    if (uHasTexture) {\r\n        tex = texture2D(uTexture, vTexcoord0).rgba;\r\n    }\r\n    if (uHasTexture2) {\r\n        tex2 = texture2D(uTexture2, vTexcoord1).rgba;\r\n    }\r\n    if (uHasTexture3) {\r\n        tex3 = texture2D(uTexture3, vTexcoord2).rgba;\r\n    }\r\n    vec4 finalColor = vec4((tex * vColor ).rgb, tex.a*vColor.a );\r\n    vec3 matDiffuse = vec3(1.0);\r\n    float opacity = 1.0;\r\n    if (uPixelShader == 0) {\r\n        matDiffuse = vColor.xyz * tex.rgb;\r\n        opacity = tex.a*vColor.a;\r\n    } else if (uPixelShader == 1) {\r\n        vec4 textureMod = tex*tex2;\r\n        float texAlpha = (textureMod.w * tex3.w);\r\n        opacity = texAlpha*vColor.a;\r\n        matDiffuse = vColor.xyz * 4.0 * textureMod.rgb;\r\n    } else if (uPixelShader == 2) {\r\n        vec4 textureMod = tex*tex2*tex3;\r\n        float texAlpha = (textureMod.w);\r\n        opacity = texAlpha*vColor.a;\r\n        vec3 matDiffuse = vColor.xyz * textureMod.rgb;\r\n    } else if (uPixelShader == 3) {\r\n        vec4 textureMod = tex*tex2*tex3;\r\n        float texAlpha = (textureMod.w);\r\n        opacity = texAlpha*vColor.a;\r\n\r\n        matDiffuse = vColor.xyz * textureMod.rgb;\r\n    };\r\n\r\n    finalColor = vec4(matDiffuse.rgb * colorMult, opacity * alphaMult);\r\n\r\n    if (finalColor.a < vAlphaCutoff ) discard;\r\n    if (finalColor.a < uAlphaTreshold ) discard;\r\n    gl_FragColor = finalColor;\r\n}\r\n"],null,null),this.W.b={},this.W.a.attributes=[{loc:e.getAttribLocation(this.W.a.program,"aPosition"),type:e.FLOAT,size:3,offset:0,stride:56},{loc:e.getAttribLocation(this.W.a.program,"aColor"),type:e.FLOAT,size:4,offset:12,stride:56},{loc:e.getAttribLocation(this.W.a.program,"aTexcoord0"),type:e.FLOAT,size:2,offset:28,stride:56},{loc:e.getAttribLocation(this.W.a.program,"aTexcoord1"),type:e.FLOAT,size:2,offset:36,stride:56},{loc:e.getAttribLocation(this.W.a.program,"aTexcoord2"),type:e.FLOAT,size:2,offset:44,stride:56},{loc:e.getAttribLocation(this.W.a.program,"aAlphaCutoff"),type:e.FLOAT,size:1,offset:52,stride:56}],this.W.c=this.M,this.W.d=this.N,this.W.m=this.c.j),!this.T)if(this.T=[null,null,null],0!=(268435456&this.c.b))for(let t=0;t<this.c.f.length;t++){const e=this.c.f[t];e>-1&&e<this.b.ay.length&&(this.T[t]=this.b.ay[e])}else this.c.e>-1&&this.c.e<this.b.ay.length&&(this.T[0]=this.b.ay[this.c.e]);if(!this.T[0].f||!this.T[0].f.e)return;this.W.b.uViewMatrix=this.b.aT.viewMatrix,this.W.b.uProjMatrix=this.b.aT.projMatrix,this.W.b.uBlendMode=this.c.g,this.W.b.uPixelShader=this.s>1?this.s-1:0,this.W.b.colorMult=this.d?this.d.b:1,this.W.b.alphaMult=this.d?this.d.c:1;let i=[this.T[0]&&this.T[0].f&&this.T[0].f.e,this.T[1]&&this.T[1].f&&this.T[1].f.e,this.T[2]&&this.T[2].f&&this.T[2].f.e];this.W.b.uTexture=this.T[0].f.d,this.W.b.uTexture2=i[1]?this.T[1].f.d:null,this.W.b.uTexture3=i[2]?this.T[2].f.d:null,this.W.b.uHasTexture=i[0]?1:0,this.W.b.uHasTexture2=i[1]?1:0,this.W.b.uHasTexture3=i[2]?1:0;let r=this.c.g;4==r&&(r=3),this.W.e=r,this.W.i=!this.b.bZ;let s=-1;1==r?s=.501960814:r>1&&(s=1/255),this.W.b.uAlphaTreshold=s,this.W.h=!1,this.W.f=!1,this.W.j=e.TRIANGLES,this.W.k=6*this.F>>0,this.W.l=0,t.push(this.W)}ab(t,e){if(0==(16&this.c.b))for(let i=0;i<this.q.length;i++){const r=this.q[i];Qe(r.a,r.a,t),ti(r.c,r.c,e)}}ac(t,e,i,r,s){if(null==this.J)return;if(this.b.U)return;_i(this.m,this.e);let n=Ri();_i(n,e),n[3]=1,Li(n,n,s),this.n=n[2];let a=Ie();if(_i(a,s),this.ad(e,a,r),t>0){let e=Ie();if(_i(e,this.e),16384&this.c.b){He(this.p,e,this.m);let i=this.t*(Pe(this.p)/t)+this.u;i>=0&&(i=Math.min(i,1)),Ve(this.o,this.p,i)}if(64&this.c.b){this.v+=t;let i=.03;if(this.v>i)if(this.v=0,0==this.q.length){let t=i/this.v,r=Ie();He(r,e,this.m);let s=t*this.c.I;Ge(this.w,r,ze(s,s,s))}else Le(this.w,0,0,0)}this.ae(t)}}ad(t,e,i){if(Be(this.x,e),null==i||16&this.c.b)ri(this.e,t);else{let e=ii();oi(e,i),hi(this.e,e,t)}let r=Ie();gi(r,t),this.l=r[0]}ae(t){if((t=Math.max(t,0))<.1)Be(this.o,this.p);else{let e=Math.floor(t/.1);t=-.1*e+t;let i=Math.min(Math.floor(this.J.i().lifespan/.1),e),r=i+1,s=1;s=r<0?(1&r|r>>1)+(1&r|r>>1):r,Ve(this.o,this.p,1/s);for(let t=0;t<i;t++)this.af(.1)}this.af(t)}af(t){let e=new Qa;if(t<0)return;this.c.b,this.ag(e,t),this.ah(t);let i=0;for(;i<this.q.length;){let r=this.q[i];r.b=r.b+t,r.b>Math.max(this.J.g(r.e),.001)?(this.ak(i),i--):this.al(r,t,e)||(this.ak(i),i--),i++}}ag(t,e){t.a=Ie(),t.b=Ie(),t.c=Ie(),t.d=0;let i=ze(e,e,e),r=e*e*.5,s=ze(r,r,r);Ge(t.a,this.c.Q,i);let n=Ie();this.J.j(n),Ge(t.b,n,i),Ge(t.c,n,s),t.d=this.c.J*e}ah(t){if(!this.U)return;let e=this.J.d();for(this.y=this.y+t*e;this.y>1;)this.ai(t),this.y-=1}ai(t){let e=this.aj();if(this.J.k(e,t),!(16&this.c.b)){let t=Ui(e.a[0],e.a[1],e.a[2],1),i=Ui(e.c[0],e.c[1],e.c[2],0);Li(t,t,this.e),Li(i,i,this.e),Be(e.a,t),Be(e.c,i),8192&this.c.b&&(e.a[2]=0)}if(64&this.c.b){let t=1+this.J.i().speedVariation*this.K.e(),i=Ie();Ve(i,this.w,t),Ne(e.c,e.c,i)}if(this.s>=2)for(let t=0;t<2;t++){e.f[t][0]=this.K.f(),e.f[t][1]=this.K.f();let n=ji();qi(n,this.c.aa[t],this.K.e()),i=e.g[t],r=n,s=this.c.Z[t],i[0]=r[0]+s[0],i[1]=r[1]+s[1]}var i,r,s}aj(){let t=new Ja;return this.q.push(t),t}ak(t){this.q.splice(t,1)}al(t,e,i){if(this.s>=2)for(let i=0;i<2;i++){let r=t.f[i][0]+e*t.g[i][0];t.f[i][0]=r-Math.floor(r),r=t.f[i][1]+e*t.g[i][1],t.f[i][1]=r-Math.floor(r)}Ne(t.c,t.c,i.a),16384&this.c.b&&2*e<t.b&&Ne(t.a,t.a,this.o);let r=ze(e,e,e),s=Ie();if(Ge(s,t.c,r),Ne(t.c,t.c,i.b),Ve(t.c,t.c,1-i.d),Ne(t.a,t.a,s),Ne(t.a,t.a,i.c),2==this.c.h&&128&this.c.b){let e=Ie();if(Be(e,t.a),16&this.c.b){if(Je(e,s)>0)return!1}else{let i=Ie();if(_i(i,this.e),He(e,t.a,i),Je(e,s)>0)return!1}}return!0}am(t){if(this.G.length=0,0==this.q.length&&null!=this.J)return;oi(this.g,t),Xi(Yi(),t),this.an(null,t);let e=0;for(let t=0;t<this.q.length;t++){let i=this.q[t],r=new to;if(this.ap(i,r)&&(131072&this.c.b&&(this.ar(i,r),e++),262144&this.c.b&&(this.as(i,r),e++)),e>=1e3)break}this.F=e}an(t,e){var i,r,s;16&this.c.b?hi(this.h,e,this.e):null!=t?hi(this.h,e,t):ri(this.h,e),_i(this.i,e),4096&this.c.b&&(Xi(this.j,this.h),16&this.c.b&&Math.abs(this.l)>0&&(i=this.j,r=this.j,s=1/this.l,i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=r[7]*s,i[8]=r[8]*s),Le(this.k,this.j[6],this.j[7],this.j[8]),Ye(this.k)<=2.3841858e-7?Le(this.k,0,0,1):Ze(this.k,this.k))}ao(t){let e=0,i=0;if(0!=this.c.K||0!=this.c.N){let r=new Wa(t.e);e=0==this.c.L?this.c.K:this.c.K+r.e()*this.c.L,i=0==this.c.N?this.c.M:this.c.M+r.e()*this.c.N}else e=this.c.K,i=this.c.M;return{deltaSpin:i,baseSpin:e}}ap(t,e){let i=this.c.G,r=this.c.H,s=r[0],n=r[1]-s,a=0,o=t.e,h=t.b;if((i<1||0!=n)&&(a=127&h*this.c.F+o),i<Ka[a])return 0;this.aq(t,e,o);let l=n*Ka[a]+s;qi(e.c.a,e.c.a,l),32&this.c.b&&qi(e.c.a,e.c.a,this.l);let u=Ui(t.a[0],t.a[1],t.a[2],1);return Li(u,u,this.h),Be(e.a,u),e.b=1,1}aq(t,e,i){let r=t.b/this.J.f(),s=new Wa(i);Math.min(r,1)<=0?r=0:r>=1&&(r=1);let n=ze(255,255,255),a=Wi(1,1),o=1,h=e.c;this.c.y.i(r,n,h.b,this.I),this.I||Ve(h.b,h.b,1/255),this.c.A.i(r,a,h.a),h.e=this.c.z.i(r,32767)/32767,this.d?h.f=this.d.d.i(r,0)/32767:h.f=0;let l=0;this.c.C.a.length>0?(o=0,h.c=this.c.C.i(r,o),h.c=this.z&h.c+this.A):65536&this.c.b?(l=(this.z+1)*s.d(),h.c=l/4294967296|0):h.c=0,o=0,h.d=this.c.D.i(r,o),h.d=h.d+this.A&this.z;let u=1;524288&this.c.b?(u=Math.max(1+s.e()*this.c.B[1],99999997e-12),h.a[0]=Math.max(1+s.e()*this.c.B[0],99999997e-12)*h.a[0]):(u=Math.max(1+s.e()*this.c.B[0],99999997e-12),h.a[0]=u*h.a[0]),h.a[1]=u*h.a[1]}ar(t,e){let i=Wi((e.c.c&this.C)*this.D,(e.c.c>>this.B)*this.E),r=0,s=0,n=this.ao(t);r=n.baseSpin,s=n.deltaSpin;let a=0,o=ze(0,0,0),h=ze(0,0,0),l=!1,u=!1;if(4&this.c.b&&Ye(t.c)>2.3841858e-7)if(a=1,4096&this.c.b)l=!0;else{let i=Ui(-t.c[0],-t.c[1],-t.c[2],0);Li(i,i,this.h);let r=Ie();Be(r,i);let s=0,n=Ye(r);s=n<=2.3841858e-7?0:1/Math.sqrt(n);let a=Ie();Be(a,r),Ve(a,a,s),Be(o,a),Ve(o,o,e.c.a[0]),h=ze(a[1],-a[0],0),Ve(h,h,e.c.a[1]),u=!0,l=!1}if((4096&this.c.b||l)&&!u){let i=Yi();c=i,f=this.j,c[0]=f[0],c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=f[6],c[7]=f[7],c[8]=f[8];let n=e.c.a[0];if(a){let r=0,s=ze(-t.c[0],-t.c[1],-t.c[2]),a=Ye(s);r=a<=2.3841858e-7?0:1/Math.sqrt(a),function(t,e,i){var r=e[0],s=e[1],n=e[2],a=e[3],o=e[4],h=e[5],l=e[6],u=e[7],c=e[8],f=i[0],d=i[1],b=i[2],_=i[3],g=i[4],p=i[5],m=i[6],v=i[7],x=i[8];t[0]=f*r+d*a+b*l,t[1]=f*s+d*o+b*u,t[2]=f*n+d*h+b*c,t[3]=_*r+g*a+p*l,t[4]=_*s+g*o+p*u,t[5]=_*n+g*h+p*c,t[6]=m*r+v*a+x*l,t[7]=m*s+v*o+x*u,t[8]=m*n+v*h+x*c}(i,this.j,function(t,e,i,r,s,n,a,o,h){var l=new Ue(9);return l[0]=t,l[1]=e,l[2]=0,l[3]=r,l[4]=s,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l}(s[0]*r,s[1]*r,0,-s[1]*r,s[0]*r)),r>2.3841858e-7&&(n=e.c.a[0]*(1/Math.sqrt(Ye(t.c))/r))}if(this.s,Le(o,i[0],i[1],i[2]),Ve(o,o,n),Le(h,i[3],i[4],i[5]),Ve(h,h,e.c.a[1]),s=h[0],u=!0,0!=this.c.M||0!=this.c.N){let e=r+s*t.b;512&this.c.b&&1&t.e&&(e=-e);let i=Ie();Be(i,this.k),this.s;let n=Yi(),a=Zi();(function(t,e,i){i*=.5;var r=Math.sin(i);t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(i)})(a,i,e),function(t,e){var i=e[0],r=e[1],s=e[2],n=e[3],a=i+i,o=r+r,h=s+s,l=i*a,u=r*a,c=r*o,f=s*a,d=s*o,b=s*h,_=n*a,g=n*o,p=n*h;t[0]=1-c-b,t[3]=u-p,t[6]=f+g,t[1]=u+p,t[4]=1-l-b,t[7]=d-_,t[2]=f-g,t[5]=d+_,t[8]=1-l-c}(n,a),ti(o,o,n),Le(h,s,h[1],h[2]),ti(h,h,n)}}var c,f;if(!u)if(0!=this.c.M||0!=this.c.N){let i=r+s*t.b;512&this.c.b&&1&t.e&&(i=-i);let n=Math.cos(i),a=Math.sin(i);Le(o,n,a,0),Ve(o,o,e.c.a[0]),Le(h,-a,n,0),Ve(h,h,e.c.a[1]),134217728&this.c.b&&Ne(e.a,e.a,ze(h[0],h[1],0))}else Le(o,e.c.a[0],0,0),Le(h,0,e.c.a[1],0);return this.at(o,h,e.a,e.c.b,e.c.e,e.c.f,i[0],i[1],t.f),0}as(t,e){let i=Wi((e.c.d&this.C)*this.D,(e.c.d>>this.B)*this.E),r=ze(0,0,0),s=ze(0,0,0),n=this.c.E;1024&this.c.b&&(n=Math.min(t.b,n));let a=Ri();Ve(a,t.c,-1),a[3]=0,Li(a,a,this.h),Ve(a,a,n);let o=ze(a[0],a[1],0);if(Je(o,o)>1e-4){let t=1/Pe(o);qi(e.c.a,e.c.a,t),function(t,e,i){t[0]=e[0]*i[0],t[1]=e[1]*i[1]}(o,o,e.c.a),s=ze(-o[1],o[0],0),Ve(r,a,.5),Ne(e.a,e.a,r)}else r=ze(.05*e.c.a[0],0,0),s=ze(0,.05*e.c.a[1],0);return this.at(r,s,e.a,e.c.b,e.c.e,e.c.f,i[0],i[1],t.f),1}at(t,e,i,r,s,n,a,o,h){const l=[-1,-1,1,1],u=[1,-1,1,-1],c=[0,0,1,1],f=[0,1,0,1];let d=Ie(),b=ji(),_=ji(),g=ji();for(let p=0;p<4;p++)Le(d,0,0,0),qe(d,d,t,l[p]),qe(d,d,e,u[p]),Ne(d,d,i),Vi(b,c[p]*this.D+a,f[p]*this.E+o),Vi(_,c[p]*this.c.Y[0]+h[0][0],f[p]*this.c.Y[0]+h[0][1]),Vi(g,c[p]*this.c.Y[1]+h[1][0],f[p]*this.c.Y[1]+h[1][1]),this.G.push(d[0]),this.G.push(d[1]),this.G.push(d[2]),this.G.push(r[0]),this.G.push(r[1]),this.G.push(r[2]),this.G.push(s),this.G.push(b[0]),this.G.push(b[1]),this.G.push(_[0]),this.G.push(_[1]),this.G.push(g[0]),this.G.push(g[1]),this.G.push(n)}},ro=class{constructor(t){var e=this;e.a=t.getFloat(),e.b=t.getFloat(),e.c=t.getFloat(),e.d=new lr(t)}},so=class{constructor(t){this.buffer=new DataView(t),this.position=0}getBool(){var t=0!=this.buffer.getUint8(this.position);return this.position+=1,t}getUint8(){var t=this.buffer.getUint8(this.position);return this.position+=1,t}getInt8(){var t=this.buffer.getInt8(this.position);return this.position+=1,t}getUint16(){var t=this.buffer.getUint16(this.position,!0);return this.position+=2,t}getInt16(){var t=this.buffer.getInt16(this.position,!0);return this.position+=2,t}getUint32(){var t=this.buffer.getUint32(this.position,!0);return this.position+=4,t}getInt32(){var t=this.buffer.getInt32(this.position,!0);return this.position+=4,t}getFloat(){var t=this.buffer.getFloat32(this.position,!0);return this.position+=4,t}getString(t){void 0===t&&(t=this.getUint16());for(var e="",i=0;i<t;++i)e+=String.fromCharCode(this.getUint8());return e}setBool(t){this.buffer.setUint8(this.position,t?1:0),this.position+=1}setUint8(t){this.buffer.setUint8(this.position,t),this.position+=1}setInt8(t){this.buffer.setInt8(this.position,t),this.position+=1}setUint16(t){this.buffer.setUint16(this.position,t,!0),this.position+=2}setInt16(t){this.buffer.setInt16(this.position,t,!0),this.position+=2}setUint32(t){this.buffer.setUint32(this.position,t,!0),this.position+=4}setInt32(t){this.buffer.setInt32(this.position,t,!0),this.position+=4}setFloat(t){this.buffer.setFloat32(this.position,t,!0),this.position+=4}};class no{constructor(){this.a=Ie(),this.b=Ri(),this.c=ji()}}class ao{}const oo=[0,1,2,10,3,4,5,13];function ho(t,e){return ze(t[4*e+0],t[4*e+1],t[4*e+2])}class lo{}const uo=class{constructor(t,e){this.g=Ie(),this.h=Ie(),this.p=new ao,this.q=Ie(),this.r=Ie(),this.s=Ie(),this.t=Ie(),this.u=Ie(),this.v=Ie(),this.w=Ie(),this.x=Ie(),this.y=Ie(),this.z=Ie(),this.A=Ie(),this.B=Ie(),this.O=Ie(),this.V=t.aT.context,this.a=t;let i=new lo;var r;if(i.a=e.getInt32(),i.b=e.getInt32(),i.c=ze(e.getFloat(),e.getFloat(),e.getFloat()),(r=e.getInt32())>0){i.j=new Array(r);for(let t=0;t<r;++t)i.j[t]=e.getInt16()}if((r=e.getInt32())>0){i.k=new Array(r);for(let t=0;t<r;++t)i.k[t]=e.getInt16()}i.l=new ur(e,er),i.m=new ur(e,rr),i.n=new ur(e,sr),i.o=new ur(e,sr),i.d=e.getFloat(),i.e=e.getFloat(),i.f=e.getFloat(),i.g=e.getInt16(),i.h=e.getInt16(),i.p=new ur(e,rr),i.q=new ur(e,nr),i.r=e.getInt16(),this.U=i,this.ab=new Array(i.k.length),this.ae=new Array(i.k.length);for(let e=0;e<i.k.length;e++)this.ae[e]=t.ax[i.k[e]];let s=Ui(255,255,255,255),n=new ao;n.a=0,n.b=0,n.c=1,n.d=1,this.au(i.d,i.e,s,n,i.h,i.g),this.ag(i.f),this.af(!1)}af(t){this.L=t,this.L||(this.J=!1)}ag(t){this.S=t}ah(){return this.e==this.d}ai(t){this.R=t}aj(t){this.Q=t}ak(t){this.F[3]=Math.max(t,0)}al(){let t=Ie();ei(t,this.g,this.O);let e=Ye(t);Ve(t,this.q,this.R),He(this.w,this.g,t),Ve(t,this.r,this.R),He(this.x,this.O,t),Ve(t,this.q,this.Q),Ne(this.y,this.g,t),Ve(t,this.r,this.Q),Ne(this.z,this.O,t),Ve(this.u,this.s,e),Ve(this.v,this.t,e)}am(t,e,i){let r;if(this.M&&this.L){r=t;let i=Ie();_i(i,r),Ne(i,i,e),Be(this.h,e),this.J?(Be(this.g,this.O),Be(this.s,this.t),Be(this.q,this.r)):(Be(this.g,i),this.s=ho(r,2),this.q=ho(r,1),this.f=0,this.J=!0),this.O=i,this.t=ho(r,2),this.r=ho(r,1)}}an(t){var e=Yi();Xi(e,t),this.s=ti(this.s,this.s,e),this.q=ti(this.q,this.q,e),this.t=ti(this.t,this.t,e),this.r=ti(this.r,this.r,e),this.g=Qe(this.g,this.g,t),this.O=Qe(this.O,this.O,t);for(var i=0;i<this.i.length;i++)Qe(this.i[i].a,this.i[i].a,t)}ao(t,e,i){this.F[2]=i,this.F[1]=e,this.F[0]=t}ap(t){if(this.P!=t){this.P=t;let e=t%this.I,i=e;0!=(2147483648&e)&&(i=(1&e|e>>1)+(1&e|e>>1));let r=i*this.l+this.G.b;this.p.b=r;let s=t/this.I,n=s;0!=(2147483648&s)&&(s=1&s|s>>1,n=s+s,r=this.p.b);let a=n*this.m+this.G.a;this.p.a=a,this.p.d=r+this.l,this.p.c=a+this.m}}aq(t,e,i){let r,s=this.i[2*this.d],n=this.i[2*this.d+1],a=Ie();Ve(a,this.v,1-e),He(a,this.x,a),Ve(s.a,a,e),Ve(a,this.u,e),Ne(a,this.w,a),Ve(a,a,1-e),Ne(s.a,s.a,a),Ve(a,this.v,1-e),He(a,this.z,a),Ve(n.a,a,e),Ve(a,this.u,e),Ne(a,this.y,a),Ve(a,a,1-e),Ne(n.a,n.a,a),this.c[this.d]=t,r=i,this.d=this.d+r,this.d>=this.c.length&&(this.d-=this.c.length)}ar(t,e){if(this.a.U)return;let i=Ie(),r=1;i=this.U.l.d(t,this.a.aY,i),r=this.U.m.d(t,this.a.aY),this.ao(i[0],i[1],i[2]),this.ak(r/32767);let s=this.U.n.d(t,this.a.aY);this.aj(s);let n=this.U.o.d(t,this.a.aY);this.ai(n);let a=this.U.p.d(t,this.a.aY);this.ap(a);let o=this.U.q.d(t,this.a.aY,1);this.af(0!=o);let h=ii();mi(h,this.a.W,this.a.ar[this.U.b].m),li(h,h,this.U.c);let l=Ie();this.am(h,l,null),this.as(e,!1)}as(t,e){let i,r,s,n,a,o,h,l,u,c,f,d,b,_,g,p,m,v,x,T,w,y,A,E,C,M,S,k,D,F,R,U,I,O,P,z,B,L,N,H,G,j,W,V,q,Y,X,Z;for(this.N||this.C>0&&(t=1/this.C+99999997e-12),t>=0?this.D<=t&&(t=this.D):t=0,v=this.e;v!=this.d&&!(t+this.c[v]<=this.D);v=this.e)this.e=this.at(this.e,1);if(!e&&this.M&&this.L&&this.J){R=t*this.C+this.f,Z=this.F,this.al();let e=!1;if(O=0,R<1?e=!0:(X=this.f,I=1/(R-X),m=Math.floor(R-1),O=Math.ceil(Math.max(m,0))),-1==O||e);else for(U=1,v=1;F=this.d,L=this.i.length,this.i[2*F].b=Z,x=2*this.d+1,N=this.i.length,this.i[x].b=Z,this.aq((v-X)*I*-t,(v-X)*I,1),-1!=--O;v=U)U+=1,X=this.f;T=Math.floor(R),this.f=R-T,this.aq(0,1,0),D=this.d,H=this.i.length,w=this.i[2*D],y=this.p.b,w.c[1]=this.p.a,w.c[0]=y,A=2*this.d+1,G=this.i.length,E=this.i[A],C=this.p.b,E.c[1]=this.p.c,E.c[0]=C,k=this.d,j=this.i.length,this.i[2*k].b=Z,M=2*this.d+1,W=this.i.length,this.i[M].b=Z}this.A[2]=34028235e31,this.A[1]=34028235e31,this.A[0]=34028235e31,this.B[2]=-34028235e31,this.B[1]=-34028235e31,this.B[0]=-34028235e31,P=this.e;for(let e=this.e;e!=this.d;P=e)p=2*e,Y=this.i.length,S=P,B=this.i[2*e],i=p+1,r=this.i[2*e+1],s=(this.S+this.S)*this.c[S]*t+t*this.S*t,B.a[2]=B.a[2]+s,r.a[2]=s+r.a[2],n=B.a[0],a=this.A[0],a>B.a[0]&&(a=B.a[0],this.A[0]=n,n=B.a[0]),o=B.a[1],h=this.A[1],h>o&&(h=B.a[1],this.A[1]=o,o=B.a[1]),l=B.a[2],u=this.A[2],u>l&&(u=B.a[2],this.A[2]=l,l=B.a[2]),n>this.B[0]&&(this.B[0]=n),o>this.B[1]&&(this.B[1]=o),l>this.B[2]&&(this.B[2]=l),c=r.a[0],a>r.a[0]&&(this.A[0]=c,c=r.a[0]),f=r.a[1],h>f&&(this.A[1]=f,f=r.a[1]),d=r.a[2],u>d&&(this.A[2]=d,d=r.a[2]),c>this.B[0]&&(this.B[0]=c),f>this.B[1]&&(this.B[1]=f),d>this.B[2]&&(this.B[2]=d),V=this.c.length,this.c[S]=t+this.c[S],b=this.l,q=this.c.length,_=b*this.c[S]*this.k+this.p.b,B.c[1]=this.p.a,B.c[0]=_,r.c[1]=this.p.c,r.c[0]=_,g=this.c.length,z=P+1,e=z-g,g>z&&(e=z);this.N=!0}at(t,e){let i=e+t;t=i;let r=this.c.length;return i>=r&&(t=i-r),t}au(t,e,i,r,s,n){let a,o,h,l,u,c,f,d;f=Math.ceil(t),d=Math.max(.25,e),a=Math.ceil(d*f),o=Math.ceil(Math.max(a+1+1,0)),this.c=new Array(o),this.e=0,this.d=0,this.f=0,this.J=!1,this.i=new Array(2*o);for(let t=0;t<this.i.length;t++){this.i[t]=new no;let e=this.i[t];e.a[0]=0,e.a[1]=0,e.a[2]=0,e.b=Ui(0,0,0,0),e.c[0]=0,e.c[1]=0}this.j=new Array(4*o);for(let t=0;t<this.j.length;t++)this.j[t]=t%(2*o);this.k=1/d,h=n,0!=(2147483648&n)&&(h=(1&n|n>>1)+(1&n|n>>1)),this.l=(r.d-r.b)/h,l=s,0!=(2147483648&s)&&(l=(1&s|s>>1)+(1&s|s>>1)),this.m=(r.c-r.a)/l,this.n=1/this.l,this.o=1/this.m,this.C=f,this.D=d,Pi(i,i,1/255),this.F=i,this.G=r,this.H=s,this.I=n,this.P=0,u=0*this.l+this.G.b,this.p.b=u,c=0*this.m+this.G.a,this.p.a=c,this.p.d=u+this.l,this.p.c=c+this.m,this.Q=10,this.R=10,this.S=0,this.M=!0,this.L=!0,this.K=!0}av(){let t=new Array(this.i.length);for(let e=0,i=0;e<this.i.length;++e)t[i++]=this.i[e].a[0],t[i++]=this.i[e].a[1],t[i++]=this.i[e].a[2],t[i++]=this.i[e].b[0],t[i++]=this.i[e].b[1],t[i++]=this.i[e].b[2],t[i++]=this.i[e].b[3],t[i++]=this.i[e].c[0],t[i++]=this.i[e].c[1];if(this.ah())return;let e=this.V;this.W?(e.bindBuffer(e.ARRAY_BUFFER,this.W),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.DYNAMIC_DRAW)):(this.W=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.W),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.DYNAMIC_DRAW)),this.X?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.X),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.j),e.DYNAMIC_DRAW)):(this.X=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.X),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.j),e.DYNAMIC_DRAW))}aw(t){if(this.ah())return;let e=this.V;for(let r=0;r<this.U.j.length;r++){if(!this.ab[r]){let t=new ka;t.a=xe(e,["        attribute vec3 aPosition;\n        attribute vec4 aColor;\n        attribute vec2 aTexcoord0;\n        uniform mat4 uViewMatrix;\n        uniform mat4 uProjMatrix;\n        varying vec4 vColor;\n        varying vec2 vTexcoord0;\n        void main() {\n            vec4 aPositionVec4 = vec4(aPosition, 1);\n            vColor = aColor;\n            vTexcoord0 = aTexcoord0;\n            gl_Position = uProjMatrix * uViewMatrix * aPositionVec4;\n        }","    precision mediump float;    varying vec4 vColor;\n    varying vec2 vTexcoord0;\n    uniform sampler2D uTexture;\n    void main() {\n        vec4 tex = texture2D(uTexture, vTexcoord0).rgba;\n        gl_FragColor = vec4((vColor.rgb*tex.rgb), tex.a * vColor.a );\n    }"],null,null),t.b={},t.a.attributes=[{loc:e.getAttribLocation(t.a.program,"aPosition"),type:e.FLOAT,size:3,offset:0,stride:36},{loc:e.getAttribLocation(t.a.program,"aColor"),type:e.FLOAT,size:4,offset:12,stride:36},{loc:e.getAttribLocation(t.a.program,"aTexcoord0"),type:e.FLOAT,size:2,offset:28,stride:36}],t.c=this.W,t.d=this.X,this.ab[r]=t}var i=this.U.j[r];if(i<=-1||i>this.a.ay.length)continue;let s=this.a.ay[i];if(!s.f||!s.f.e)continue;let n=r;n>=this.U.k.length&&(n=0);let a=this.a.ax[this.U.k[n]];this.ab[r].b.uViewMatrix=this.a.aT.viewMatrix,this.ab[r].b.uProjMatrix=this.a.aT.projMatrix,this.ab[r].b.uTexture=s.f.d,this.ab[r].h=!1,this.ab[r].f=!1,this.ab[r].e=oo[a.b],this.ab[r].i=!this.a.bZ;let o=this.d>this.e?2*(this.d-this.e)+2:2*(this.c.length+this.d-this.e)+2;this.ab[r].j=e.TRIANGLE_STRIP,this.ab[r].k=o,this.ab[r].l=2*this.e*2,t.push(this.ab[r])}}},co="uniform float x;\r\nuniform float y;\r\nuniform float width;\r\nuniform float height;\r\n\r\nattribute vec2 aTextCoord;\r\nvarying vec2 vTextCoords;\r\nvoid main() {\r\n    vTextCoords = aTextCoord;\r\n\r\n    vec2 pos = vec2(\r\n        (x + aTextCoord.x*width)* 2.0 - 1.0,\r\n        (y + aTextCoord.y*height)* 2.0 - 1.0\r\n    );\r\n\r\n    gl_Position = vec4(pos.x, pos.y, 0, 1);\r\n}";class fo{constructor(){this.a=null,this.b=null,this.c=null}d(){null!=this.a&&this.a.g(),null!=this.b&&this.b.g(),null!=this.c&&this.c.g()}e(){return!(this.a&&!this.a.f()||this.b&&!this.b.f()||this.c&&!this.c.f())}}class bo{constructor(){this.a=null,this.b=null,this.c=null,this.d={},this.i=new ke,this.j=null,this.k=null}}class _o{constructor(t,e,i){this.e=null,this.i=!1,this.f=t,this.g=e,this.h=i,this.e=function(t){let e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),t.bindTexture(t.TEXTURE_2D,null);let i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,0,255])),t.bindTexture(t.TEXTURE_2D,null);let r=new bo;return r.j=e,r.k=i,r.a=xe(t,[co,"precision mediump float;\r\n\r\nvarying vec2 vTextCoords;\r\nuniform sampler2D uDiffuseTexture;\r\nuniform sampler2D uSpecularTexture;\r\nuniform sampler2D uEmissiveTexture;\r\nuniform sampler2D renderResultTexture;\r\nuniform int uBlendMode;\r\nuniform vec2 screenResolution;\r\nuniform int layer;\r\n\r\nfloat overlayBlend(float a, float b) {\r\n    if (b > 0.5) {\r\n        return (1.0 - (1.0 - 2.0 * (a - 0.5)) * (1.0 - b));\r\n    } else {\r\n        return ((2.0 * a) * b);\r\n    }\r\n}\r\n\r\nfloat alphaStraightBlend(float a, float b, float alpha) {\r\n    return (a * alpha) + (b * (1.0 - alpha));\r\n}\r\n\r\nvoid main() {\r\n    vec4 diffuse = texture2D( uDiffuseTexture, vTextCoords.xy );\r\n    vec4 backGround = texture2D( renderResultTexture, gl_FragCoord.xy / screenResolution );\r\n\r\n    if (uBlendMode == 1) {\r\n        // Blit (we do nothing?)\r\n        //if (diffuse.a < 0.001) discard;\r\n\r\n        //vec4 finalColor = diffuse;\r\n\r\n        //diffuse = vec4(finalColor.rgb, finalColor.a);\r\n    } else if (uBlendMode == 2) {\r\n        // Multiply\r\n        if (diffuse.a < 0.001) discard;\r\n\r\n        vec4 multTexture = diffuse;\r\n        vec3 finalColor = (backGround.rgb * multTexture.rgb);\r\n\r\n        diffuse = vec4(finalColor.rgb, 1.0);\r\n    } else if (uBlendMode == 3) {\r\n        // Overlay\r\n        if (diffuse.a < 0.001) discard;\r\n\r\n        vec4 overlayTex = diffuse;\r\n\r\n        vec3 finalColor = vec3(\r\n            overlayBlend(overlayTex.r, backGround.r),\r\n            overlayBlend(overlayTex.g, backGround.g),\r\n            overlayBlend(overlayTex.b, backGround.b)\r\n        );\r\n\r\n        vec3 mainTexVisible = backGround.rgb * (1.0 - overlayTex.a);\r\n        vec3 overlayTexVisible = finalColor.rgb * (overlayTex.a);\r\n        finalColor = (mainTexVisible + overlayTexVisible);\r\n\r\n        diffuse = vec4(finalColor, backGround.a);\r\n    } else if (uBlendMode == 5) {\r\n        // AlphaStraight\r\n        vec4 overlayTex = diffuse;\r\n\r\n        //float alphaMult = 1.0;\r\n        //vec3 finalColor = vec3(\r\n        //    alphaStraightBlend(overlayTex.r, backGround.r, alphaMult*overlayTex.a),\r\n        //    alphaStraightBlend(overlayTex.g, backGround.g, alphaMult*overlayTex.a),\r\n        //    alphaStraightBlend(overlayTex.b, backGround.b, alphaMult*overlayTex.a)\r\n        //);\r\n        vec3 finalColor = overlayTex.rgb * overlayTex.a + backGround.rgb * (1.0 - overlayTex.a);\r\n\r\n        diffuse = vec4(finalColor.rgb, 1.0);\r\n    } else if (uBlendMode == 0 || uBlendMode == 4 || uBlendMode == 6 || uBlendMode == 7) {\r\n        // default, Screen, InferAlphaBlend, Unknown1\r\n        if (diffuse.a < 0.001) discard;\r\n\r\n        vec3 finalColor = mix(backGround.rgb, diffuse.rgb, diffuse.a);\r\n\r\n        diffuse = vec4(finalColor.rgb, 1.0);\r\n    }\r\n\r\n    gl_FragColor = diffuse;\r\n}"],null,null),r.b=xe(t,[co,"precision mediump float;\r\n\r\nvarying vec2 vTextCoords;\r\nuniform sampler2D uDiffuseTexture;\r\nuniform sampler2D uSpecularTexture;\r\nuniform sampler2D uEmissiveTexture;\r\nuniform sampler2D renderResultTexture;\r\nuniform int uBlendMode;\r\n\r\nvoid main() {\r\n    vec4 diffuse = texture2D( uDiffuseTexture, vTextCoords.xy );\r\n    vec4 specular = texture2D( uSpecularTexture, vTextCoords.xy );\r\n    if (diffuse.a < 0.001) discard;\r\n    gl_FragColor = vec4(specular.rgb, 1.0);\r\n}"],null,null),r.c=xe(t,[co,"precision mediump float;\r\n\r\nvarying vec2 vTextCoords;\r\nuniform sampler2D uDiffuseTexture;\r\nuniform sampler2D uSpecularTexture;\r\nuniform sampler2D uEmissiveTexture;\r\nuniform sampler2D renderResultTexture;\r\nuniform int uBlendMode;\r\nuniform vec2 screenResolution;\r\nuniform float emissiveAlphaOverride;\r\nuniform int layer;\r\n\r\nvoid main() {\r\n    vec4 diffuse = texture2D( uDiffuseTexture, vTextCoords.xy );\r\n    vec4 emissive = texture2D( uEmissiveTexture, vTextCoords.xy );\r\n    vec4 backGround = texture2D( renderResultTexture, gl_FragCoord.xy / screenResolution );\r\n\r\n    if (diffuse.a < 0.001) discard;\r\n//    if (emissive.a < 0.001) discard;\r\n\r\n    //TODO: This is a hack from what was observed in Nightborne texture customization with tatoos.\r\n    //TODO: But Maybe switch should be over layer or something else instead of blend\r\n    float alpha = 1.0;\r\n\r\n    if (emissiveAlphaOverride > -1.0) {\r\n        alpha = emissiveAlphaOverride;\r\n    } else if (layer <= 1) {\r\n        alpha = 0.0;\r\n    } else {\r\n        alpha = emissive.a;\r\n    }\r\n\r\n    gl_FragColor = vec4(emissive.rgb, alpha);\r\n}"],null,null),r.d={},r.f=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r.f),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),r.e=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Int16Array([0,1,2,1,3,2]),t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),r.g=t.createFramebuffer(),r.h={loc:t.getAttribLocation(r.a.program,"aTextCoord"),type:t.FLOAT,size:2,offset:0,stride:0},r}(t)}j(){let t=this.f;this.d&&t.deleteTexture(this.d),this.a&&t.deleteTexture(this.a),this.b&&t.deleteTexture(this.b),this.c&&t.deleteTexture(this.c),this.d=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.d),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.g,this.h,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),this.a=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.a),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.g,this.h,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),this.b=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.b),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.g,this.h,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),this.c=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.c),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.g,this.h,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,this.e.g),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.a,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.b,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.c,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.useProgram(this.e.b.program),t.bindBuffer(t.ARRAY_BUFFER,this.e.f),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.e.e),this.e.i.disableAll(),this.e.i.enable(t,[this.e.h]),t.viewport(0,0,this.g,this.h)}k(t,e,i,r,s,n,a,o){let h=this.f;this.e.d.x=e,this.e.d.y=i,this.e.d.width=r,this.e.d.height=s,null==t.b&&null==t.c||(this.i=!0);let l=0;1==n?l=1:4==n?l=2:6==n?l=3:7==n?l=4:9==n?l=5:15==n?l=6:16==n&&(l=7),this.e.d.uBlendMode=l,this.e.d.screenResolution=new Float32Array([this.g,this.h]),this.e.d.uDiffuseTexture=null!=t.a?t.a.d:this.e.j,this.e.d.uSpecularTexture=null!=t.b?t.b.d:this.e.j,this.e.d.uEmissiveTexture=null!=t.c?t.c.d:this.e.k,this.e.d.renderResultTexture=null!=this.d?this.d:this.e.j,this.e.d.layer=a,this.e.d.emissiveAlphaOverride=o,h.disable(h.CULL_FACE),h.disable(h.DEPTH_TEST),h.disable(h.BLEND),h.useProgram(this.e.a.program),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,this.a,0),h.bindTexture(h.TEXTURE_2D,this.d),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,this.g,this.h,0),h.bindTexture(h.TEXTURE_2D,null),ge(this.e.a,this.e.d),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0),h.useProgram(this.e.b.program),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,this.b,0),h.bindTexture(h.TEXTURE_2D,this.d),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,this.g,this.h,0),h.bindTexture(h.TEXTURE_2D,null),ge(this.e.b,this.e.d),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0),h.useProgram(this.e.c.program),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,this.c,0),h.bindTexture(h.TEXTURE_2D,this.d),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,this.g,this.h,0),h.bindTexture(h.TEXTURE_2D,null),ge(this.e.c,this.e.d),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0),h.useProgram(null)}l(){let t=this.f;t.bindFramebuffer(t.FRAMEBUFFER,null),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST)}m(t){if(0==t)return this.a;if(1==t)return this.b;if(2==t)return this.c;throw new Error("unknown usage "+t)}n(){let t=this.f;this.d&&t.deleteTexture(this.d),this.a&&t.deleteTexture(this.a),this.b&&t.deleteTexture(this.b),this.c&&t.deleteTexture(this.c),this.a=null,this.b=null,this.c=null,this.d=null,this.e=null,this.f=null}}class go{constructor(t,e){this.a=t,this.b=e}c(){const t=[];for(let e of this.b.Options)for(let i of e.Choices)for(let e of i.Elements)e.SkinnedModel&&t.push(e.SkinnedModel.CollectionFileDataID);const e=new Set(t);if(0!=e.size)for(let t of e){let e={type:wi.PATH,id:t,parent:this.a,shoulder:0};this.a.A[t]=new yo(this.a.aT,this.a.l,e,0,!1,!1,!1)}}d(t){return Ga.a(this.a,this.b.TextureFiles[t],this.a.p,this.a.q,this.a.o)}e(t){this.a.O=[],this.a.bw(0);for(let t=0;t<this.a.L.length;t++)this.a.L[t]=-1;for(let t in this.a.A){let e=this.a.A[t];for(let t=0;t<e.L.length;t++)e.L[t]=-1,e.M[t]=!1}for(let e=0;e<t.length;e++){let i=this.b.Options.find((i=>i.Id==t[e].optionId));if(i){let r=i.Choices.find((i=>i.Id==t[e].choiceId));if(r){let e=r.Elements.filter((e=>e.BoneSet&&e.BoneSet.BoneFileDataID&&(0==e.VariationChoiceID||t.some((t=>t.choiceId==e.VariationChoiceID)))));e.length>0&&this.a.bw(e[0].BoneSet.BoneFileDataID);let s=r.Elements.filter((e=>e.Material&&(0==e.VariationChoiceID||t.some((t=>t.choiceId==e.VariationChoiceID)))));s.sort(((t,e)=>e.VariationChoiceID-t.VariationChoiceID)),s.forEach((t=>{let e=this.d(t.Material.MaterialResourcesID);if(!e)return;let i=this.b.TextureLayers.find((e=>e.ChrModelTextureTargetID==t.Material.TextureTarget));i&&(this.a.E[t.Material.TextureTarget]||(this.a.E[t.Material.TextureTarget]=this.a.bC(i.TextureType,e)))})),r.Elements.filter((e=>e.Geoset&&(0==e.VariationChoiceID||t.some((t=>t.choiceId==e.VariationChoiceID))))).sort(((t,e)=>t.Geoset.GeosetType-e.Geoset.GeosetType||t.Geoset.GeosetID-e.Geoset.GeosetID)).forEach((t=>{this.a.bF(t.Geoset)})),r.Elements.filter((e=>e.SkinnedModel&&(0==e.VariationChoiceID||t.some((t=>t.choiceId==e.VariationChoiceID))))).forEach((t=>{this.a.A[t.SkinnedModel.CollectionFileDataID]&&this.a.A[t.SkinnedModel.CollectionFileDataID].bG(t.SkinnedModel)}));let n=r.Elements.find((e=>0!=e.CondModelFileDataId&&(0==e.VariationChoiceID||t.some((t=>t.choiceId==e.VariationChoiceID)))));if(24==i.Id||353==i.Id)if(n&&!this.a.c){let t=this.a.aT,e=this.a.a,i=t.models.indexOf(this.a);if(i>-1){t.models.splice(i,1),t.options.charCustomization=this.a.r;let r=new yo(t,t.options,e,i,!0,!1,!1,n.CondModelFileDataId);return r.r=this.a.r,t.models.push(r),this.a.bb(),void(this.a=r)}}else if(!n&&this.a.c){let t=this.a.aT,e=this.a.a,i=t.models.indexOf(this.a);if(i>-1){t.models.splice(i,1),t.options.charCustomization=this.a.r;let r=new yo(t,t.options,e,i,!0,!1,!1);return r.r=this.a.r,t.models.push(r),this.a.bb(),void(this.a=r)}}r.Elements.filter((e=>e.ChrCustItemGeoModifyID&&(0==e.VariationChoiceID||t.some((t=>t.choiceId==e.VariationChoiceID))))).forEach((t=>{this.a&&this.a.O.push(t.ChrCustItemGeoModifyID)}))}}}if(!this.a.E[10]){let e=this.b.Options.find((t=>t.Id==this.b.HairStyleOptionId));if(e){let i=e.Choices[1];if(i){let e=i.Elements.filter((e=>e.Material&&10==e.Material.TextureTarget&&(0==e.VariationChoiceID||t.some((t=>t.choiceId==e.VariationChoiceID)))));if(e.length>0){let t=this.d(e[0].Material.MaterialResourcesID);t&&(this.a.E[e[0].Material.TextureTarget]=this.a.bC(6,t))}}}}}f(){let t=[];for(let e=0;e<this.b.Options.length;e++){let i=this.b.Options[e];if(i){let e=i.Choices[0];e&&t.push({optionId:i.Id,choiceId:e.Id})}}this.e(t)}g(t){let e={options:t,sheathMain:-1,sheathOff:-1};for(let t of this.b.Options)e.options.some((e=>e.optionId==t.Id))||e.options.push({optionId:t.Id,choiceId:t.Choices[0].Id});return e}}const po=function(t,e){const i=Math.abs(t),r=Math.abs(e);return Number((i-Math.floor(i/r)*r).toPrecision(8))*Math.sign(t)},mo=51,vo=5200,xo="DressingRoom",To="Stand";class wo{constructor(t,e,i,r,s,n,a,o){this.f=!1,this.s=0,this.t=null,this.u=null,this.F=[],this.O=[],this.T=new Qi,this.V=!1,this.ap=[],this.aI=[],this.aJ=[],this.aS=!1,this.aU=null,this.aV=null,this.aW=null,this.aY=[],this.bZ=!1;var h=this;if(h.f=s,h.aT=t,h.a=i,h.b=r,h.c=o,h.d=!1,h.g=!0,h.h=!0,this.i=!1,h.af=n,h.l=e,yi[14]=14,yi[15]=15,h.j=null,h.m=h.l.mount&&h.l.mount.type==wi.NPC&&h.l.mount.id==h.a.id,h.k=null,h.n=h.l.pet&&h.l.pet.type==wi.NPC&&h.l.pet.id==h.a.id,h.a.type==wi.CHARACTER&&h.l.mount&&h.l.mount.type==wi.NPC&&h.l.mount.id&&(h.l.mount.parent=h,h.j=new wo(t,e,h.l.mount,0,!1,!1,!1)),h.a.type==wi.CHARACTER&&h.l.pet&&h.l.pet.type==wi.NPC&&h.l.pet.id&&(h.l.pet.parent=h,h.k=new wo(t,e,h.l.pet,0,!1,!1,!1)),h.l.extraModels&&!h.a.parent){h.B=[];const i=h.l.extraModels;if($.isArray(i))for(let r=0;r<i.length;++r){const s={type:wi.PATH,id:i[r][0],parent:h,shoulder:-1};h.B.push(new wo(t,e,s,0,!1,!1,!1))}}h.o=0,h.p=-1,h.q=h.l.cls?parseInt(h.l.cls):0,h.v=null,h.w=h.a.parent||null,h.y=new Map,this.z=[null,null],h.x=!1,h.A={},h.C={},h.aL={},h.aM=null,h.D={},h.E={},h.I=-1,h.J=-1,h.K=new Array(mo),h.L=new Array(mo),h.M=new Array(mo),h.N=[1,1,1,1,1,1,1,2,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1,0,0,1,0,1,0,0,0,2,1,1,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1],h.P=null,h.Q=0;for(let t=0;t<mo;t++)h.K[t]=100*t+h.N[t];h.R=0,h.S=0,h.T.c=0,h.T.a.a=-1,h.U=!1,h.W=ii(),h.X=Ui(1,1,1,1),h.Y=[.35,.35,.35,1],h.Z=[1,1,1,1],h.aa=[.35,.35,.35,1],h.ab=Ie(),h.ac=Ie(),h.ad=Ie(),Ze(h.ab,[5,-3,3]),Ze(h.ac,[5,5,5]),Ze(h.ad,[-5,-5,-5]),h.ae=!1,h.ag=ze(0,0,0),h.ah=ze(0,0,0),h.ai=ze(0,0,0),h.boundsSize=ze(0,0,0),h.am=null,h.an=null,h.ap=null,h.aq=null,h.ar=null,h.as=null,h.at=null,h.au=null,h.av=null,h.aw=null,h.ax=null,h.ay=null,h.az=null,h.aA=null,h.aB=null,h.aC=null,h.aD=null,h.aE=null,h.aF=null,h.aG=null,h.aH=null,h.aI=null,h.aJ=null,h.aO=ii(),h.aP=Ie(),h.aQ=Ie(),h.aR=Ri(),a||h.bV()}ba(t){if(this[t]){for(var e=this[t],i=0;i<e.length;++i)e[i]&&e[i].destroy&&e[i].destroy(),e[i]=null;this[t]=null}}bb(){var t=this;if(this.aS=!0,this.d=!1,t.aM&&t.aM.d(),t.aM=null,t.D)for(const e in t.D)t.D[e].d(),delete t.D[e];if(t.C)for(const e in t.C)t.C[e].g(),delete t.C[e];if(t.aL)for(const e in t.aL)t.aL[e].n(),delete t.aL[e];if(t.an&&(t.an=null),t.aq&&(t.aq=null),t.as&&(t.as=null),t.at&&(t.at=null),t.aw&&(t.aw=null),t.az&&(t.az=null),t.aB&&(t.aB=null),t.aC&&(t.aC=null),t.aE&&(t.aE=null),t.aH&&(t.aH=null),t.ax)for(let e=0;e<t.ax.length;++e)t.ax[e]=null;if(t.ax=null,this.ba("vertices"),this.ba("animations"),this.ba("bones"),this.ba("meshes"),this.ba("texUnits"),this.ba("materials"),this.ba("textureAnims"),this.ba("attachments"),this.ba("colors"),this.ba("alphas"),this.ba("particleEmitters"),this.ba("ribbonEmitters"),this.ba("skins"),this.ba("faces"),this.ba("hairs"),this.ap=null,t.y&&t.y.forEach(((e,i)=>{e.y(),t.y.set(i,null)})),t.j&&t.j.bb(),t.j=null,t.k&&t.k.bb(),t.k=null,t.A){for(const e in t.A)t.A[e].bb(),delete t.A[e];t.A=null}t.a=null,t.y=null,t.C=null,t.D=null,t.aL=null,t.K=null,t.W=null,t.Y=null,t.Z=null,t.aa=null,t.ab=null,t.ac=null,t.ad=null,t.ag=null,t.ah=null,t.ai=null,t.boundsSize=null,t.aO=null,t.aP=null,t.aQ=null,t.aR=null}getNumAnimations(){const t=this.j?this.j:this;return t.ap?t.ap.length+1:0}getAnimation(t){const e=this.j?this.j:this;return e.ap&&t>-1&&t<e.ap.length?e.ap[t].j:t==e.ap.length?xo:""}resetAnimation(){(this.j?this.j:this).setAnimation(To)}setAnimPaused(t){var e;this.U=t,null===(e=this.j)||void 0===e||e.setAnimPaused(t),this.F.forEach((e=>e.f(t)))}setAnimNoSubAnim(t){this.V=t}bh(t){var e;null===(e=this.k)||void 0===e||e.setAnimation(t)}setItems(t){const e=[];for(let i=0;i<t.length;i++)e.push([t[i].slot,t[i].display,t[i].visual]);e.forEach((t=>{const e=[parseInt(t[0]),parseInt(t[1])];this.l.items.push(e)})),this.bQ(e),this.x=!0}attachList(t){const e=t.split(","),i=[];for(let t=0;t<e.length;t+=2)i.push([e[t],e[t+1]]);i.forEach((t=>{const e=[parseInt(t[0]),parseInt(t[1])];this.l.items.push(e)})),this.bQ(i),this.x=!0}clearSlots(t){const e=t.split(",");for(let t=0;t<e.length;++t){this.bS(parseInt(e[t]));const i=[];this.l.items.forEach((e=>{0!=this.l.items[t].indexOf(parseInt(e))&&i.push(e)})),this.l.items=i}this.bP(),this.x=!0}setShouldersOverride(t){if(!t||2!=t.length)return;for(let t=0;t<2;t++){const e=this.z[t];e&&e.y(),this.z[t]=null}for(let e=0;e<2;e++)if(null!=t[e]){const i=new ja(this,3,t[e],this.o,this.p);let r=0;r=0==e?1:2,i.C(r),this.z[e]=i}const e=this.y.get(3);if(e){let t=3;for(let e=0;e<2;e++)this.z[e]&&(t&=~(1<<e));e.C(t)}}setSheath(t,e){this.I=t,this.J=e,this.bP()}setAppearance(t){var e;if(this.D)for(const t in this.D)this.D[t].d(),delete this.D[t];if(this.E)for(const t in this.E)this.E[t].d(),delete this.E[t];this.r=t,this.I=t.sheathMain,this.J=t.sheathOff,null===(e=this.G)||void 0===e||e.e(t.options),this.x=!0,this.bD(),this.bP()}setCustomizationsLoadedCallback(t){this.H=t}isLoaded(){return this.j?this.j.d&&this.d:this.d}setParticlesEnabled(t){this.g=t,this.y.forEach((e=>{if(e.i)for(let i=0;i<e.i.length;++i)if(e.i[i]&&(e.i[i].e.setParticlesEnabled(t),e.s[i]&&e.s[i].b)){const r=e.i[i].e;for(let s=0;s<e.s[i].b.length;s++)r.aD&&r.aD[s]&&e.s[i].b[s]&&e.s[i].b[s].e.setParticlesEnabled(t)}}))}setRibbonsEnabled(t){this.h=t}getTexUnits(){return this.aN}bu(t,e,i,r){ri(this.W,t),hi(this.W,this.W,e),i&&li(this.W,this.W,i),r&&hi(this.W,this.W,r)}bv(t,e){let i=!1;const r=t==xo;r&&(t=To);for(let s=0;s<this.ap.length;++s){const n=this.ap[s];if(n.j&&n.j==t&&0==n.b){i=!0,e.a.a=s,e.a.b=n,e.a.c=0,e.b=new $i,e.c=0,e.d=r;break}}t==To||i||this.bv(To,e)}bw(t){if(this.s==t)return;if(this.d)for(let t=0;t<this.ar.length;t++)this.ar[t].x=null;if(this.s=t,t<=0)return;let e=this.l.contentPath+"bone/"+t+".bone",i=this;$.ajax({url:e,type:"GET",dataType:"binary",responseType:"arraybuffer",processData:!1,renderer:this.aT,success:function(t){i.bx(t)},error:function(t,e,i){WH.debug(i)}})}bx(t){let e=new so(t);for(e.getInt32();e.position<e.buffer.byteLength;){let t=String.fromCharCode(e.getUint8(),e.getUint8(),e.getUint8(),e.getUint8()),i=e.getUint32();if("BIDA"==t){let t=i/2;this.t=new Array(t);for(let i=0;i<t;i++)this.t[i]=e.getUint16()}if("BOMT"==t){let t=i/64;this.u=new Array(t);for(let i=0;i<t;i++){let t=si(e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat(),e.getFloat());this.u[i]=t}}}this.d&&this.by()}by(){if(!(this.s<=0)&&this.t&&this.t.length)for(let t=0;t<this.t.length;t++)this.ar[this.t[t]].x=this.u[t]}setAnimation(t){this.ap&&(this.j&&(this.j.setAnimation(t),t=xi[this.j.a.id]?"StealthStand":"Mount"),this.bv(t,this.T),this.y.forEach((e=>{if(e.i)for(let i=0;i<e.i.length;i++)e.i[i].e.setAnimation(t)})),this.F&&this.F.forEach((e=>e.e(t))))}bA(t){let e=this,i=e.aT.context;if(!e.am||!e.an)return;const r=10*e.am.length;if(e.aU||(e.aU=new Float32Array(r)),t){var s=e.aU,n=e.am;for(let t=0,e=0;t<r;++e)s[t+0]=n[e].i[0],s[t+1]=n[e].i[1],s[t+2]=n[e].i[2],s[t+3]=n[e].j[0],s[t+4]=n[e].j[1],s[t+5]=n[e].j[2],s[t+6]=n[e].c,s[t+7]=n[e].d,s[t+8]=n[e].e,s[t+9]=n[e].f,t+=10}e.aV?(i.bindBuffer(i.ARRAY_BUFFER,e.aV),i.bufferSubData(i.ARRAY_BUFFER,0,e.aU)):(e.aV=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,e.aV),i.bufferData(i.ARRAY_BUFFER,e.aU,i.DYNAMIC_DRAW),e.aW=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.aW),i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(e.an),i.STATIC_DRAW))}bB(){let t,e=this,i=Ui(1,1,1,1),r=e.ag,s=e.ah,n=e.aP;if(Le(r,9999,9999,999),Le(s,-9999,-9999,-9999),!e.av)return ni(e.W),e.w||(e.aT.distance=1),!1;for(let n=0;n<e.av.length;++n){let a=e.av[n];if(!a.show)continue;if(i[0]=i[1]=i[2]=i[3]=1,e.T.a.a>0&&(a.v&&(i=a.v.g(e.T,this.aY)),a.w[0]&&(i[3]*=a.w[0].d(e.T,this.aY))),i[3]<.01)continue;let o=a.p;for(let i=0;i<o.f;++i)t=e.am[e.an[o.e+i]].i,je(r,r,t),We(s,s,t)}for(const e in this.A){const i=this.A[e];if(i&&i.d&&i.av&&i.av.length>0)for(let e=0;e<i.av.length;++e){let n=i.av[e];if(!n.show)continue;let a=n.p;for(let e=0;e<a.f;++e)t=i.am[i.an[a.e+e]].i,je(r,r,t),We(s,s,t)}}e.j&&e.j.d&&e.j.bB()&&(Be(r,Ve(r,e.j.ag,1.1)),Be(s,Ve(s,e.j.ah,1.1)),s[2]*=1.75),e.a.type==wi.NPC&&(Ve(r,r,e.v.Scale),Ve(s,s,e.v.Scale)),He(e.boundsSize,s,r),qe(e.ai,r,e.boundsSize,.5);let a,o;e.boundsSize[2];const h=e.v&&e.v.Scale?e.v.Scale:1;if(e.a.type!=wi.ITEM?(a=e.boundsSize[1],o=e.boundsSize[0]):(a=e.boundsSize[0],o=e.boundsSize[1]),!e.w){e.aT.width,e.aT.height,Math.tan(e.aT.fov/2*.0174532925)}return ni(e.W),e.a.type!=wi.ITEM&&di(e.W,e.W,Math.PI/2),li(e.W,e.W,Xe(n,e.ai)),Le(e.aP,h,h,h),ui(e.W,e.W,e.aP),!0}bC(t,e){let i=new fo;return e.a>0&&(i.a=new Ra(this,e.a)),e.b>0&&(i.b=new Ra(this,e.b)),e.c>0&&(i.c=new Ra(this,e.c)),i}bD(){if(!this.aS)if(this.a.type!=wi.CHARACTER&&this.a.type!=wi.NPC&&this.a.type!=wi.HUMANOIDNPC||this.o<1){if(this.bI(),this.a.type==wi.HELM){const t=this.v;this.bL(t.Item.AttachGeosetGroup[0],27),this.bL(t.Item.AttachGeosetGroup[1],21)}if(this.a.type==wi.SHOULDER){const t=this.v;this.bL(t.Item.AttachGeosetGroup[0],26)}}else this.bM(),this.aM||(this.x=!0)}bE(t){t&&(this.K[t.geosetType]=100*t.geosetType+t.geosetID)}bF(t){t&&(this.L[t.GeosetType]=100*t.GeosetType+t.GeosetID)}bG(t){t&&(this.L[t.GeosetType]=100*t.GeosetType+t.GeosetID,this.M[t.GeosetType]=0==(1&t.Flags))}bH(t,e,i){if(!this.av||0==this.av.length)return!1;let r;for(let s=0;s<this.av.length;++s)r=this.av[s],r.meshId>=t&&r.meshId<=e&&(r.show=i);return!0}bI(){if(this.bH(0,0,!0),0!=this.Q&&(this.bH(1,1699,!1),this.P))for(let t of this.P){let e=100*(t.GeosetIndex+1),i=e+t.GeosetValue;this.bH(e,e+99,!1),this.bH(i,i,!0)}}bJ(t,e){let i=[];for(let t=0;t<this.ar.length;t++)i[this.ar[t].g]=t;let r=t.ar;if(r){for(let t=0;t<r.length;t++){let e=i[r[t].g];if("number"!=typeof e)continue;let s=r[t].m,n=this.ar[e].m;r[t].u=!0,ri(s,n)}ni(this.aO),t.bu(this.W,this.aO),t.cc(),t.ce(e)}}bK(t,e){if(!this.av)return;let i=e+1,r=t>0?e+t:i,s=this.av.some((t=>t.meshId==r));r=s?r:i,this.bH(r,r,!0)}bL(t,e){if(!this.av)return;let i=100*e,r=i+this.N[e]+t,s=this.av.some((t=>t.meshId==r));r=s?r:100*e+1,this.bH(i,i+99,!1),this.bH(r,r,!0)}bM(){var t=this;if(!t.av||0==t.av.length)return;for(let e=0;e<mo;e++)t.K[e]=100*e+t.N[e];t.bH(0,vo,!1),t.bH(0,0,!0);for(let e=0;e<t.L.length;e++)-1!=this.L[e]&&(this.K[e]=this.L[e]);for(let e=0;e<t.K.length;e++)t.bH(t.K[e],t.K[e],!0);t.y.forEach((t=>{if(t&&t.r){let e=t.r;e.bH(0,vo,!1),1==t.b?(e.bK(t.k[0],2700),e.bK(t.k[1],2100)):3==t.b?e.bK(t.k[0],2600):4==t.b?(e.bK(t.k[0],800),e.bK(t.k[1],1e3)):5==t.b||20==t.b?(e.bK(t.k[0],800),e.bK(t.k[1],1e3),e.bK(t.k[2],1300),e.bK(t.k[3],2200),e.bK(t.k[4],2800)):6==t.b?e.bK(t.k[0],1800):7==t.b?(e.bK(t.k[0],1100),e.bK(t.k[1],900),e.bK(t.k[2],1300)):8==t.b?(e.bK(t.k[0],500),e.bK(t.k[1],2e3)):10==t.b?(e.bK(t.k[0],400),e.bK(t.k[1],2300)):16==t.b?e.bK(t.k[0],1500):19==t.b?e.bK(t.k[0],1200):9==t.b&&e.bK(t.k[0],2300)}})),t.z.forEach((t=>{if(t&&t.r){let e=t.r;e.bH(0,vo,!1),e.bK(t.k[0],2600)}})),t.y.forEach((t=>{if(t&&t.i)for(let e of t.i){let i=e.e;1==t.b?(i.bL(t.l[0],27),i.bL(t.l[1],21)):3==t.b?i.bL(t.l[0],26):4==t.b?(i.bL(t.l[0],8),i.bL(t.l[1],10)):5==t.b||20==t.b?(i.bL(t.l[0],8),i.bL(t.l[1],10),i.bL(t.l[2],13),i.bL(t.l[3],22),i.bL(t.l[4],28)):6==t.b?i.bL(t.l[0],18):7==t.b?(i.bL(t.l[0],11),i.bL(t.l[1],9),i.bL(t.l[2],13)):8==t.b?(i.bL(t.l[0],5),i.bL(t.l[1],20)):10==t.b?(i.bL(t.l[0],4),i.bL(t.l[1],23)):16==t.b?i.bL(t.l[0],15):19==t.b?i.bL(t.l[0],12):9==t.b&&i.bL(t.l[0],23)}})),t.z.forEach((t=>{if(t&&t.i)for(let e of t.i){let i=e.e;i.bL(t.l[0],26),t.m>0&&(i.bH(2600,2699,!1),i.bL(t.m,26))}}));let e=t.y.get(1),i=t.y.get(3),r=t.y.get(4),s=t.y.get(5),n=t.y.get(6),a=t.y.get(7),o=t.y.get(8),h=t.y.get(9),l=t.y.get(10),u=t.y.get(19),c=t.y.get(16);if(e){const i=t.o,r=0==t.p?e.w:e.x;if(r)for(let e=0;e<r.length;e++)if(r[e].RaceId==i){const s=r[e].GeosetGroup;if(5==i&&(1==s||2==s))continue;if(s<mo)if(0==s)t.bH(1,99,!1);else{const e=100*s;t.bH(e,e+99,!1)}}}if(e&&e.i&&e.m>0)for(let t of e.i){let i=t.e;i.bH(2600,2799,!1),i.bL(e.m,27)}if(i&&i.i&&i.m>0)for(let t of i.i){let e=t.e;e.bH(2600,2699,!1),e.bL(i.m,26)}if(n&&n.i&&n.m>0)for(let t of n.i){let e=t.e;e.bH(1800,1899,!1),e.bL(n.m,18)}let f=0;if(u&&(f|=16),l&&l.k&&l.k[0]){let e=401+l.k[0];t.bH(401,499,!1),t.bH(e,e,!0),l.f+=2}else if(s&&s.k&&s.k[0]){let e=801+s.k[0];t.bH(e,e,!0)}if(!(s||n||h)&&r&&r.k&&r.k[0]){let e=801+r.k[0];t.bH(e,e,!0)}if(u)0==(1048576&u.h)&&(t.bH(2200,2299,!1),t.bH(2202,2202,!0));else if(s&&s.k&&s.k[3]){let e=2201+s.k[3];t.bH(2200,2299,!1),t.bH(e,e,!0)}let d=!1;n&&n.k&&n.k[0]&&(d=0!=(512&n.h));let b,_=!1,g=!1;if(s&&s.k&&s.k[2]){g=!0,t.bH(501,599,!1),t.bH(902,999,!1),t.bH(1100,1199,!1),t.bH(1300,1399,!1);let e=1301+s.k[2];t.bH(e,e,!0)}else if(a&&a.k&&a.k[2]){_=!0,t.bH(501,599,!1),t.bH(902,999,!1),t.bH(1100,1199,!1),t.bH(1300,1399,!1);let e=1301+a.k[2];t.bH(e,e,!0)}else if(o&&o.k&&o.k[0]){t.bH(501,599,!1),t.bH(901,901,!0);let e=501+o.k[0];t.bH(e,e,!0)}else{let e;e=a&&a.k&&a.k[1]?901+a.k[1]:901,t.bH(e,e,!0)}b=o&&o.k&&o.k[1]?2e3+o.k[1]:o&&0==(1048576&o.h)?2002:2001,t.bH(2001,2099,!1),t.bH(b,b,!0);let p=!1,m=g||_;if(!m&&u&&u.k&&u.k[0]){let e;p=!1,d?(p=!0,e=1203):(p=!0,e=1201+u.k[0]),t.bH(e,e,!0)}else 16&f&&(t.bH(1201,1201,!0),m||(t.bH(1202,1202,!0),p=!0));if(!p&&!g)if(s&&s.k&&s.k[1]){let e=1001+s.k[1];t.bH(e,e,!0)}else if(r&&r.k&&r.k[1]){let e=1001+r.k[1];t.bH(e,e,!0)}if(!g&&a&&a.k&&a.k[0]){let e=a.k[0],i=1101+e,r=this.av.some((t=>t.meshId==i));e>2?(t.bH(1300,1399,!1),r?t.bH(i,i,!0):t.bH(1301,1301,!0)):p||t.bH(i,i,!0)}if(u&&u.k&&u.k[0]&&this.O.length>0)for(let e of this.O){const i=Ti[e];if(i&&12==i.GeosetType&&i.Original==u.k[0]+1){t.bH(1200,1299,!1);let e=1200+i.Override;t.bH(e,e,!0);break}}if(c&&c.k&&c.k[0]){t.bH(1500,1599,!1);let e=1501+c.k[0];if(this.O.length>0)for(let t of this.O){const i=Ti[t];if(i&&15==i.GeosetType&&i.Original==c.k[0]+1){e=1500+i.Override;break}}t.bH(e,e,!0)}if(n&&n.k&&n.k[0]){t.bH(1800,1899,!1);let e=1801+n.k[0];t.bH(e,e,!0)}a||g||_||p||d?t.bH(1400,1499,!1):t.bH(1401,1401,!0);for(const e in this.A){const i=t.A[e];i.bH(0,vo,!1);for(let t=0;t<i.L.length;t++)if(i.bH(i.L[t],i.L[t],!0),i.M[t]&&i.av){const e=i.L[t];if(i.av.some((t=>t.meshId==e))){const e=100*t;this.bH(e,e+99,!1)}}}}bN(){let t=!1;if(this.y.forEach((e=>{if(e.n||e.o){if(e.j)for(let i=0;i<e.j.length;++i)if(e.j[i].texture&&!e.j[i].texture.f())return void(t=!0)}else t=!0})),t)return;if(!this.G)return;const e=this.G.b.Materials,i=this.G.b.TextureLayers,r=this.G.b.TextureSections;let s=!0,n=!0;15!=this.o&&21!=this.o||(n=!1),this.y.forEach((t=>{let e=t.e;4!=e&&5!=e&&19!=e||(s=!1),7==e&&(n=!1)}));let a=-1;if(27==this.o)for(let t of i)9==t.BlendMode&&1==t.TextureType&&t.Layer>a&&(a=t.Layer);const o=(h=t=>t.TextureType,i.reduce(((t,e)=>{var i;return(t[i=h(e)]||(t[i]=[])).push(e),t}),{}));var h;for(const t in o){const i=o[t],h=i[0].TextureType;if(!this.aL[t]){const i=e.find((t=>t.TextureType==h));if(!i)continue;this.aL[t]=new _o(this.aT.context,i.Width,i.Height)}const l=this.aL[t];l.j();for(const t of i){let e=-1;t.Layer==a&&(e=0);const i=this.E[t.ChrModelTextureTargetID];if(!i)continue;if(!i.e())return;const o=t.TextureSection;if(3!=o&&5!=o||s&&3==o||n&&5==o){let s=0,n=0,a=1,h=1;if(-1!=o&&r){const t=r.find((t=>t.SectionType==o));if(!t)continue;s=t.X,n=t.Y,a=t.Width,h=t.Height}l.k(i,s,n,a,h,t.BlendMode,t.Layer,e)}}1==h&&52!=this.o&&70!=this.o&&this.bO(l),26!=h||52!=this.o&&70!=this.o||this.bO(l),l.l()}this.x=!1}bO(t){const e=[];this.y.forEach((t=>{e.push(t)})),e.sort((function(t,e){return t.f-e.f}));const i=this.G.b.TextureSections;for(let r=0;r<e.length;r++){const s=e[r];if(s.j)for(let e=0;e<s.j.length;e++){const r=s.j[e];if(r.gender==this.p&&r.texture&&r.texture.f()&&12!=r.region){if(0!=(1&this.v.Character.ChrModelFlags)&&7==r.region)continue;const e=i.find((t=>t.SectionType==r.region));if(!e)continue;const s=new fo;s.a=r.texture,t.k(s,e.X,e.Y,e.Width,e.Height,0,-1,-1)}}}}bP(){if(!this.d)return;let t=(-1==this.J||!this.J)&&null!=this.y.get(22),e=!(-1!=this.I&&this.I||null==this.y.get(13)&&null==this.y.get(21));for(let e of Mi){let i=this.at[e];i>0&&i<this.ar.length&&this.ar[i].C(t?"HandsClosed":"")}for(let t of Si){let i=this.at[t];i>0&&i<this.ar.length&&this.ar[i].C(e?"HandsClosed":"")}}bQ(t){if($.isArray(t))for(let e=0;e<t.length;++e)this.bR(t[e][0],t[e][1],t[e][2]);else for(let e in t)this.bR(parseInt(e),t[e]);this.bP()}bR(t,e,i){if(!this.y)return;let r=new ja(this,t,e,this.o,this.p);i&&r.B(i);let s=r.e,n=Ei[t];this.y.get(s)&&0!=n?(r.e=n,this.y.set(n,r)):this.y.set(s,r)}bS(t){var e=this.y.get(t);e||(t=yi[t],e=this.y.get(t)),e&&(this.y.delete(t),e.y())}bT(t,e){const i=[],r={14:t=>[0],26:t=>2==t.c&&18==t.d?[1]:null};if(this.aD&&this.aE){const s={1:t=>[11],3:t=>[6,5],22:t=>{var e;return(null===(e=r[t.b])||void 0===e?void 0:e.call(r,t))||[2]},21:t=>[1],17:t=>[1],15:t=>[2],25:t=>[1],13:t=>[1],14:t=>[0],23:t=>[2],6:t=>[53],26:t=>[1],16:t=>[57],27:t=>[55]};if(s[t]){const r=s[t](e);for(let s=0;s<r.length;++s){let n=r[s];(this.I>=0||this.J>=0||this.j)&&Di[t]&&(n=Di[t]),this.I>=0&&21==t&&Fi[this.I][t]&&(n=Fi[this.I][t]),this.J>=0&&22==t&&Fi[this.J][t]&&(n=Fi[this.J][t]),15==e.g&&this.J>=0&&22==t&&Fi[this.J][e.b]&&(n=Fi[this.J][e.b]),n>=this.aE.length||-1==this.aE[n]||i.push(this.aE[n])}}}return i}bU(){var t;if(!this.aS){if(this.av){for(let t=0;t<this.av.length;++t)this.av[t].K(this);this.aN=this.av.concat()}this.setAnimation(To),this.bA(!0),this.bB(),this.bD(),this.d=!0,this.by(),this.bP(),this.m&&this.w.d&&this.w.bB(),this.n&&this.w.d&&this.w.bB(),this.w&&this.w.d&&!this.af&&this.w.bM(),null===(t=this.e)||void 0===t||t.call(this)}}bV(){this.a&&this.a.type&&this.a.id&&this.bW(this.a.type,this.a.id)}bW(t,e){let i,r=this;t==wi.ITEM?i="meta/item/":t==wi.HELM?i="meta/armor/1/":t==wi.SHOULDER?i="meta/armor/3/":t==wi.NPC||t==wi.HUMANOIDNPC?i="meta/npc/":t==wi.OBJECT?i="meta/object/":t==wi.CHARACTER?i="meta/character/":t==wi.ITEMVISUAL&&(i="meta/itemvisual/"),i?(i=this.l.contentPath+i+e+".json",function(t){$.getJSON(i).done((function(e){r.bY(e,t)})).fail((function(t,e,i){}))}(t)):t==wi.PATH&&(this.v||(this.v={}),i=this.l.contentPath+"mo3/"+e+".mo3",$.ajax({url:i,type:"GET",dataType:"binary",responseType:"arraybuffer",processData:!1,renderer:this.aT,success:function(t){r.cZ(t)},error:function(t,e,i){WH.debug(i)}}))}bX(t,e,i){const r=ki[e];if(r){const e=i?4:0;return r.slice(2*t+e,2*t+e+2)}}bY(t,e){var i,r,s=this;if(e||(e=s.a.type),s.v||(s.v=t),e==wi.CHARACTER){let e=this.c?this.c:t.Model;s.o=t.Character.Race,s.p=t.Character.Gender,s.l.cls&&(s.q=parseInt(s.l.cls));let n=s.l.contentPath+"meta/customization/"+t.Character.ChrModelId+".json";if($.getJSON(n,(function(t){var e,i,r,n;if(s.G=new go(s,t),null===(e=s.H)||void 0===e||e.call(s,s.G.b),s.G.c(),s.r)s.setAppearance(s.r);else if((null===(i=s.a)||void 0===i?void 0:i.type)!=wi.CHARACTER&&s.v.Character.Race>0&&(null===(n=null===(r=s.v)||void 0===r?void 0:r.Creature)||void 0===n?void 0:n.CreatureCustomizations)){let t=s.G.g(s.v.Creature.CreatureCustomizations);s.setAppearance(t)}else s.G.f();s.x&&s.bD()})),s.v.Creature&&s.v.Creature.Texture&&(s.aM=this.bC(-1,Ga.a(null,s.v.TextureFiles[s.v.Creature.Texture],3,0,0))),s.bW(wi.PATH,e),s.v.Equipment&&s.bQ(s.v.Equipment),s.l.items&&s.bQ(s.l.items),s.l.shouldersOverride&&s.setShouldersOverride(s.l.shouldersOverride),s.a.type!=wi.CHARACTER&&s.v.Character.Race>0){if(s.G&&(null===(r=null===(i=s.v)||void 0===i?void 0:i.Creature)||void 0===r?void 0:r.CreatureCustomizations)){let t=s.G.g(s.v.Creature.CreatureCustomizations);s.r=t}}else s.l.charCustomization&&(s.r=s.l.charCustomization)}else if(e==wi.HELM){let e=1,i=0,r=1;if(s.w&&(e=s.w.o,i=s.w.p,r=s.w.q),t.ComponentModels){let n=t.ComponentModels[0];n&&t.ModelFiles&&t.ModelFiles[n]&&(27==t.Item.InventoryType?s.bW(wi.PATH,t.ModelFiles[n][0].FileDataId):(s.w||t.ModelFiles[n].some((t=>t.Race==e))||(e=t.ModelFiles[n][0].Race),s.bW(wi.PATH,Ga.b(s,t.ModelFiles[n],-1,i,r,e))))}if(t.Textures)for(let e in t.Textures)0!=t.Textures[e]&&(s.C[parseInt(e)]=new Ra(s,t.Textures[e]))}else if(e==wi.SHOULDER){let e=1,i=0,r=1;if(s.w&&(e=s.w.o,i=s.w.p,r=s.w.q),t.ComponentModels){let n=t.ComponentModels[0],a=t.ComponentModels[1];if(1==s.a.shoulder||void 0===s.a.shoulder&&n){if(n&&t.ModelFiles[n]&&s.bW(wi.PATH,Ga.b(s,t.ModelFiles[n],0,i,r,e)),t.Textures)for(let e in t.Textures)0!=t.Textures[e]&&(s.C[+e]=new Ra(s,t.Textures[e]))}else if((2==s.a.shoulder||void 0===s.a.shoulder&&a)&&(a&&t.ModelFiles[a]&&s.bW(wi.PATH,Ga.b(s,t.ModelFiles[a],1,i,r,e)),t.Textures2))for(let e in t.Textures2)0!=t.Textures2[e]&&(s.C[+e]=new Ra(s,t.Textures2[e]))}}else if(e==wi.ITEMVISUAL)s.bW(wi.PATH,t.Equipment[s.b]);else if(e==wi.ITEM){let e=1,i=0,r=1;if(s.w&&(e=s.w.o,i=s.w.p,r=s.w.q),t.ComponentModels){let n=t.ComponentModels[0];n&&t.ModelFiles&&t.ModelFiles[n]&&s.bW(wi.PATH,Ga.b(s,t.ModelFiles[n],-1,i,r,e))}if(t.Textures)for(let e in t.Textures)0!=t.Textures[e]&&(s.C[+e]=new Ra(s,t.Textures[e]))}else{if(t.StateKit&&this.F.push(new Na(this,t.StateKit.effects)),t.Creature&&(s.P=t.Creature.CreatureGeosetData,s.Q=t.Creature.CreatureGeosetDataID),t.Textures)for(let e in t.Textures)0!=t.Textures[e]&&(s.C[+e]=new Ra(s,t.Textures[e]));else if(t.ComponentTextures&&s.w){let e=s.w.p;for(let i in t.ComponentTextures){let r=t.TextureFiles[t.ComponentTextures[i]];for(let t=0;t<r.length;t++){let n=r[t];n.Gender!=e&&3!=n.Gender||(s.C[+i]=new Ra(s,n.FileDataId))}}}t.Model?(s.bW(wi.PATH,t.Model),e==wi.NPC&&s.l.items&&!s.w&&s.bQ(s.l.items)):t.Character&&t.Character.Race>0&&(s.o=t.Character.Race,s.p=t.Character.Gender,s.bW(wi.CHARACTER,t.Character.ChrModelId))}}cZ(t){if(!t)return void WH.debug("Bad buffer.");let e=this,i=new so(t);if(604210112!=i.getUint32())return void WH.debug("Bad magic value.");if(i.getUint32()<2e3)return void WH.debug("Bad version.");e.al=i.getUint32();var r=i.getUint32(),s=i.getUint32(),n=i.getUint32(),a=i.getUint32(),o=i.getUint32(),h=i.getUint32(),l=i.getUint32(),u=i.getUint32(),c=i.getUint32(),f=i.getUint32(),d=i.getUint32(),b=i.getUint32(),_=i.getUint32(),g=i.getUint32(),p=i.getUint32(),m=i.getUint32(),v=i.getUint32(),x=i.getUint32(),T=i.getUint32(),w=i.getUint32(),y=i.getUint32(),A=i.getUint32(),E=i.getUint32(),C=i.getUint32(),M=i.getUint32(),S=i.getUint32();let k=new Uint8Array(t,i.position),D=null;try{D=ya(k)}catch(t){return}if(D.length>=S){i=new so(D.buffer),i.position=r;var F=i.getInt32();if(F>0){e.am=new Array(F);for(let t=0;t<F;++t)e.am[t]=new Hi(i)}i.position=s;var R=i.getInt32();if(R>0){e.an=new Array(R);for(let t=0;t<R;++t)e.an[t]=i.getUint16()}i.position=n;var U=i.getInt32();if(U>0){e.ao=new Array(U),e.aY=new Array(U);for(let t=0;t<U;++t)e.ao[t]=i.getUint32(),e.aY[t]=0}i.position=a;var I=i.getInt32();if(I>0){e.ap=new Array(I);for(let t=0;t<I;++t)e.ap[t]=new Gi(i)}i.position=o;var O=i.getInt32();if(O>0){e.aq=new Array(O);for(let t=0;t<O;++t)e.aq[t]=i.getInt16()}i.position=h;var P=i.getInt32();if(P>0){e.ar=new Array(P);for(let t=0;t<P;++t)e.ar[t]=new dr(e,t,i);this.ak=new Array(P);for(let t=0;t<P;t++){this.ak[t]=[];for(let i=0;i<P;i++)e.ar[i].e==t&&this.ak[t].push(i)}}i.position=l;var z=i.getInt32();if(z>0){e.as=new Array(z);for(let t=0;t<z;++t)e.as[t]=i.getInt16()}i.position=u;var B=i.getInt32();if(B>0){e.at=new Array(B);for(let t=0;t<B;++t)e.at[t]=i.getInt16()}i.position=c;var L=i.getInt32();if(L>0){e.au=new Array(L);for(let t=0;t<L;++t)e.au[t]=new br(i)}i.position=f;var N=i.getInt32();if(N>0){e.av=new Array(N);for(let t=0;t<N;++t)e.av[t]=new Fa(i)}i.position=d;var H=i.getInt32();if(H>0){e.aw=new Array(H);for(let t=0;t<H;++t)e.aw[t]=i.getInt16()}i.position=b;var G=i.getInt32();if(G>0){e.ax=new Array(G);for(let t=0;t<G;++t)e.ax[t]=new Aa(i)}i.position=_;var j=i.getInt32();if(j>0){e.ay=new Array(j);for(let t=0;t<j;++t)e.ay[t]=new Ua(e,t,i)}i.position=g;var W=i.getInt32();if(W>0){e.az=new Array(W);for(let t=0;t<W;++t)e.az[t]=i.getInt16()}i.position=p;var V=i.getInt32();if(V>0){e.aA=new Array(V);for(let t=0;t<V;++t)e.aA[t]=new Ia(i)}i.position=m;var q=i.getInt32();if(q>0){e.aB=new Array(q);for(let t=0;t<q;++t)e.aB[t]=i.getInt16()}i.position=v;var Y=i.getInt32();if(Y>0){e.aC=new Array(Y);for(let t=0;t<Y;++t)e.aC[t]=i.getInt16()}i.position=x;var X=i.getInt32();if(X>0){e.aD=new Array(X);for(let t=0;t<X;++t)e.aD[t]=new Oa(i)}i.position=T;var Z=i.getInt32();if(Z>0){e.aE=new Array(Z);for(let t=0;t<Z;++t)e.aE[t]=i.getInt16()}i.position=w;var J=i.getInt32();if(J>0){e.aF=new Array(J);for(let t=0;t<J;++t)e.aF[t]=new Pa(i)}i.position=y;var K=i.getInt32();if(K>0){e.aG=new Array(K);for(let t=0;t<K;++t)e.aG[t]=new za(i)}i.position=A;var $=i.getInt32();if($>0){e.aH=new Array($);for(let t=0;t<$;++t)e.aH[t]=i.getInt16()}i.position=E;var Q=i.getInt32();if(Q>0){e.aI=new Array(Q);for(let t=0;t<Q;++t)e.aI[t]=new io(e,i)}i.position=M;var tt=i.getInt32();if(tt>0){e.aK=new Array(tt);for(let t=0;t<tt;++t)e.aK[t]=new ro(i),e.aI[t]&&e.aI[t].Y(e.aK[t])}i.position=C;var et=i.getInt32();if(et>0){e.aJ=new Array(et);for(let t=0;t<et;++t)e.aJ[t]=new uo(e,i)}e.bU()}}ca(t){var e=Yi();if(Xi(e,t),this.aI)for(var i=0;i<this.aI.length;i++)this.aI[i].ab(t,e);if(this.aJ)for(i=0;i<this.aJ.length;i++)this.aJ[i].an(t)}cb(t){let e=null;if(!this.aE||!this.aE.length)return null;if(t<this.aE.length)e=this.aD[this.aE[t]];else for(let t=0;t<this.aE.length;t++){const i=this.aE[t];if(-1!=i){e=this.aD[i];break}}return e}cc(){const t=this;if(!t.d)return;t.S++;let e=t.aT.time-t.R;if(e>0&&(t.R=t.aT.time),this.f&&this.T.a&&this.T.a.b){let i=Ie();const r=[4,119,233,242,348,526,527,544,545];[5,143,234,524,525,540,541,556,557].indexOf(this.T.a.b.a)>-1?i=ze(0,-5*e/1e3,0):r.indexOf(this.T.a.b.a)>-1&&(i=ze(0,-3*e/1e3,0));let s=ii();bi(s,i),this.ca(s),this.j&&this.j.ca(s);for(const t in this.A)this.A[t].ca(s);if(t.B)for(let e=0;e<t.B.length;e++)this.B[e].ca(s)}if(!this.U&&t.T.a.a>-1){let t=e;for(let e=0;e<this.aY.length;e++)this.aY[e]+=t,this.ao[e]>0&&(this.aY[e]%=this.ao[e]);this.cd(this.T,t)}let i,r,s,n=t.av?t.av.length:0;for(let e=0;e<n;++e)if(s=t.av[e],s.show){i=s.p.f,r=s.p.e;for(let e=0;e<i;++e)t.am[t.an[r+e]].k=t.S}t.aN&&t.aN.sort((function(t,e){return t.b!=e.b?t.b-e.b:t.meshId-e.meshId}));let a=t.ar.length,o=t.aU;if(t.ar&&t.ap){for(let e=0;e<a;++e)t.ar[e].t=!1;for(let i=0;i<a;++i)t.ar[i].E(e);if(t.am){let e,i,r,s,n=t.am.length,a=t.aQ,h=t.aR;for(let l=0;l<n;++l)if(e=t.am[l],e.k==t.S){s=10*l,o[s]=o[s+1]=o[s+2]=o[s+3]=o[s+4]=o[s+5]=0;for(let n=0;n<4;++n)r=e.g[n]/255,r>0&&(i=t.ar[e.h[n]],Qe(a,e.a,i.m),Li(h,e.b,i.o),o[s+0]+=a[0]*r,o[s+1]+=a[1]*r,o[s+2]+=a[2]*r,o[s+3]+=h[0]*r,o[s+4]+=h[1]*r,o[s+5]+=h[2]*r);e.i[0]=o[s+0],e.i[1]=o[s+1],e.i[2]=o[s+2],e.j[0]=o[s+3],e.j[1]=o[s+4],e.j[2]=o[s+5]}t.bA(!1),t.ae||(t.ae=!0,t.bB())}}if(t.j&&t.j.d){const e=t.j.aD[t.j.aE[0]],i=1/t.j.v.Scale;Le(t.aP,i,i,i),ni(t.aO),ui(t.aO,t.aO,t.aP),t.bu(t.j.W,t.j.ar[e.b].m,e.c,t.aO)}if(t.k&&t.k.d){const e=t.aD[t.aE[19]],i=t.l.pet.scale||.2/t.k.v.Scale;Le(t.aP,i,i,i),ni(t.aO),ui(t.aO,t.aO,t.aP);const r=Oe(e.c);Ne(r,r,t.l.pet.offset||ze(0,-1.25,0)),t.k.bu(t.W,t.ar[e.b].m,r,t.aO)}vi[t.a.id]&&!t.w&&(ni(t.W),Le(t.aP,1,1,-1),ui(t.W,t.W,t.aP)),t.x&&t.bN()}cd(t,e){if(t.a.c+=e,t.b.a<0&&!this.V&&!t.d)if(t.a.b.h>-1){let e=32767*Math.random(),i=0,r=t.a.a,s=this.ap[r];for(i+=s.d;i<e&&s.h>-1;)r=s.h,s=this.ap[r],i+=s.d;t.b.a=r,t.b.b=this.ap[r],t.b.c=0}else{let e=this.ap.find((e=>e.a==t.a.b.a&&0==e.b));e&&(t.b.a=e.i,t.b.b=e,t.b.c=0)}let i=t.a,r=t.b,s=i.b.g-i.c,n=0,a=null;if(r.a>-1&&(a=this.ap[r.a],n=a.e),n>0&&s<n?(r.c=po(n-s,a.g),t.c=s/n):t.c=1,i.c>=i.b.g)if(r.a>-1){if(r.a>-1)for(;0==(32&this.ap[r.a].c)&&(64&this.ap[r.a].c)>0&&(r.a=this.ap[r.a].i,r.b=this.ap[r.a],!(r.a<0)););t.a=r,t.b=new $i,t.c=1}else i.b.g>0&&(i.c=po(i.c,i.b.g))}ce(t){if(this.aS)return;var e=this;if(this.w?Ii(e.X,this.w.X):e.X=Ui(1,1,1,1),e.j&&e.j.ce(t),!e.d)return;e.k&&e.k.ce(t),e.cc(),this.F&&this.F.forEach((e=>e.g(t)));let i=ii();hi(i,e.aT.viewMatrix,e.W);let r=ii();oi(r,i);let s=ii();if(ai(s,r),e.aX={uModelMatrix:e.W,uViewMatrix:e.aT.viewMatrix,uInvTranspViewModelMat:s,uProjMatrix:e.aT.projMatrix,uCameraPos:e.aT.eye,uAmbientColor:e.Y,uDiffuseColor:e.X,uPrimaryColor:e.Z,uSecondaryColor:e.aa,uLightDir1:e.ab,uLightDir2:e.ac,uLightDir3:e.ad},e.aV&&e.aN)for(let i=0;i<e.aN.length;++i)e.aN[i].show&&e.aN[i].N(t);if(e.aI&&e.g)for(let i=0;i<e.aI.length;++i)e.aI[i].Z(e.T,e.aT.delta),e.aI[i].aa(t);if(e.aJ&&e.h)for(let i=0;i<e.aJ.length;++i)e.aJ[i].ar(e.T,e.aT.delta),e.aJ[i].av(),e.aJ[i].aw(t);for(const i in this.A){const r=this.A[i];e.bJ(r,t)}if(e.y.forEach((i=>{if(i){if(2==i.c&&13==i.d){if(21==i.e&&-1!=e.I)return;if(22==i.e&&-1!=e.J)return}i.D(t)}})),e.z.forEach((e=>{e&&e.i&&e.D(t)})),e.B)for(let i=0;i<e.B.length;i++){let r=e.B[i];if(!r.d)continue;let s=e.aE[e.l.extraModels[i][1]];if(-1==s)continue;let n=e.aD[s],a=e.l.extraModels[i][2];Le(e.aP,a,a,a),ni(e.aO),ui(e.aO,e.aO,e.aP),ci(e.aO,e.aO,e.l.extraModels[i][3]),fi(e.aO,e.aO,e.l.extraModels[i][4]),di(e.aO,e.aO,e.l.extraModels[i][5]),r.bu(e.W,e.ar[n.b].m,n.c,e.aO),r.cc(),r.ce(t)}e.y.forEach((i=>{i&&i.r&&e.bJ(i.r,t)}))}}const yo=wo,Ao={2:"Wowhead",3:"LolKing",6:"HeroKing",7:"DestinyDB"};class Eo{constructor(t){if(!t.type||!Ao[t.type])throw"Viewer error: Bad viewer type given";if(!t.container)throw"Viewer error: Bad container given";if(!t.aspect)throw"Viewer error: Bad aspect ratio given";if(!t.contentPath)throw"Viewer error: No content path given";WH.debug(t),this.type=t.type,this.container=t.container,this.aspect=parseFloat(t.aspect),this.renderer=null,this.options=t;const e=this.container.width(),i=Math.round(e/this.aspect);this.init(e,i)}destroy(){this.renderer&&this.renderer.destroy(),this.options=null,this.container=null}init(t,e){if(void 0!==typeof window.Uint8Array&&void 0!==typeof window.DataView)try{const t=document.createElement("canvas");if(!t.getContext("webgl",{alpha:!1})&&!t.getContext("experimental-webgl",{alpha:!1}))return}catch(t){return}this.mode=1,this.renderer=new Mo(this),this.renderer.resize(t,e),this.renderer.init()}setAdaptiveMode(t){this.renderer.setAdaptiveMode(t)}setZoom(t){this.renderer.zoom.target=t}setOffset(t,e){this.renderer.setTranslation(t,e,0)}setFullscreen(t){t?Eo.requestFullscreen(this.renderer.canvas[0]):Eo.exitFullscreen()}method(t,e){return void 0===e&&(e=[]),this.renderer?this.renderer.method(t,[].concat(e)):null}option(t,e){return void 0!==e&&(this.options[t]=e),this.options[t]}static isFullscreen(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}static requestFullscreen(t){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen())}static exitFullscreen(){(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}}const Co=Eo,Mo=class{constructor(t){this.currFrame=0,this.clearColor=ze(0,0,0),this.progressShown=!1,this.attributeState=new ke,this.onContextMenu=function(t){return!1};var e=this;e.viewer=t,e.options=t.options,e.downloads={},e.context=null,e.width=0,e.height=0,e.time=0,e.delta=0,e.models=[],e.screenshotDataURL=null,e.makeDataURL=!1,e.screenshotCallback=null,e.azimuth=1.5*Math.PI+(t.options.azimuth?t.options.azimuth:0),e.zenith=Math.PI/2+(t.options.zenith?t.options.zenith:0),e.distance=t.options.distance??6.25,e.fov=30,e.zoom={rateStep:.1,rateAccelerationDecay:.4,interpolationRate:.3,range:[.3,4],rateCurrent:0,target:1,current:1},e.zoom.range=e.zoom.range.map((function(t){return Math.log(t)/Math.log(1+e.zoom.rateStep)})),e.translation=ze(t.options.translate.x,t.options.translate.y,t.options.translate.z),e.target=ze(0,0,0),e.eye=ze(0,0,0),e.up=ze(0,0,1),e.lookDir=Ie(),e.fullscreen=!1,e.projMatrix=ii(),e.viewMatrix=ii(),e.panningMatrix=ii(),e.viewOffset=Ie(),e.aniFilterExt=null,e.aniFilterMax=0}updateProgress(){var t=this,e=0,i=0;for(var r in t.downloads)e+=t.downloads[r].total,i+=t.downloads[r].loaded;if(e<=0)t.progressShown&&(t.progressBg.hide(),t.progressBar.hide(),t.progressShown=!1);else{t.progressShown||(t.progressBg.show(),t.progressBar.show(),t.progressShown=!0);var s=i/e;t.progressBar.width(Math.round(t.width*s)+"px")}}destroy(){var t=this;if(t.stop=!0,t.canvas&&(t.canvas.detach(),t.progressBg.detach(),t.progressBar.detach(),t.canvas.off("mousedown touchstart",t.onMouseDown).off("DOMMouseScroll",t.onMouseScroll).off("mousewheel",t.onMouseWheel).off("dblclick",t.onDoubleClick).off("contextmenu",t.onContextMenu),$(window).off("resize",t.onFullscreen),$(document).off("mouseup touchend",t.onMouseUp).off("mousemove touchmove",t.onMouseMove),t.canvas=t.progressBg=t.progressBar=null),t.context){var e=t.context;t.bgTexture&&e.deleteTexture(t.bgTexture),t.bgTexture=null,t.program&&e.deleteProgram(t.program),t.program=null,t.vb&&e.deleteBuffer(t.vb),t.vs&&e.deleteShader(t.vs),t.fs&&e.deleteShader(t.fs),t.vb=t.vs=t.fs=null}t.bgImg&&(t.bgImg=null);for(var i=0;i<t.models.length;++i)t.models[i].bb(),t.models[i]=null;t.models=[]}method(t,e){if(this.models.length>0&&this.models[0]){const i=this.models[0][t];return i?i.apply(this.models[0],e):void 0}}getTime(){return window.performance&&window.performance.now?window.performance.now():Date.now()}draw(t){var e,i=this,r=i.context;i.delta=.001*(t-i.time),i.time=t,i.currFrame++,i.updateCamera(),r.bindFramebuffer(r.FRAMEBUFFER,null),r.viewport(0,0,i.width,i.height),r.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),i.bgTexture&&i.program&&(r.useProgram(i.program),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,i.bgTexture),r.uniform1i(i.uTexture,0),r.bindBuffer(r.ARRAY_BUFFER,i.vb),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),r.enableVertexAttribArray(i.aPosition),r.vertexAttribPointer(i.aPosition,2,r.FLOAT,!1,16,0),r.enableVertexAttribArray(i.aTexCoord),r.vertexAttribPointer(i.aTexCoord,2,r.FLOAT,!1,16,8),r.depthMask(!1),r.disable(r.CULL_FACE),r.blendFunc(r.ONE,r.ZERO),r.drawArrays(r.TRIANGLE_STRIP,0,4),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.enable(r.CULL_FACE),r.depthMask(!0),r.disableVertexAttribArray(i.aPosition),r.disableVertexAttribArray(i.aTexCoord));let s=new Array;for(e=0;e<i.models.length;++e)i.models[e].ce(s);s.sort(((t,e)=>{let i=t.e>1,r=e.e>1;return i>r?1:i<r?-1:t.m!=e.m?e.m>t.m?-1:1:t.n>e.n?-1:t.n<e.n?1:e.o!=t.o?e.o<t.o?1:-1:e.e!=t.e?t.e<e.e?-1:1:0})),r.viewport(0,0,i.width,i.height),this.attributeState.disableAll(),s.forEach((t=>{r.useProgram(t.a.program),r.bindBuffer(r.ARRAY_BUFFER,t.c),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.d),this.attributeState.enable(r,t.a.attributes),ge(t.a,t.b),t.h?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),t.i?r.frontFace(r.CCW):r.frontFace(r.CW),this.setBlendMode(r,t.e),r.depthMask(t.f),r.drawElements(t.j,t.k,r.UNSIGNED_SHORT,t.l)})),this.attributeState.disableAll()}setAdaptiveMode(t){this.addaptiveMode=t,t&&$(window).trigger("resize")}setTranslation(t,e,i){this.translation=ze(t,e,i)}setBlendMode(t,e){switch(0==e?t.disable(t.BLEND):(t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD)),e){case 0:break;case 1:t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ONE);break;case 2:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE);break;case 3:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE,t.ONE,t.ONE);break;case 4:t.blendFuncSeparate(t.DST_COLOR,t.ZERO,t.ONE,t.ONE);break;case 5:t.blendFuncSeparate(t.DST_COLOR,t.SRC_COLOR,t.ONE,t.ONE);break;case 6:t.blendFuncSeparate(t.DST_COLOR,t.ONE,t.ONE,t.ONE);break;case 10:t.blendFunc(t.ONE,t.ONE);break;case 7:t.blendFuncSeparate(t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE,t.ONE);break;case 8:t.blendFuncSeparate(t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE,t.ONE);break;case 13:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE);break;default:throw 3735927486}}updateCamera(){var t=this;t.zoom.target+=t.zoom.rateCurrent,t.zoom.rateCurrent*=1-t.zoom.rateAccelerationDecay,t.zoom.target=-Math.max(Math.min(-t.zoom.target,t.zoom.range[1]),t.zoom.range[0]),t.zoom.current+=(t.zoom.target-t.zoom.current)*t.zoom.interpolationRate;var e=t.distance*Math.pow(t.zoom.rateStep+1,-t.zoom.current),i=t.azimuth,r=t.zenith;1==t.up[2]?(t.eye[0]=-e*Math.sin(r)*Math.cos(i)+t.target[0],t.eye[1]=-e*Math.sin(r)*Math.sin(i)+t.target[1],t.eye[2]=-e*Math.cos(r)+t.target[2]):(t.eye[0]=-e*Math.sin(r)*Math.cos(i)+t.target[0],t.eye[1]=-e*Math.cos(r)+t.target[1],t.eye[2]=-e*Math.sin(r)*Math.sin(i)+t.target[2]),He(t.lookDir,t.target,t.eye),Ze(t.lookDir,t.lookDir),function(t,e,i,r){var s,n,a,o,h,l,u,c,f,d,b=e[0],_=e[1],g=e[2],p=r[0],m=r[1],v=r[2],x=i[0],T=i[1],w=i[2];Math.abs(b-x)<Re&&Math.abs(_-T)<Re&&Math.abs(g-w)<Re?ni(t):(u=b-x,c=_-T,f=g-w,s=m*(f*=d=1/Math.hypot(u,c,f))-v*(c*=d),n=v*(u*=d)-p*f,a=p*c-m*u,(d=Math.hypot(s,n,a))?(s*=d=1/d,n*=d,a*=d):(s=0,n=0,a=0),o=c*a-f*n,h=f*s-u*a,l=u*n-c*s,(d=Math.hypot(o,h,l))?(o*=d=1/d,h*=d,l*=d):(o=0,h=0,l=0),t[0]=s,t[1]=o,t[2]=u,t[3]=0,t[4]=n,t[5]=h,t[6]=c,t[7]=0,t[8]=a,t[9]=l,t[10]=f,t[11]=0,t[12]=-(s*b+n*_+a*g),t[13]=-(o*b+h*_+l*g),t[14]=-(u*b+c*_+f*g),t[15]=1)}(t.viewMatrix,t.eye,t.target,t.up),ni(t.panningMatrix),1==t.up[2]?Le(t.viewOffset,t.translation[0],-t.translation[1],0):Le(t.viewOffset,t.translation[0],0,t.translation[1]),li(t.panningMatrix,t.panningMatrix,t.viewOffset),hi(t.viewMatrix,t.panningMatrix,t.viewMatrix)}init(){var t,e=this,i=e.context;this.blackPixelTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.blackPixelTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array([0,0,0,255])),i.bindTexture(i.TEXTURE_2D,null),this.greenPixelTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.greenPixelTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array([0,255,0,255])),i.bindTexture(i.TEXTURE_2D,null),pi(e.projMatrix,.0174532925*e.fov,e.viewer.aspect,.1,5e3),e.updateCamera(),i.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],0),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.BLEND);var r=null;if(2===e.viewer.type&&(r=yo),(e.options.models||e.options.items)&&r){var s=[].concat(e.options.models);if(s.length>0)for(t=0;t<s.length;++t)e.models.push(new r(e,e.options,s[t],t,!0,!1,!1))}!function t(){if(!e.stop){window.requestAnimationFrame(t);var r=e.getTime();if(!1!==e.makeDataURL){if(e.canvas[0].toDataURL){var s=e.clearColor,n=e.bgTexture;e.options.transparent&&(e.bgTexture=null,e.clearColor=ze(0,0,0)),e.draw(r);var a=e.width*e.height*4,o=new Uint8Array(a);i.readPixels(0,0,e.width,e.height,i.RGBA,i.UNSIGNED_BYTE,o);let t=null;e.options.transparent?(e.clearColor=ze(1,1,1),e.draw(r),t=new Uint8Array(a),i.readPixels(0,0,e.width,e.height,i.RGBA,i.UNSIGNED_BYTE,t)):t=o;for(var h=new Uint8Array(a),l=0,u=e.height-1;u>=0;u--)for(var c=0;c<e.width;c++){var f=4*(u*e.width+c),d=255-(t[l+0]-o[l+0]),b=o[l+0],_=o[l+1],g=o[l+2];o[l+3],h[f+0]=b,h[f+1]=_,h[f+2]=g,h[f+3]=d,l+=4}var p=document.createElement("canvas"),m=p.getContext("2d");p.width=e.width,p.height=e.height;var v=m.createImageData(e.width,e.height);v.data.set(h),m.putImageData(v,0,0),e.screenshotDataURL=p.toDataURL.apply(p,e.makeDataURL),e.screenshotCallback&&(e.screenshotCallback(),e.screenshotCallback=null),e.clearColor=s,e.bgTexture=n}e.makeDataURL=!1}e.draw(r)}}()}onDoubleClick(t){}onFullscreen(t){let e=this;if(e.viewer.container)if(!e.fullscreen&&Co.isFullscreen()||this.addaptiveMode){if(e.restoreWidth=e.width,e.restoreHeight=e.height,e.fullscreen=!0,Co.isFullscreen()){var i=$(window);let t=window.screen.width||i.width(),e=window.screen.height||i.height();this.onResize(t,e,t/e)}else if(this.addaptiveMode){var r=e.viewer.container;this.onResize(r.width(),r.height(),r.width()/r.height())}}else e.fullscreen&&!Co.isFullscreen()&&(e.fullscreen=!1,this.onResize(e.restoreWidth,e.restoreHeight,e.viewer.aspect))}onResize(t,e,i){this.resize(t,e),pi(this.projMatrix,.0174532925*this.fov,i,.1,5e3)}onMouseDown(t){let e=this;3==t.which||t.ctrlKey?e.rightMouseDown=!0:e.mouseDown=!0,"touchstart"==t.type?(e.mouseX=t.originalEvent.touches[0].clientX,e.mouseY=t.originalEvent.touches[0].clientY):(e.mouseX=t.clientX,e.mouseY=t.clientY),$("body").addClass("unselectable")}onMouseScroll(t){return this.zoom.rateCurrent+=t.originalEvent.detail>0?1:-1,t.preventDefault(),!1}onMouseWheel(t){}onMouseUp(t){let e=this;(e.mouseDown||e.rightMouseDown)&&($("body").removeClass("unselectable"),e.mouseDown=!1,e.rightMouseDown=!1)}onMouseMove(t){let e=this;if((e.mouseDown||e.rightMouseDown)&&void 0!==e.mouseX){var i,r;"touchmove"==t.type?(i=t.originalEvent.touches[0].clientX,r=t.originalEvent.touches[0].clientY):(i=t.clientX,r=t.clientY);var s=(i-e.mouseX)/e.width*Math.PI*2;e.mouseY,e.width,Math.PI;if(e.mouseDown||e.rightMouseDown){1==e.up[2]?e.azimuth-=s:e.azimuth+=s;for(var n=2*Math.PI;e.azimuth<0;)e.azimuth+=n;for(;e.azimuth>n;)e.azimuth-=n}e.mouseX=i,e.mouseY=r}}resize(t,e){var i=this;if(i.width!==t||i.height!==e){if(i.fullscreen||i.viewer.container.css({height:e+"px",position:"relative"}),i.width=t,i.height=e,i.canvas)i.canvas.attr({width:t,height:e}),i.canvas.css({width:t+"px",height:e+"px"}),i.context.viewport(0,0,i.width,i.height);else{if(i.canvas=$("<canvas/>"),i.canvas.attr({width:t,height:e}),i.viewer.container.append(i.canvas),i.context=i.canvas[0].getContext("webgl",{alpha:!0,premultipliedAlpha:!1})||i.canvas[0].getContext("webgl2",{alpha:!0,premultipliedAlpha:!1}),i.progressBg=$("<div/>",{css:{display:"none",position:"absolute",bottom:0,left:0,right:0,height:"10px",backgroundColor:"#000"}}),i.progressBar=$("<div/>",{css:{display:"none",position:"absolute",bottom:0,left:0,width:0,height:"10px",backgroundColor:"#ccc"}}),!i.context)return alert("No WebGL support detected!"),i.canvas.detach(),void(i.canvas=null);const r=i.context.getExtension("EXT_texture_filter_anisotropic")||i.context.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.context.getExtension("WEBKIT_EXT_texture_filter_anisotropic");r&&(i.aniFilterExt=r,i.aniFilterMax=i.context.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),i.canvas.on("mousedown touchstart",i.onMouseDown.bind(i)).on("DOMMouseScroll",i.onMouseScroll.bind(i)).on("mousewheel",i.onMouseWheel.bind(i)).on("dblclick",i.onDoubleClick.bind(i)).on("contextmenu",i.onContextMenu.bind(i)),$(window).on("resize",i.onFullscreen.bind(i)),$(document).on("mouseup touchend",i.onMouseUp.bind(i)).on("mousemove touchmove",i.onMouseMove.bind(i)),i.onFullscreen(null)}i.options.background&&i.loadBackground()}}loadBackground(){var t=this,e=t.context;const i=function(){t.vb=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t.vb),e.bufferData(e.ARRAY_BUFFER,new Float32Array(16),e.DYNAMIC_DRAW);var i=t.compileShader(e.VERTEX_SHADER,"    attribute vec2 aPosition;    attribute vec2 aTexCoord;        varying vec2 vTexCoord;        void main(void) {        vTexCoord = aTexCoord;        gl_Position = vec4(aPosition, 0, 1);    }    "),r=t.compileShader(e.FRAGMENT_SHADER,"    precision mediump float;    varying vec2 vTexCoord;        uniform sampler2D uTexture;        void main(void) {        gl_FragColor = texture2D(uTexture, vTexCoord);    }    "),s=e.createProgram();e.attachShader(s,i),e.attachShader(s,r),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)&&(t.vs=i,t.fs=r,t.program=s,t.uTexture=e.getUniformLocation(s,"uTexture"),t.aPosition=e.getAttribLocation(s,"aPosition"),t.aTexCoord=e.getAttribLocation(s,"aTexCoord"))},r=function(){var i=t.width/t.bgImg.width,r=t.height/t.bgImg.height;const s=[-1,-1,0,r,1,-1,i,r,-1,1,0,0,1,1,i,0];e.bindBuffer(e.ARRAY_BUFFER,t.vb),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(s))};t.bgImg?t.bgImg.loaded&&(t.vb||i(),r()):(t.bgImg=new Image,t.bgImg.crossOrigin="",t.bgImg.onload=function(){var s;null===(s=t.bgImg)||void 0===s||(s.loaded=!0),t.bgTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,t.bgTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.bgImg),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),t.vb||i(),r()},t.bgImg.onerror=function(){t.bgImg=null},t.bgImg.src=t.options.contentPath+t.options.background)}compileShader(t,e){var i=this.context,r=i.createShader(t);if(i.shaderSource(r,e),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS))throw"Shader compile error: "+i.getShaderInfoLog(r);return r}};let So={Types:wi};const ko=Object.assign(Co,{Tools:Fe,WebGL:Mo,WEBGL:1,WOW:2,FLASH:2,Wow:So});window.ZamModelViewer=ko})()})();